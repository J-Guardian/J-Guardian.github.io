<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>WebJs逆向 | 网络安全学习</title><meta name="author" content="J-Guardian"><meta name="copyright" content="J-Guardian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="web js逆向web页面大家都不陌生，在web开发过程中后端负责程序架构和数据管理，前端负责页面展示和用户交互，有种不严谨的说法是：前端代码给浏览器看，后端代码给服务器看。 有开发经验的同学对前后端交互的理解会更深一点，在这种前后端分离的开发方式中，以接口为标准来进行联调整合。为了保证接口在调用时数据的安全性，也是为了防止请求的参数被篡改，大多数接口都进行了请求签名、身份认证、动态Cookie等">
<meta property="og:type" content="article">
<meta property="og:title" content="WebJs逆向">
<meta property="og:url" content="http://example.com/2025/03/03/WebJs%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="网络安全学习">
<meta property="og:description" content="web js逆向web页面大家都不陌生，在web开发过程中后端负责程序架构和数据管理，前端负责页面展示和用户交互，有种不严谨的说法是：前端代码给浏览器看，后端代码给服务器看。 有开发经验的同学对前后端交互的理解会更深一点，在这种前后端分离的开发方式中，以接口为标准来进行联调整合。为了保证接口在调用时数据的安全性，也是为了防止请求的参数被篡改，大多数接口都进行了请求签名、身份认证、动态Cookie等">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2025-03-03T01:39:45.000Z">
<meta property="article:modified_time" content="2025-03-03T01:41:07.631Z">
<meta property="article:author" content="J-Guardian">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "WebJs逆向",
  "url": "http://example.com/2025/03/03/WebJs%E9%80%86%E5%90%91/",
  "image": "https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png",
  "datePublished": "2025-03-03T01:39:45.000Z",
  "dateModified": "2025-03-03T01:41:07.631Z",
  "author": [
    {
      "@type": "Person",
      "name": "J-Guardian",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/03/03/WebJs%E9%80%86%E5%90%91/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WebJs逆向',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">网络安全学习</span></a><a class="nav-page-title" href="/"><span class="site-name">WebJs逆向</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">WebJs逆向</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-03T01:39:45.000Z" title="发表于 2025-03-03 09:39:45">2025-03-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-03T01:41:07.631Z" title="更新于 2025-03-03 09:41:07">2025-03-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h3 id="web-js逆向"><a href="#web-js逆向" class="headerlink" title="web js逆向"></a>web js逆向</h3><p>web页面大家都不陌生，在web开发过程中后端负责程序架构和数据管理，前端负责页面展示和用户交互，有种不严谨的说法是：前端代码给浏览器看，后端代码给服务器看。</p>
<p>有开发经验的同学对前后端交互的理解会更深一点，在这种前后端分离的开发方式中，以接口为标准来进行联调整合。为了保证接口在调用时数据的安全性，也是为了防止请求的参数被篡改，大多数接口都进行了请求签名、身份认证、动态Cookie等机制。另外部分网站会对返回的数据进行加密，通常利用AES、RSA等加密方式，也有在传输时对数据进行序列化，比如Protobuf等，这些会在后面进行详细讲解。</p>
<p>请求签名十分常见，比如URL中的加密参数sign，身份认证也有很多例子，比如动态Cookie。这些参数的生成方法都是Js来控制的，如果想要直接从接口上获取数据，就要去调试分析JavaScript的调用逻辑、堆栈调用关系来弄清楚网站加密的实现方法，根据网站的参数生成规则还原加密参数，可以称这个过程为Js逆向。</p>
<p>我们总结了一下目前加密参数的常用逆向方式，一种是根据源码的生成逻辑还原加密代码，另一种是补环境Copy源码模拟加密参数生成，还有一种是通过RPC的方式远程调用。</p>
<p>在一些逆向案例中，其中的关键就是将浏览器环境移植到Node环境中，Node Js采用的内核也为V8引擎，该引擎调用对方Js的可行性并不是100%，同时由于Node没有界面渲染，因此在浏览器中可使用的例如window、navigator、dom等操作在node中是不存在的，所以对于Node Js的环境搭建和浏览器环境补齐也是Js逆向需要掌握的。</p>
<p>还有就是Chrome作为Js逆向的核心工具，熟练掌握Chrome的控制台、插件编写就足够应对绝大多数的抓包、调试、Hook等，这些内容都会在后续进行讲解。</p>
<h2 id="第一章-逆向基础"><a href="#第一章-逆向基础" class="headerlink" title="第一章 逆向基础"></a>第一章 逆向基础</h2><h3 id="1-1-语法基础"><a href="#1-1-语法基础" class="headerlink" title="1.1 语法基础"></a>1.1 语法基础</h3><p>Js调试相对方便，通常只需要chrome或者一些抓包工具、扩展插件，就能顺利的完成逆向分析。但是Js的弱类型和语法多样，各种闭包，逗号表达式等语法让代码可读性变得不如其他语言顺畅。所以需要学习一下基础语法。</p>
<ul>
<li>基本数据类型</li>
</ul>
<table>
<thead>
<tr>
<th align="left">字符串</th>
<th align="left">String</th>
</tr>
</thead>
<tbody><tr>
<td align="left">数字</td>
<td align="left">Number</td>
</tr>
<tr>
<td align="left">布尔</td>
<td align="left">Boolean</td>
</tr>
<tr>
<td align="left">空值</td>
<td align="left">Null</td>
</tr>
<tr>
<td align="left">未定义</td>
<td align="left">Undefined</td>
</tr>
<tr>
<td align="left">独一无二的值</td>
<td align="left">Symbol</td>
</tr>
</tbody></table>
<ul>
<li>引用数据类型</li>
</ul>
<table>
<thead>
<tr>
<th>对象</th>
<th align="left">Object</th>
</tr>
</thead>
<tbody><tr>
<td>数组</td>
<td align="left">Array</td>
</tr>
<tr>
<td>函数</td>
<td align="left">Function</td>
</tr>
</tbody></table>
<ul>
<li>语句标识符</li>
</ul>
<table>
<thead>
<tr>
<th>在条件为true时重复执行</th>
<th align="left">do……while</th>
</tr>
</thead>
<tbody><tr>
<td>在条件为true时执行</td>
<td align="left">while</td>
</tr>
<tr>
<td>循环遍历</td>
<td align="left">for</td>
</tr>
<tr>
<td>条件判断</td>
<td align="left">if……else</td>
</tr>
<tr>
<td>根据情况执行代码块</td>
<td align="left">switch</td>
</tr>
<tr>
<td>退出循环</td>
<td align="left">break</td>
</tr>
<tr>
<td>异常捕获</td>
<td align="left">try……catch……finally</td>
</tr>
<tr>
<td>抛出异常</td>
<td align="left">Throw</td>
</tr>
<tr>
<td>声明固定值的变量</td>
<td align="left">const</td>
</tr>
<tr>
<td>声明类</td>
<td align="left">class</td>
</tr>
<tr>
<td>停止函数并返回</td>
<td align="left">return</td>
</tr>
<tr>
<td>声明块作用域的变量</td>
<td align="left">let</td>
</tr>
<tr>
<td>声明变量</td>
<td align="left">var</td>
</tr>
<tr>
<td>断点调试</td>
<td align="left">debugger</td>
</tr>
<tr>
<td>当前所属对象</td>
<td align="left">this</td>
</tr>
</tbody></table>
<ul>
<li>算数运算符</li>
</ul>
<table>
<thead>
<tr>
<th align="left">加</th>
<th align="left">+</th>
</tr>
</thead>
<tbody><tr>
<td align="left">减</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">乘</td>
<td align="left">*</td>
</tr>
<tr>
<td align="left">除</td>
<td align="left">&#x2F;</td>
</tr>
<tr>
<td align="left">取余</td>
<td align="left">%</td>
</tr>
<tr>
<td align="left">累加</td>
<td align="left">++</td>
</tr>
<tr>
<td align="left">递减</td>
<td align="left">–</td>
</tr>
</tbody></table>
<ul>
<li>比较运算符</li>
</ul>
<table>
<thead>
<tr>
<th align="left">等于</th>
<th align="left">&#x3D;&#x3D;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">相等值或者相等类型</td>
<td align="left">&#x3D;&#x3D;&#x3D;</td>
</tr>
<tr>
<td align="left">不等于</td>
<td align="left">!&#x3D;</td>
</tr>
<tr>
<td align="left">不相等值或者不相等类型</td>
<td align="left">!&#x3D;&#x3D;</td>
</tr>
<tr>
<td align="left">大于</td>
<td align="left">&gt;</td>
</tr>
<tr>
<td align="left">小于</td>
<td align="left">&#x3c;</td>
</tr>
<tr>
<td align="left">大于等于</td>
<td align="left">&gt;&#x3D;</td>
</tr>
<tr>
<td align="left">小于等于</td>
<td align="left">&#x3c;&#x3D;</td>
</tr>
</tbody></table>
<p>在JavaScript中将数字存储为64位浮点数，但所有按位运算都以32位二进制数执行。在执行位运算之前，JavaScript将数字转换位32位有符号整数。执行按位操作后，结果将转换回64位JavaScript数。</p>
<p>Javascript 函数</p>
<p>JavaScript 中的函数是头等公民，不仅可以像变量一样使用它，同时它还具有十分强大的抽象能力</p>
<p>定义函数的 2 种方式</p>
<p>在JavaScript 中，定义函数的方式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function abs(x) &#123;</span><br><span class="line">    if (x &gt;= 0) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述 abs() 函数的定义如下：</p>
<ul>
<li>function 指出这是一个函数定义；</li>
<li>abs 是函数的名称；</li>
<li>(x) 括号内列出函数的参数，多个参数以，分隔；</li>
<li>{……} 之间的代码是函数体，可以包含若干语句，甚至可以没有任何语句。</li>
</ul>
<p>请注意，函数体内部的语句在执行时，一旦执行到 return 时，函数就执行完毕，并将结果返回。因此，函数内部通过条件判断和循环可以实现非常复杂的逻辑。</p>
<p>如果没有 return 语句，函数执行完毕后也会返回结果，只是结果为 undefined。</p>
<p>由于JavaScript的函数也是一个对象，上述定义的 <code>abs()</code>函数实际上是一个函数对象，而函数名 <code>abs</code>可以视为指向该函数的变量。</p>
<p>因此，第二种定义函数的方式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var abs = function (x) &#123;</span><br><span class="line">    if (x &gt;= 0) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在这种方式下，function（x）{……} 是一个匿名函数，它没有函数名。但是，这个匿名函数赋值给了变量 abs，所以，通过变量 abs 就可以调用该函数。</p>
<p>注意：上述两种定义 <em>完全等价</em> ，第二种方式按照完整语法需要在函数体末尾加一个 ;，表示赋值语句结束。（ 加不加都一样，如果按照语法完整性要求，需要加上）</p>
<p>调用函数时，按顺序传入参数即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abs(10); // 返回10</span><br><span class="line">abs(-9); // 返回9</span><br></pre></td></tr></table></figure>

<p>由于JavaScript 允许传入任意个参数而不影响调用，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abs(10, &#x27;blablabla&#x27;); // 返回10</span><br><span class="line">abs(-9, &#x27;haha&#x27;, &#x27;hehe&#x27;, null); // 返回9</span><br></pre></td></tr></table></figure>

<p>传入的参数比定义的少也没有问题：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abs(); // 返回NaN</span><br></pre></td></tr></table></figure>

<p>此时 abs(s) 函数的参数 x 将收到 undefined，计算结果为NaN。要避免收到undefined，可以对参数进行检查：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function abs(x) &#123;</span><br><span class="line">    if (typeof x !== &#x27;number&#x27;) &#123;</span><br><span class="line">        throw &#x27;Not a number&#x27;;  // 停止并抛出错误信息</span><br><span class="line">    &#125;</span><br><span class="line">    if (x &gt;= 0) &#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-作用域"><a href="#1-2-作用域" class="headerlink" title="1.2 作用域"></a>1.2 作用域</h3><p>Js中有一个被称为作用域的特性。作用域是在运行时代码中的某些特定部分中变量、函数和对象的可访问性。换句话说，作用域决定了代码区块中变量和其他资源的可见性。作用域最大的用处就是隔离变量，不同作用域下同名变量不会有冲突。</p>
<p>Js的作用域分为三种：全局作用域、函数作用域、块级作用域。全局作用域可以让用户在任何位置进行调用，需要注意的是最外层函数和在最外层函数外面定义的变量拥有全局作用域，所有未定义直接赋值的变量会自动声明为拥有全局作用域，所有window对象的属性也拥有全局作用域。函数作用域也就是说只有在函数内部可以被访问，当然函数内部是可以访问全局作用域的。块级作用域则是在if和switch的条件语句或for和while的循环语句中，块级作用域可通过新增命令let和const声明，所声明的变量在指定的作用域外无法被访问。</p>
<h3 id="1-3-窗口对象属性"><a href="#1-3-窗口对象属性" class="headerlink" title="1.3 窗口对象属性"></a>1.3 窗口对象属性</h3><p>我们总结了浏览器window的常见属性和方法。因为很多环境监测都是基于这些属性和方法的，在补环境前，需要了解window对象的常用属性和方法。</p>
<ul>
<li>Window<ul>
<li>Window对象表示浏览器当前打开的窗口。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Document对象</th>
<th align="left">document</th>
</tr>
</thead>
<tbody><tr>
<td align="left">History对象</td>
<td align="left">history</td>
</tr>
<tr>
<td align="left">Location对象</td>
<td align="left">location</td>
</tr>
<tr>
<td align="left">Navigator对象</td>
<td align="left">navigator</td>
</tr>
<tr>
<td align="left">Screen对象</td>
<td align="left">screen</td>
</tr>
<tr>
<td align="left">按照指定的像素值来滚动内容</td>
<td align="left">scrollBy()</td>
</tr>
<tr>
<td align="left">把内容滚动到指定的坐标</td>
<td align="left">scrollTo()</td>
</tr>
<tr>
<td align="left">定时器</td>
<td align="left">setInterval()</td>
</tr>
<tr>
<td align="left">延时器</td>
<td align="left">setTimeout()</td>
</tr>
<tr>
<td align="left">弹出警告框</td>
<td align="left">alert()</td>
</tr>
<tr>
<td align="left">弹出对话框</td>
<td align="left">prompt()</td>
</tr>
<tr>
<td align="left">打开新页面</td>
<td align="left">open()</td>
</tr>
<tr>
<td align="left">关闭页面</td>
<td align="left">close()</td>
</tr>
</tbody></table>
<ul>
<li>Document<ul>
<li>载入浏览器的HTML文档。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">&#x3c;body&gt;元素</th>
<th align="left">body</th>
</tr>
</thead>
<tbody><tr>
<td align="left">当前cookie</td>
<td align="left">cookie</td>
</tr>
<tr>
<td align="left">文档域名</td>
<td align="left">domain</td>
</tr>
<tr>
<td align="left">文档最后修改日期和时间</td>
<td align="left">lastModified</td>
</tr>
<tr>
<td align="left">访问来源</td>
<td align="left">referrer</td>
</tr>
<tr>
<td align="left">文档标题</td>
<td align="left">title</td>
</tr>
<tr>
<td align="left">当前URL</td>
<td align="left">URL</td>
</tr>
<tr>
<td align="left">返回指定id的引用对象</td>
<td align="left">getElementById()</td>
</tr>
<tr>
<td align="left">返回指定名称的对象集合</td>
<td align="left">getElementByName()</td>
</tr>
<tr>
<td align="left">返回指定标签名的对象集合</td>
<td align="left">getElementByTagName()</td>
</tr>
<tr>
<td align="left">打开流接收输入输出</td>
<td align="left">open()</td>
</tr>
<tr>
<td align="left">向文档输入</td>
<td align="left">write()</td>
</tr>
</tbody></table>
<ul>
<li>Navigator<ul>
<li>Navigator对象包含的属性描述了当前使用的浏览器，可以使用这些属性进行平台专用的配置。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">用户代理</th>
<th align="left">userAgent</th>
</tr>
</thead>
<tbody><tr>
<td align="left">浏览器代码名</td>
<td align="left">AppCodeName</td>
</tr>
<tr>
<td align="left">浏览器名称</td>
<td align="left">AppName</td>
</tr>
<tr>
<td align="left">浏览器版本</td>
<td align="left">AppVersion</td>
</tr>
<tr>
<td align="left">浏览器语言</td>
<td align="left">browserLanguage</td>
</tr>
<tr>
<td align="left">指明是否启用cookie的布尔值</td>
<td align="left">cookieEnabled</td>
</tr>
<tr>
<td align="left">浏览器系统的cpu等级</td>
<td align="left">cpuClass</td>
</tr>
<tr>
<td align="left">是否处于脱机模式</td>
<td align="left">onLine</td>
</tr>
<tr>
<td align="left">浏览器的操作系统平台</td>
<td align="left">platform</td>
</tr>
<tr>
<td align="left">插件，所有嵌入式对象的引用</td>
<td align="left">plugins</td>
</tr>
<tr>
<td align="left">是否启用驱动</td>
<td align="left">webdriver</td>
</tr>
<tr>
<td align="left">引擎名</td>
<td align="left">product</td>
</tr>
<tr>
<td align="left">硬件支持并发数</td>
<td align="left">hardwareConcurrency</td>
</tr>
<tr>
<td align="left">网络信息</td>
<td align="left">connection</td>
</tr>
<tr>
<td align="left">是否启用java</td>
<td align="left">javaEnabled()</td>
</tr>
<tr>
<td align="left">是否启用数据污点</td>
<td align="left">taintEnabled()</td>
</tr>
</tbody></table>
<ul>
<li>Location<ul>
<li>Location对象包含有关当前URL的信息</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">URL锚</th>
<th align="left">hash</th>
</tr>
</thead>
<tbody><tr>
<td align="left">当前主机名和端口号</td>
<td align="left">host</td>
</tr>
<tr>
<td align="left">当前主机名</td>
<td align="left">hostname</td>
</tr>
<tr>
<td align="left">当前URL</td>
<td align="left">href</td>
</tr>
<tr>
<td align="left">当前URL的路径</td>
<td align="left">pathname</td>
</tr>
<tr>
<td align="left">当前URL的端口号</td>
<td align="left">port</td>
</tr>
<tr>
<td align="left">当前URL的协议</td>
<td align="left">protocol</td>
</tr>
<tr>
<td align="left">设置URL查询部分</td>
<td align="left">search</td>
</tr>
<tr>
<td align="left">加载新文件</td>
<td align="left">assign()</td>
</tr>
<tr>
<td align="left">重新加载文件</td>
<td align="left">reload()</td>
</tr>
<tr>
<td align="left">替换当前文档</td>
<td align="left">replace()</td>
</tr>
</tbody></table>
<ul>
<li>Screen<ul>
<li>每个window对象的screen属性都引用一个Screen对象。Screen对象中存放着有关显示浏览器屏幕的信息。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">屏幕高度</th>
<th align="left">avaiHeight</th>
</tr>
</thead>
<tbody><tr>
<td align="left">屏幕宽度</td>
<td align="left">availWidth</td>
</tr>
<tr>
<td align="left">调色版比特深度</td>
<td align="left">bufferDepth</td>
</tr>
<tr>
<td align="left">显示屏每英寸水平点数</td>
<td align="left">deviceXDPI</td>
</tr>
<tr>
<td align="left">显示屏每英寸垂直点数</td>
<td align="left">deviceYDPI</td>
</tr>
<tr>
<td align="left">是否启用字体平滑</td>
<td align="left">fontSmoothingEnabled</td>
</tr>
<tr>
<td align="left">显示屏高度</td>
<td align="left">height</td>
</tr>
<tr>
<td align="left">显示屏分辨率</td>
<td align="left">pixeIDepth</td>
</tr>
<tr>
<td align="left">屏幕刷新率</td>
<td align="left">updateInterval</td>
</tr>
<tr>
<td align="left">显示屏宽度</td>
<td align="left">width</td>
</tr>
</tbody></table>
<ul>
<li>History<ul>
<li>History对象包含用户在浏览器窗口中访问过的URL。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>浏览器历史列表中的URL数量</th>
<th>length</th>
</tr>
</thead>
<tbody><tr>
<td>加载前一个URL</td>
<td>back()</td>
</tr>
<tr>
<td>加载下一个URL</td>
<td>forward()</td>
</tr>
<tr>
<td>加载某个具体页面</td>
<td>go()</td>
</tr>
</tbody></table>
<p>window中还有很多属性和方法，这里就不再过多的描述，大家可以自行查看。</p>
<h3 id="1-4-事件"><a href="#1-4-事件" class="headerlink" title="1.4 事件"></a>1.4 事件</h3><p>HTML 事件是发生在 HTML 元素上的事情。</p>
<p>当在 HTML 页面中使用 JavaScript 时， JavaScript 可以触发这些事件。</p>
<p>HTML 事件可以是浏览器行为，也可以是用户行为。</p>
<p>以下是 HTML 事件的实例：</p>
<ul>
<li>HTML 页面完成加载</li>
<li>HTML input 字段改变时</li>
<li>HTML 按钮被点击</li>
</ul>
<p>通常，当事件发生时，你可以做些事情。</p>
<p>在事件触发时 JavaScript 可以执行一些代码。</p>
<p>HTML 元素中可以添加事件属性，使用 JavaScript 代码来添加 HTML 元素。</p>
<p>事件可以用于处理表单验证，用户输入，用户行为及浏览器动作:</p>
<ul>
<li>页面加载时触发事件</li>
<li>页面关闭时触发事件</li>
<li>用户点击按钮执行动作</li>
<li>验证用户输入内容的合法性</li>
<li>等等 …</li>
</ul>
<p>可以使用多种方法来执行 JavaScript 事件代码：</p>
<ul>
<li>HTML 事件属性可以直接执行 JavaScript 代码</li>
<li>HTML 事件属性可以调用 JavaScript 函数</li>
<li>你可以为 HTML 元素指定自己的事件处理程序</li>
<li>你可以阻止事件的发生。</li>
<li>等等 ..</li>
</ul>
<p>HTML事件</p>
<table>
<thead>
<tr>
<th align="left">事件</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">onclick</td>
<td align="left">当用户单击HTML元素时触发</td>
</tr>
<tr>
<td align="left">ondblclick</td>
<td align="left">当用户双击对象时触发</td>
</tr>
<tr>
<td align="left">onmove</td>
<td align="left">当对象移动时触发</td>
</tr>
<tr>
<td align="left">onmoveend</td>
<td align="left">当对象停止移动时触发</td>
</tr>
<tr>
<td align="left">onmovestart</td>
<td align="left">当对象开始移动时触发</td>
</tr>
<tr>
<td align="left">onkeydown</td>
<td align="left">当用户按下键盘按键时触发</td>
</tr>
<tr>
<td align="left">onkeyup</td>
<td align="left">当用户释放键盘按键时触发</td>
</tr>
<tr>
<td align="left">onload</td>
<td align="left">当某个页面或图像被完成加载</td>
</tr>
<tr>
<td align="left">onselect</td>
<td align="left">当文本被选定</td>
</tr>
<tr>
<td align="left">onblur</td>
<td align="left">当元素失去焦点</td>
</tr>
<tr>
<td align="left">onchange</td>
<td align="left">当HTML元素改变时触发</td>
</tr>
<tr>
<td align="left">onfocusin</td>
<td align="left">当元素将要被设置为焦点之前触发</td>
</tr>
<tr>
<td align="left">onhelp</td>
<td align="left">当用户在按F1键时触发</td>
</tr>
<tr>
<td align="left">onkeypress</td>
<td align="left">当用户按下字面键时触发</td>
</tr>
<tr>
<td align="left">onmousedown</td>
<td align="left">当用户用任何鼠标按钮单击对象时触发</td>
</tr>
<tr>
<td align="left">onmousemove</td>
<td align="left">当用户将鼠标划过对象时触发</td>
</tr>
<tr>
<td align="left">onmouseover</td>
<td align="left">当用户从一个HTML元素上移动鼠标时触发</td>
</tr>
<tr>
<td align="left">onmouseout</td>
<td align="left">当用户从一个HTML元素上移开鼠标时触发</td>
</tr>
<tr>
<td align="left">onmouseup</td>
<td align="left">当用户在对象之上释放鼠标按钮时触发</td>
</tr>
<tr>
<td align="left">onmousewheel</td>
<td align="left">当鼠标滚轮按钮旋转时触发</td>
</tr>
<tr>
<td align="left">onstop</td>
<td align="left">当用户单击停止按钮或者离开页面时触发</td>
</tr>
<tr>
<td align="left">onactivate</td>
<td align="left">当对象设置为活动元素时触发</td>
</tr>
<tr>
<td align="left">onreadystatechange</td>
<td align="left">当在对象上发生对象属性更改时触发</td>
</tr>
<tr>
<td align="left">ondragend</td>
<td align="left">当用户拖拽操作结束后释放鼠标时触发</td>
</tr>
</tbody></table>
<p>接下来说一下HTMl中绑定事件的几种方法，分别是行内绑定、动态绑定、事件监听、bind和on绑定。</p>
<ul>
<li>行内绑定是指把触发事件直接写到元素的标签中</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;li&gt;</span><br><span class="line">    &lt;div onclick=&quot;xxx()&quot;&gt;点击&lt;/div&gt;</span><br><span class="line">&lt;/li&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>动态绑定是指先获取到dom元素，然后在元素上绑定事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var xx = document.getElementById(&quot;lx&quot;);</span><br><span class="line">    xx.onclick = function()&#123;&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>事件监听主要通过addEventListener()方法来实现</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var xx = document.getElementById(&quot;lx&quot;);</span><br><span class="line">    xx.addEventListener(&quot;click&quot;, function()&#123;&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>bind()和on()绑定都是属于JQuery的事件绑定方法，bind()的事件函数只能针对已经存在的元素进行事件的设置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;button&quot;).bind(&quot;click&quot;,function()&#123;</span><br><span class="line">    $(&quot;p&quot;).slideToggle();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>on()支持对将要添加的新元素设置事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line">    $(&quot;p&quot;).on(&quot;click&quot;, function()&#123;&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>还有live()和delegate()等事件绑定方法，目前并不常用。</p>
<h2 id="第二章-浏览器控制台"><a href="#第二章-浏览器控制台" class="headerlink" title="第二章 浏览器控制台"></a>第二章 浏览器控制台</h2><p>首先介绍一下浏览器控制台的使用，以开发者使用最多的chrome为例。Windows操作系统下的F12键可以打开控制台，mac操作系统下用Fn+F12键打开。我们选择平时使用较多的模块进行介绍</p>
<h3 id="2-1-Network"><a href="#2-1-Network" class="headerlink" title="2.1 Network"></a>2.1 Network</h3><p>Network是Js调试的重点，面板上由控制器、过滤器、数据流概览、请求列表、数据统计这五部分组成。</p>


<ul>
<li>控制器：Presserve Log是保留请求日志的作用，在跳转页面的时候勾选上可以看到跳转前的请求。Disable cache是禁止缓存的作用，Offline是离线模拟。</li>
<li>过滤器：根据规则过滤器请求列表的内容，可以选择XHR,JS,CSS,WS等。</li>
<li>数据流概览：显示HTTP请求、响应的时间轴。</li>
<li>请求列表：默认是按时间排序，可以看到浏览器所有的请求，主要用于网络请求的查看和分析，可以查看请求头、响应状态和内容、Form表单等。</li>
<li>数据统计：请求总数、总数据量、总花费时间等。</li>
</ul>
<p>浏览器控制台Network下各项属性的含义</p>
<p>作用:</p>
<ul>
<li>可以查看调取接口是否正确，后台返回的数据；</li>
<li>查看请求状态、请求类型、请求地址</li>
</ul>
<h4 id="2-1-1-Network-Headers"><a href="#2-1-1-Network-Headers" class="headerlink" title="2.1.1 Network-Headers"></a>2.1.1 Network-Headers</h4><p>首先打开控制台，找到Network. 刷新页面可以看到Name</p>
<p>Name对应的是资源的名称及路径, Status Code 是请求服务器返回的状态码，一般情况下当状态码为200时，则表示接口匹配成功。点击任一文件名，右侧会出现Header选项。</p>


<h5 id="Network-Header-General"><a href="#Network-Header-General" class="headerlink" title="Network-Header-General"></a>Network-Header-General</h5><ul>
<li>Request URL: 资源请求的url</li>
<li>Request Method: 请求方法（HTTP方法）</li>
<li>Status Code: 状态码<ul>
<li>200(状态码) OK</li>
<li>301 - 资源（网页等）被永久转移到其它URL</li>
<li>404 - 请求的资源（网页等）不存在</li>
<li>500 - 内部服务器错误(后台问题)</li>
</ul>
</li>
<li>Remote Address: 远程地址;</li>
<li>Referrer Policy:  控制请求头中 refrrer 的内容<br>包含值的情况:<ul>
<li>“”, 空串默认按照浏览器的机制设置referrer的内容，默认情况下是和no-referrer-when-downgrade设置得一样</li>
<li>“no-referrer”, 不显示 referrer的任何信息在请求头中</li>
<li>“no-referrer-when-downgrade”,  默认值。当从https网站跳转到http网站或者请求其资源时（安全降级HTTPS→HTTP），不显示 referrer的信息，其他情况（安全同级HTTPS→HTTPS，或者HTTP→HTTP）则在 referrer中显示完整的源网站的URL信息</li>
<li>“same-origin”,  表示浏览器只会显示 referrer信息给同源网站，并且是完整的URL信息。所谓同源网站，是协议、域名、端口都相同的网站</li>
<li>“origin”,  表示浏览器在 referrer字段中只显示源网站的源地址（即协议、域名、端口），而不包括完整的路径</li>
<li>“strict-origin”,  该策略更为安全些，和 origin策略相似，只是不允许 referrer信息显示在从https网站到http网站的请求中（安全降级）</li>
<li>“origin-when-cross-origin”,  当发请求给同源网站时，浏览器会在 referrer中显示完整的URL信息，发个非同源网站时，则只显示源地址（协议、域名、端口）</li>
<li>“strict-origin-when-cross-origin”,  和 origin-when-cross-origin相似，只是不允许 referrer信息显示在从https网站到http网站的请求中（安全降级）</li>
<li>“unsafe-url”  浏览器总是会将完整的URL信息显示在 referrer字段中，无论请求发给任何网站</li>
<li>补充: 什么是referrer?<ul>
<li>当一个用户点击页面中的一个链接，然后跳转到目标页面时，本变页面会收到一个信息,即用户是从哪个源链接跳转过来的。</li>
<li>也就是说当你发起一个HTTP请求，请求头中的 referrer 字段就说明了你是从哪个页面发起该请求的;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="Network-Header-Response-Headers"><a href="#Network-Header-Response-Headers" class="headerlink" title="Network-Header-Response Headers"></a>Network-Header-Response Headers</h5><ul>
<li>Access-Control-Allow-Origin: 请求头中允许设置的请求方法</li>
<li>Connection: 连接方式</li>
<li>content-length: 响应数据的数据长度，单位是byte</li>
<li>content-type:  客户端发送的类型及采用的编码方式</li>
<li>Date: 客户端请求服务端的时间</li>
<li>Vary: 用来指示缓存代理（例如squid）根据什么条件去缓存一个请求</li>
<li>Last-Modified:  服务端对该资源最后修改的时间</li>
<li>Server:  服务端的web服务端名</li>
<li>Content-Encoding:  gzip 压缩编码类型</li>
<li>Transfer-Encoding:chunked:  分块传递数据到客户端</li>
</ul>
<h5 id="Network-Header-Request-Headers"><a href="#Network-Header-Request-Headers" class="headerlink" title="Network-Header-Request Headers"></a>Network-Header-Request Headers</h5><ul>
<li>Accept: 客户端能接收的资源类型</li>
<li>Accept-Encoding:  客户端能接收的压缩数据的类型</li>
<li>Accept-Language:  客户端接收的语言类型</li>
<li>Cache-Control: no-cache 服务端禁止客户端缓存页面数据</li>
<li>Connection: keep-alive 维护客户端和服务端的连接关系</li>
<li>Cookie:客户端暂存服务端的信息</li>
<li>Host:  连接的目标主机和端口号</li>
<li>Pragma: no-cache 服务端禁止客户端缓存页面数据</li>
<li>Referer:  来于哪里(即从哪个页面跳转过来的)</li>
<li>User-Agent:  客户端版本号的名字</li>
</ul>
<h3 id="2-2-Sources"><a href="#2-2-Sources" class="headerlink" title="2.2 Sources"></a>2.2 Sources</h3><p>Sources按列分为三列，从左至右分别是文件列表区、当前文件区、断点调试区。</p>


<p>文件列表区中有Page、Snippets、FileSytem等。Page可以看到当前所在的文件位置，在Snippets中单击New Snippets可以添加自定义的Js代码，FileSytem可以把本地的文件系统导入到chrome中。</p>
<p>当前文件区是需要重点操作的区域，单击下方的{}来格式化代码，就能看到美观的Js代码，然后可以根据指定行数进行断点调试。</p>
<p>断点调试区也非常重要，每个操作点都需要了解是什么作用。最上方的功能区分别是暂停、跳过、进入、跳出、步骤进入、禁用断点、异常断点。</p>
<p>Watch：变量监听，对加入监听列表的变量进行监听。</p>
<p>Call Stack：断点的调用堆栈列表，完整地显示了导致代码被暂停的执行路径。</p>
<p>Scope：当前断点所在函数执行的作用域内容。</p>
<p>Breakpoints：断点列表，将每个断点所在文件&#x2F;行数&#x2F;改成简略内容进行展示。</p>
<p>DOM Breakpoints：DOM断点列表。</p>
<p>XHR&#x2F;fetch Breakpoints：对达到满足过滤条件的请求进行断点拦截。</p>
<p>Event Listener Breakpoints：打开可监听的事件监听列表，可以在监听事件并且触发该事件时进入断点，调试器会停留在触发事件代码行。</p>
<h3 id="2-3-Application"><a href="#2-3-Application" class="headerlink" title="2.3 Application"></a>2.3 Application</h3><p>Application是应用管理部分，主要记录网站加载的所有资源信息。包括存储数据（Local Storage、Session Storage、InDexedDB、Web SQL、Cookies）、缓存数据、字体、图片、脚本、样式表等。Local Storage（本地存储）和 Session Storage中可以查看和管理其存储的键值对。这里使用最多的是对Cookies的管理了，有时候调试需要清除Cookies，可以在Application的Cookies位置单击鼠标右键，选择Clear进行清除，或者根据Cookies中指定的Name和Value来进行清除，便于进一步调试。</p>


<p>注意：我们辨别Cookie来源时，可以看httpOnly这一栏，有√的是来自于服务端，没有√的则是本地生成的。</p>
<h3 id="2-4-Console"><a href="#2-4-Console" class="headerlink" title="2.4 Console"></a>2.4 Console</h3><p>谷歌控制台中的Console区域用于审查DOM元素、调试JavaScript代码、查看HTML解析，一般是通过Console.log()来输出调试信息。在Console中也可以输出window、document、location等关键字查看浏览器环境，如果对某函数使用了断点，也可以在Console中调用该函数。</p>
<p>如果你平时只是用console.log()来输出一些变量的值，那你肯定还没有用过console的强大的功能。下面带你用console玩玩花式调试。</p>
<p>来看下主要的调试函数及用法：</p>
<p>console.log(), console.error(), console.warn(), console.info()</p>
<p>最基本也是最常用的用法了，分别表示输出普通信息、错误信息、警示信息和提示性信息，且error和warn方法有特定的图标和颜色标识。</p>
<ul>
<li><p>console.assert(expression, message)</p>
<ul>
<li><p>参数：</p>
</li>
<li><p>expression: 条件语句，语句会被解析成 Boolean，且为 false 的时候会触发message语句输出</p>
</li>
<li><p>message: 输出语句，可以是任意类型</p>
</li>
<li><p>该函数会在 expression 为 false 的时候，在控制台输出一段语句，输出的内容就是传入的第二个参数 message 的内容。当我们在只需要在特定的情况下才输出语句的时候，可以使用 console.assert</p>
</li>
<li><p>示例如下：</p>
</li>
<li><pre><code>function greaterThan(a,b) &#123;
console.assert(a &gt; b, &#123;&quot;message&quot;:&quot;a is not greater than b&quot;,&quot;a&quot;:a,&quot;b&quot;:b&#125;);
&#125;
greaterThan(5,6);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* console.count(label)</span><br><span class="line"></span><br><span class="line">  * 参数：</span><br><span class="line"></span><br><span class="line">  * label: 计算数量的标识符</span><br><span class="line"></span><br><span class="line">  * 该函数用于计算并输出特定标识符为参数的console.count函数被调用的次数。下面的例子更能直观的了解：</span><br><span class="line"></span><br><span class="line">  * ```</span><br><span class="line">    function login(name) &#123;</span><br><span class="line">    console.count(name + &#x27; logged in&#x27;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
<li><p>console.dir(object)</p>
<ul>
<li><p>参数：</p>
</li>
<li><p>object：被输出扎实的对象</p>
</li>
<li><p>该函数用于打印出对象的详细的属性、函数及表达式等信息。如果该对象已经被记录为一个HTML元素，则该HTML元素的DOM表达式的属性会被像下面这样打印出来：</p>
</li>
<li><pre><code>console.dir(document.body);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* console.dirxml(object)</span><br><span class="line"></span><br><span class="line">  * 该函数将打印输出XML元素及其子孙后代元素，且对HTML和XML元素调用 console.dirxml() 和 调用 console.log() 是等价的</span><br><span class="line"></span><br><span class="line">* console.group([label]), console.groupEnd([label])</span><br><span class="line"></span><br><span class="line">  * 参数：</span><br><span class="line"></span><br><span class="line">  * label: group分组的标识符</span><br><span class="line"></span><br><span class="line">  * 在控制台创建一个新的分组，随后输出到控制台上的内容都会自动添加一个缩进，表示该内容属于当前分组，知道调用 console.groupEnd() 之后，当前分组结束。</span><br><span class="line"></span><br><span class="line">  * 举个例子：</span><br><span class="line"></span><br><span class="line">  * ```</span><br><span class="line">    console.log(&quot;This is the outer level&quot;);</span><br><span class="line">    console.group();</span><br><span class="line">    console.log(&quot;Level 2&quot;);</span><br><span class="line">    console.group();</span><br><span class="line">    console.log(&quot;Level 3&quot;);</span><br><span class="line">    console.warn(&quot;More of level 3&quot;);</span><br><span class="line">    console.groupEnd();</span><br><span class="line">    console.log(&quot;Back to level 2&quot;);</span><br><span class="line">    console.groupEnd();</span><br><span class="line">    console.log(&quot;Back to the outer level&quot;);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
<li><p>console.groupCollapsed(label)</p>
<ul>
<li>该函数同console.group()，唯一的区别是该函数的输出默认不展开分组，而console.group()是默认展开分组。</li>
</ul>
</li>
<li><p>console.time([label]), console.timeEnd([label])</p>
<ul>
<li><p>label: 用于标记计时器的名称，不填的话，默认为 default</p>
</li>
<li><p>console.time() 会开始一个计时器，并当执行到 console.timeEnd() 函数时（需要两个函数的lable参数相同），结束计时器，并将计时器的总时间输出到控制台上。</p>
</li>
<li><p>再举几个例子：</p>
</li>
<li><pre><code>console.time();
var arr = new Array(10000);
for (var i = 0; i &lt; arr.length; i++) &#123;
 arr[i] = new Object();
&#125;
console.timeEnd();
// default: 3.696044921875ms
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 对 console.time(label) 设置一个自定义的 label 字段，并使用console.timeEnd(label) 设置相同的 label 字段来结束计时器。</span><br><span class="line"></span><br><span class="line">* ```</span><br><span class="line">  console.time(&#x27;total&#x27;);</span><br><span class="line">  var arr = new Array(10000);</span><br><span class="line">  for (var i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">   arr[i] = new Object();</span><br><span class="line">  &#125;</span><br><span class="line">  console.timeEnd(&#x27;total&#x27;);</span><br><span class="line">  // total: 3.696044921875ms</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>设置多个 label 属性，开启多个计时器同步计时。</p>
</li>
<li><pre><code>console.time(&#39;total&#39;);
console.time(&#39;init arr&#39;);
var arr = new Array(10000);
console.timeEnd(&#39;init arr&#39;);
for (var i = 0; i &lt; arr.length; i++) &#123;
 arr[i] = new Object();
&#125;
console.timeEnd(&#39;total&#39;);
// init arr: 0.0546875ms
// total: 2.5419921875ms
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* console.trace(object)</span><br><span class="line"></span><br><span class="line">  * 该函数将在控制台打印出从 console.trace() 被调用的位置开始的堆栈信息。</span><br><span class="line"></span><br><span class="line">## 第三章 加密参数的定位方法</span><br><span class="line"></span><br><span class="line">想要找到Js加密参数的生成过程，就必须要找到参数的位置，然后通过debug来进行观察调试。我们总结了目前通用的调试方式。每种方法都有其独特的运用之道，大家只有灵活运用这些参数定位方法，才能更好地提高逆向效率。</span><br><span class="line"></span><br><span class="line">### 3.1 巧用搜索</span><br><span class="line"></span><br><span class="line">搜索操作比较简单，打开控制台，通过快捷键Ctrl + F打开搜索框。在Network中的不同位置使用Ctrl + F会打开不同的搜索区域，有全局搜索、页面搜索。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/ba606f4178f941b19cad876f64c99d56.png)</span><br><span class="line"></span><br><span class="line">另外关于搜索也有一定的技巧，如果加密参数的关键词是signature，可以直接全局搜索signature，搜索不到可以尝试搜索sign或者搜索接口名。如果还没有找到位置，则可以使用下面几种方法。</span><br><span class="line"></span><br><span class="line">### 3.2 堆栈调试</span><br><span class="line"></span><br><span class="line">控制台的 Initiator 堆栈调试是我们比较喜欢的调试方式之一，不过新版本的谷歌浏览器才有，如果没有 Initiator 需要更新Chrome版本。Initiator主要是为了监听请求是怎样发起的，通过它可以快速定位到调用栈中。</span><br><span class="line"></span><br><span class="line">具体使用方法是先确定请求的接口，然后进入Initiator，单击第一个Request call stack参数，进入Js文件后，在跳转行上打上断点，然后刷新页面等待调试。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/2f3b17f43f10413d8e0aba0d614ba3d7.png)</span><br><span class="line"></span><br><span class="line">### 3.3 控制台调试</span><br><span class="line"></span><br><span class="line">控制台的Console中可以由console.log()方法来执行某些函数，该方法对于开发调试很有帮助，有时通过输出会比找起来更便捷。在断点到某一处时，可以通过console.log()输出此时的参数来查看状态和属性,console.log()方法在后面的参数还原中也很重要。</span><br><span class="line"></span><br><span class="line">### 3.4 监听XHR</span><br><span class="line"></span><br><span class="line">XHR是XMLHttpRequest的简称，通过监听XHR的断点，可以匹配URl中params参数的触发点和调用堆栈，另外post请求中From Data的参数也可以用XHR来拦截。</span><br><span class="line"></span><br><span class="line">使用方法：打开控制台，单击Sources，右侧有一个XHR/fetch Breakpoints，单击+号即可添加监听事件。像一些URL中的_signature参数就很适合使用XHR断点。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/3aaff6942d4d4f8fa82531d06fc9ede1.png)</span><br><span class="line"></span><br><span class="line">### 3.5 事件监听</span><br><span class="line"></span><br><span class="line">这里其实和监听XHR有些相似，为了方便记忆，我们将其单独放在一个小节中。</span><br><span class="line"></span><br><span class="line">有的时候找不到参数位置，但是知道它的触发条件，此时可以使用事件监听器进行断点，在Sources中有</span><br><span class="line"></span><br><span class="line">DOM Breakpoints、Global Listeners、Event Listener Breakpoints都可以进行DOM事件监听。</span><br><span class="line"></span><br><span class="line">比如需要对Canvas进行断点，就在Event Listener Breakpoints中选择Canvas，勾选Create canvas context时就是对创建canvas时的事件进行了断点。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/f0ea63a713764cef93ed01fc813cbbb0.png)</span><br><span class="line"></span><br><span class="line">### 3.6 添加代码片</span><br><span class="line"></span><br><span class="line">在控制台中添加代码片来完成Js代码注入，也是一种不错的方式。</span><br><span class="line"></span><br><span class="line">使用方法：打开控制台，单击Sources，然后单击左侧的snippets，新建一个Script Snippet，就可以在空白区域编辑Js代码了。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/88b46a5874474715ad973261cf892068.png)</span><br><span class="line"></span><br><span class="line">### 3.7 Hook</span><br><span class="line"></span><br><span class="line">在Js中也需要用到Hook技术，例如当想分析某个cookie是如何生成时，如果想通过直接从代码里搜索该cookie的名称来找到生成逻辑，可能会需要审核非常多的代码。这个时候，如果能够用hook document.cookie的set方法，那么就可以通过打印当时的调用方法堆栈或者直接下断点来定位到该cookie的生成代码位置。</span><br><span class="line"></span><br><span class="line">什么是hook？</span><br><span class="line"></span><br><span class="line">在 JS 逆向中，我们通常把替换原函数的过程都称为 Hook。一般使用 Object.defineProperty() 来进行hook。</span><br><span class="line"></span><br><span class="line">以下先用一段简单的代码理解Hook的过程：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<p>function a() {<br>  console.log(“I’m a.”);<br>}</p>
<p>a &#x3D; function b() {<br>  console.log(“I’m b.”);<br>};</p>
<p>a()  &#x2F;&#x2F; I’m b.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">直接覆盖原函数是以最简单的做法，以上代码将a函数进行了重写，再次调用a函数将会输出I&#x27;m b.</span><br><span class="line"></span><br><span class="line">如果还想执行原来a函数的内容，可以使用中间变量进行存储：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>function a() {<br>  console.log(“I’m a.”);<br>}</p>
<p>var c &#x3D; a;</p>
<p>a &#x3D; function b() {<br>  console.log(“I’m b.”);<br>};</p>
<p>a()  &#x2F;&#x2F; I’m b.<br>c()  &#x2F;&#x2F; I’m a.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">此时，调用 a 函数会输出 I’m b.，调用 c 函数会输出 I’m a.</span><br><span class="line"></span><br><span class="line">这种原函数直接覆盖的方法通常只用来进行临时调试，实用性不大，但是它能够帮助我们理解 Hook 的过程，在实际 JS 逆向过程中，我们会用到更加高级一点的方法，比如 Object.defineProperty()。</span><br><span class="line"></span><br><span class="line">Object.defineProperty()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Object.defineProperty(obj, prop, descriptor)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* obj：需要定义属性的当前对象；</span><br><span class="line">* prop：当前需要定义的属性名；</span><br><span class="line">* descriptor：属性描述符，可以取以下值；</span><br><span class="line"></span><br><span class="line">属性描述符的取值通常为以下：</span><br><span class="line"></span><br><span class="line">| 属性名       | 默认值    | 含义                                         |</span><br><span class="line">| :----------- | :-------- | :------------------------------------------- |</span><br><span class="line">| get          | undefined | 存取描述符，目标属性获取值的方法             |</span><br><span class="line">| set          | undefined | 存取描述符，目标属性设置值的方法             |</span><br><span class="line">| value        | undefined | 数据描述符，设置属性的值                     |</span><br><span class="line">| writable     | false     | 数据描述符，目标属性的值是否可以被重写       |</span><br><span class="line">| enumerable   | false     | 目标属性是否可以被枚举                       |</span><br><span class="line">| configurable | false     | 目标属性是否可以被删除或是否可以再次修改特性 |</span><br><span class="line"></span><br><span class="line">通常情况下，对象的定义与赋值是这样的：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>var people &#x3D; {}<br>people.name &#x3D; “Bob”<br>people[“age”] &#x3D; “18”</p>
<p>console.log(people)<br>&#x2F;&#x2F; { name: ‘Bob’, age: ‘18’ }</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">使用 defineProperty() 方法：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>var people &#x3D; {}</p>
<p>Object.defineProperty(people, ‘name’, {<br>   value: ‘Bob’,<br>   writable: true  &#x2F;&#x2F; 是否可以被重写<br>})</p>
<p>console.log(people.name)  &#x2F;&#x2F; ‘Bob’</p>
<p>people.name &#x3D; “Tom”<br>console.log(people.name)  &#x2F;&#x2F; ‘Tom’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">我们一般hook使用的是get和set方法：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>var people &#x3D; {<br>  name: ‘Bob’,<br>};<br>var count &#x3D; 18;</p>
<p>&#x2F;&#x2F; 定义一个 age 获取值时返回定义好的变量 count<br>Object.defineProperty(people, ‘age’, {<br>  get: function () {<br>    console.log(‘获取值！’);<br>    return count;<br>  },<br>  set: function (val) {<br>    console.log(‘设置值！’);<br>    count &#x3D; val + 1;<br>  },<br>});</p>
<p>console.log(people.age);<br>people.age &#x3D; 20;<br>console.log(people.age);</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">输出：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>获取值！<br>18<br>设置值！<br>获取值！<br>21</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">通过这样的方法，我们就可以在设置某个值的时候，添加一些代码，比如 debugger；</span><br><span class="line"></span><br><span class="line">让其断下，然后利用调用栈进行调试，找到参数加密、或者参数生成的地方，需要注意的是，网站加载时首先要运行我们的Hook代码，再运行网站自己的代码，才能够成功断下，这个过程我们可以称之为Hook代码的注入。</span><br><span class="line"></span><br><span class="line">TamperMonkey 注入</span><br><span class="line"></span><br><span class="line">TamperMonkey 俗称油猴插件，是一款免费的浏览器扩展和最为流行的用户脚本管理器，支持很多主流的浏览器， 包括 Chrome、Microsoft Edge、Safari、Opera、Firefox、UC 浏览器、360 浏览器、QQ 浏览器等等，基本上实现了脚本的一次编写，所有平台都能运行，可以说是基于浏览器的应用算是真正的跨平台了。用户可以在 GreasyFork、OpenUserJS 等平台直接获取别人发布的脚本，功能众多且强大，比如视频解析、去广告等。</span><br><span class="line"></span><br><span class="line">来到谋奇异首页，可以看到cookie里面有个__dfp值：</span><br><span class="line"></span><br><span class="line">{% asset_img "928a74c00eaf4da9ac3ad5686a54bd0d.png" "image.png" %}</span><br><span class="line"></span><br><span class="line">我们想通过Hook的方式，让在生成__dfp的地方断下，就可以编写如下函数：</span><br><span class="line"></span><br><span class="line">我们以某奇艺的 cookie 为例来演示如何编写 TamperMonkey 脚本，首先去应用商店安装 TamperMonkey，安装过程不再赘述，然后点击图标，添加新脚本，或者点击管理面板，再点击加号新建脚本，写入以下代码：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>(function () {<br>  ‘use strict’;<br>  var cookieTemp &#x3D; ‘’;<br>  Object.defineProperty(document, ‘cookie’, {<br>    set: function (val) {<br>      if (val.indexOf(‘__dfp’) !&#x3D; -1) {<br>        debugger;<br>      }<br>      console.log(‘Hook捕获到cookie设置-&gt;’, val);<br>      cookieTemp &#x3D; val;<br>      return val;<br>    },<br>    get: function () {<br>      return cookieTemp;<br>    },<br>  });<br>})();</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`if (val.indexOf(&#x27;__dfp&#x27;) != -1) &#123;debugger;&#125;` 的意思是检索 `__dfp` 在字符串中首次出现的位置，等于 -1 表示这个字符串值没有出现，反之则出现。如果出现了，那么就 debugger 断下，这里要注意的是不能写成 `if (val == &#x27;__dfp&#x27;) &#123;debugger&#125;`，因为 val 传过来的值类似于 `__dfp=xxxxxxxxxx`，这样写是无法断下的。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/e0534b4d30154e86afc78bad51956075.png)</span><br><span class="line"></span><br><span class="line">写入后进行保存</span><br><span class="line"></span><br><span class="line">主体的JavaScript自执行函数和前面的都是一样的，这里需要注意的是最前面的注释，每个选项都是有意义的，所有的选项参考 TamperMonkey 官方文档，以下列出了比较常用、比较重要的部分选项（其中需要特别注意 @match、@include、@run-at）</span><br><span class="line"></span><br><span class="line">| 选项         | 含义                                                         |</span><br><span class="line">| :----------- | :----------------------------------------------------------- |</span><br><span class="line">| @name        | 脚本的名称                                                   |</span><br><span class="line">| @namespace   | 命名空间，用来区分相同名称的脚本，一般写作者名字或者网址就可以 |</span><br><span class="line">| @version     | 脚本版本，油猴脚本的更新会读取这个版本号                     |</span><br><span class="line">| @description | 描述这个脚本是干什么用的                                     |</span><br><span class="line">| @author      | 编写这个脚本的作者的名字                                     |</span><br><span class="line">| @match       | 从字符串的起始位置匹配正则表达式，只有匹配的网址才会执行对应的脚本，例如 * 匹配所有，`https://www.baidu.com/*` 匹配百度等，可以参考 Python re 模块里面的 `re.match()` 方法，允许多个实例 |</span><br><span class="line">| @include     | 和 @match 类似，只有匹配的网址才会执行对应的脚本，但是 @include 不会从字符串起始位置匹配，例如 `*://*baidu.com/*` 匹配百度，具体区别可以参考 [TamperMonkey 官方文档](https://www.tampermonkey.net/documentation.php) |</span><br><span class="line">| @icon        | 脚本的 icon 图标                                             |</span><br><span class="line">| @grant       | 指定脚本运行所需权限，如果脚本拥有相应的权限，就可以调用油猴扩展提供的 API 与浏览器进行交互。如果设置为 none 的话，则不使用沙箱环境，脚本会直接运行在网页的环境中，这时候无法使用大部分油猴扩展的 API。如果不指定的话，油猴会默认添加几个最常用的 API |</span><br><span class="line">| @require     | 如果脚本依赖其他 JS 库的话，可以使用 require 指令导入，在运行脚本之前先加载其它 |</span><br><span class="line">| @run-at      | 脚本注入时机，该选项是能不能 hook 到的关键，有五个值可选：`document-start`：网页开始时；`document-body`：body出现时；`document-end`：载入时或者之后执行；`document-idle`：载入完成后执行，默认选项；`context-menu`：在浏览器上下文菜单中单击该脚本时，一般将其设置为 `document-start` |</span><br><span class="line"></span><br><span class="line">清除 cookie，开启 TamperMonkey 插件，再次来到某奇艺首页，可以成功被断下，也可以跟进调用栈来进一步分析 __dfp 值的来源。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/a89c4a80f91c41e2b176e7cec60868c4.png)</span><br><span class="line"></span><br><span class="line">## 第四章 常见的压缩和混淆</span><br><span class="line"></span><br><span class="line">在Web系统发展早期，Js在Web系统中承担的职责并不多，Js文件比较简单，也不需要任何的保护。随着Js文件体积的增大和前后端交互增多，为了加快http传输速度并提高接口的安全性，出现了很多的压缩工具和混淆加密工具。</span><br><span class="line"></span><br><span class="line">代码混淆的本质是对于代码标识和结构的调整，从而达到不可读不可调用的目的，常用的混淆有字符串、变量名混淆，比如把字符串转换成_0x，把变量重命名等，从结构的混淆包括控制流平坦化，虚假控制流和指令替换，代码加密主要有通过veal方法去执行字符串函数，通过escape()等方法编码字符串、通过转义字符加密代码、自定义加解密方法（RSA、Base64、AES、MD5等），或者通过一些开源的工具进行加密。</span><br><span class="line"></span><br><span class="line">另外目前市面上比较常见的混淆还有ob混淆(obfuscator),特征是定义数组，数组位移。不仅Js中的变量名混淆，运行逻辑等也高度混淆，应对这种混淆可以使用已有的工具ob-decrypt或者AST解混淆或者使用第三方提供的反混淆接口。大家平时可以多准备一些工具，在遇到无法识别的Js时，可以直接使用工具来反混淆和解密，当然逆向工作本身就很看运气。</span><br><span class="line"></span><br><span class="line">* 例如翻看网站的Javascript源代码，可以发现很多压缩或者看不太懂的字符，如javascript文件名被编码，文件的内容被压缩成几行，变量被修改成单个字符或者一些十六进制的字符——这些导致我们无法轻易根据Javascript源代码找出某些接口的加密逻辑。</span><br><span class="line"></span><br><span class="line">### 4.1 JavaScript压缩</span><br><span class="line"></span><br><span class="line">这个非常简单，Javascript压缩即去除JavaScript代码中不必要的空格、换行等内容或者把一些可能公用的代码进行处理实现共享，最后输出的结果都压缩为几行内容，代码的可读性变得很差，同时也能提高网站的加载速度。</span><br><span class="line"></span><br><span class="line">如果仅仅是去除空格、换行这样的压缩方式，其实几乎是没有任何防护作用的，因为这种压缩方式仅仅是降低了代码的直接可读性。因为我们有一些格式化工具可以轻松将JavaScirpt代码变得易读，比如利用IDE、在线工具或Chrome浏览器都能还原格式化的代码。</span><br><span class="line"></span><br><span class="line">这里举一个最简单的JavaScript压缩示例。原来的JavaScript代码是这样的：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>function echo(stringA, stringB){<br>    const name &#x3D; “Germey”;<br>    alert(“hello “ + name);<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">压缩之后就变成这样子：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>function echo(d,c){const e&#x3D;”Germey”;alert(“hello “+e)};</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">可以看到，这里参数的名称都被简化了，代码中的空格也被去掉了，整个代码也被压缩成了一行，代码的整体可读性降低了。</span><br><span class="line"></span><br><span class="line">目前主流的前端开发技术大多都会利用webpack、Rollup等工具进行打包。webpack、Rollup会对源代码进行编译和压缩，输出几个打包好的JavaScript文件，其中我们可以看到输出的JavaScript文件名带有一些不规则的字符串，同时文件内容可能只有几行，变量名都用一些简单字母表示。这其中就包含JavaScript压缩技术，比如一些公共的库输出成bundle文件，一些调用逻辑压缩和转义成冗长的几行代码，这些都属于JavaScript压缩，另外，其中也包含了一些很基础的JavaScript混淆技术，比如把变量名、方法名替换成一些简单的字符，降低代码的可读性。</span><br><span class="line"></span><br><span class="line">但整体来说，JavaScript压缩技术只能在很小的程度上起到防护作用，想要真正的提高防护效果，还得依靠JavaScript混淆和加密技术。</span><br><span class="line"></span><br><span class="line">### 4.2 JavaScript混淆</span><br><span class="line"></span><br><span class="line">JavaScript混淆完全是在JavaScript上面进行的处理，它的目的就是使得JavaScript变得难以阅读和分析，大大降低代码的可读性，是一种很实用的JavaScript保护方案。</span><br><span class="line"></span><br><span class="line">JavaScript混淆技术主要有一下几种。</span><br><span class="line"></span><br><span class="line">* 变量名混淆：将带有含义的变量名、方法名、常量名随机变为无意义的类乱码字符串，降低代码的可读性，如转换成单个字符或十六进制字符串。</span><br><span class="line">* 字符串混淆：将字符串阵列化集中并可进行MD5或Base64加密存储，使代码中不出现明文字符串，这样可以避免使用全局搜索字符串的方式定位到入口。</span><br><span class="line">* 对象键名替换：针对JavaScript对象的属性进行加密转化，隐藏代码之间的调用关系。</span><br><span class="line">* 控制流平坦化：打乱函数原有代码的执行流程及函数调用关系，使代码逻辑变得混乱无序。</span><br><span class="line">* 无用代码注入：随机在代码中插入不会被执行到的无用代码，进一步使代码看起来更加混乱。</span><br><span class="line">* 调试保护：基于调试器特征，对当前运行环境进行检查，加入一些debugger语句，使其在调试模式下难以顺利执行JavaScript代码。</span><br><span class="line">* 多态变异：使JavaScript代码每次被调用时，将代码自身立刻自动发生变异，变为与之前完全不同的代码，即功能完全不变，只是代码形式变异，以此杜绝代码被动态分析和调试。</span><br><span class="line">* 域名锁定：使JavaScript代码只能在指定域名下执行。</span><br><span class="line">* 代码自我保护：如果对JavaScript代码进行格式化，则无法执行，导致浏览器假死。</span><br><span class="line">* 特殊编码：将JavaScript完全编码为人不可读的代码，如表情符号、特殊表示内容、等等。</span><br><span class="line"></span><br><span class="line">总之，以上方案都是JavaScript混淆的实现方式，可以在不同程度上保护JavaScript代码。</span><br><span class="line"></span><br><span class="line">在前端开发中，现在JavaScript混淆的主流实现使javascript-obfuscator和terser这两个库。它们都能提供一些代码混淆功能，也都有对应的webpack和Rollup打包工具的插件。利用它们，我们可以非常方便地实现页面的混淆，最终输出压缩和混淆后的JavaScript代码，使得JavaScript代码的可读性大大降低。</span><br><span class="line"></span><br><span class="line">下面我们以javascript-obfuscator为例来介绍一些代码混淆的实现，了解了实现，那么我们自然就对混淆的机制有了更加深刻的认识。</span><br><span class="line"></span><br><span class="line">javascript-obfuscator的官方介绍内容如下：</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/c48eee1b19cd446598787417b4296e6e.png)</span><br><span class="line"></span><br><span class="line">链接：https://www.javascriptobfuscator.com/</span><br><span class="line"></span><br><span class="line">它是支持ES8的免费、高效的JavaScript混淆库，可以使得JavaScript代码经过混淆后难以被复制、盗用、混淆后的代码具有和原来的代码一模一样的功能。</span><br><span class="line"></span><br><span class="line">首先我们需要安装好Node.js 12.x及以上版本，确保可以正常使用npm命令。</span><br><span class="line"></span><br><span class="line">具体的安装方式如下：</span><br><span class="line"></span><br><span class="line">简单的说 Node.js 就是运行在服务端的 JavaScript。</span><br><span class="line"></span><br><span class="line">Node.js 是一个基于 Chrome JavaScript 运行时建立的一个平台。</span><br><span class="line"></span><br><span class="line">Node.js 是一个事件驱动 I/O 服务端 JavaScript 环境，基于 Google 的 V8 引擎，V8 引擎执行 Javascript 的速度非常快，性能非常好。</span><br><span class="line"></span><br><span class="line">如果你是一个前端程序员，你不懂得像 PHP、Python 或 Ruby 等动态编程语言，然后你想创建自己的服务，那么 Node.js 是一个非常好的选择。</span><br><span class="line"></span><br><span class="line">Node.js 是运行在服务端的 JavaScript，如果你熟悉 Javascript，那么你将会很容易的学会 Node.js。</span><br><span class="line"></span><br><span class="line">* 官网：[https://nodejs.org/](https://nodejs.org/)</span><br><span class="line">* 文档：[https://nodejs.org/en/docs/](https://nodejs.org/en/docs/)</span><br><span class="line">* 中文网：[http://nodejs.cn/](http://nodejs.cn/)</span><br><span class="line">* 基础教程：[https://www.runoob.com/nodejs/nodejs-tutorial.html](https://www.runoob.com/nodejs/nodejs-tutorial.html)</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/0621aa1096f2448badda2f7c7b9e112c.png)</span><br><span class="line"></span><br><span class="line">接着新建一个文件夹，比如js-ob然后进入该文件夹，初始化工作空间：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>npm init</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这里会提示我们输入一些信息，然后创建package.json文件，这就完成了项目的初始化了。</span><br><span class="line"></span><br><span class="line">接下来，我们来安装javascript-obfuscator这个库：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>npm i -D javascript-obfuscator</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">稍等片刻，即可看到本地js-ob文件下生成了一个node_modules文件夹，里面就包含了javascript-obfuscator这个库，这就说明安装成功了。</span><br><span class="line"></span><br><span class="line">![image.png](WebJs逆向/c41cc69bc534440587a6fd37e8e4eb5e.png)</span><br><span class="line"></span><br><span class="line">接下来，我们就可以编写代码来实现一个混淆样例了。比如，新建main.js文件，其内容如下：</span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">const code = `</span><br><span class="line">let x = &#x27;1&#x27; + 1</span><br><span class="line">console.log(&#x27;x&#x27;, x)</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  compact: false,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>这里我们定义了两个变量：一个是code，即需要被混淆的代码；另一个是混淆选项options，是一个Object。接下来，我们引入了javascript-obfuscator这个库，然后定义了一个方法，给其传入code和options来获取混淆之后的代码，最后控制台输出混淆后的代码。</p>
<p>代码逻辑比较简单，我们来执行一下代码：</p>
<p>node main.js</p>
<p>输出结果如下：</p>


<p>看到了吧，那么简单的代码，被我们混淆成了这个样子，其实这里我们就是设定了“控制流平坦化”选项。整体看来，代码的可读性大大降低了，JavaScript调试的难度也大大加强了。</p>
<h3 id="4-3-javascript-obfuscator示例"><a href="#4-3-javascript-obfuscator示例" class="headerlink" title="4.3 javascript-obfuscator示例"></a>4.3 javascript-obfuscator示例</h3><p>下面的例子代码同上</p>
<h4 id="4-3-1-代码压缩"><a href="#4-3-1-代码压缩" class="headerlink" title="4.3.1 代码压缩"></a>4.3.1 代码压缩</h4><p>这里javascript-obfuscator也提供了代码压缩的功能，使用其参数compact即可完成JavaScript代码的压缩，输出为一行内容。参数compact的默认值是true，如果定义为false，则混淆后的代码会分行显示。</p>
<p>如果不设置或者把compact设置为true，结果如下：</p>


<p>可以看到，单行显示的时候，对变量名进行了进一步的混淆，这里变量的命名都变成了十六进制形式的字符串，这是因为启用了一些默认压缩和混淆的方式。总之我们可以看到代码的可读性相比之前大大降低。</p>
<h4 id="4-3-2-变量名混淆"><a href="#4-3-2-变量名混淆" class="headerlink" title="4.3.2 变量名混淆"></a>4.3.2 变量名混淆</h4><p>变量名混淆可以通过在javascript-obfuscator中配置identifierNamesGenerator参数来实现。我们通过这个参数可以控制变量名混淆的方式，如将其设置为hexadecimal，则会将变量名替换为十六进制形式的字符串。该参数的取值如下。</p>
<ul>
<li>hexadecimal：将变量名替换为十六进制形式的字符串，如0xabc123。</li>
<li>mangled：将变量名替换为普通的简写字符，如a，b，c等。</li>
</ul>
<p>该参数的默认值为：hexadecimal</p>
<p>我们将该参数改为：mangled 来试一下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> code = <span class="string">`</span></span><br><span class="line"><span class="string">let x = &#x27;1&#x27; + 1</span></span><br><span class="line"><span class="string">console.log(&#x27;x&#x27;, x)</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  <span class="attr">compact</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">identifierNamesGenerator</span>: <span class="string">&#x27;mangled&#x27;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obfuscator = <span class="built_in">require</span>(<span class="string">&#x27;javascript-obfuscator&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">obfuscate</span>(<span class="params">code, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> obfuscator.<span class="title function_">obfuscate</span>(code, options).<span class="title function_">getObfuscatedCode</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">obfuscate</span>(code, options))</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>


<p>另外，我们还可以通过设置identifiersPrefix参数来控制混淆后的变量前缀，示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">let x = &#x27;1&#x27; + 1</span><br><span class="line">console.log(&#x27;x&#x27;, x)</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  identifiersPrefix: &#x27;kk&#x27;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>


<p>可以看到，混淆后的变量前缀加上了我们自定义的字符串kk。</p>
<p>另外，renameGlobals这个参数还可以指定是否混淆全局变量和函数名称，默认值为false。示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">var $ = function(id)&#123;</span><br><span class="line">	return document.getElementById(id);</span><br><span class="line">&#125;;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  renameGlobals: true,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>


<p>可以看到，这里我们声明了一个全局变量$，在renameGlobals设置为true之后，这个变量也被替换了。如果后文用到了这个变量，可能就会有找不到定义的错误，因此这个参数可能导致代码执行不通。</p>
<p>如果我们不设置 renameGlobals 或者将其设置为false，结果如下：</p>


<p>可以看到，最后还是有$的声明，其全局名称没有被改变。</p>
<h4 id="4-3-3-字符串混淆"><a href="#4-3-3-字符串混淆" class="headerlink" title="4.3.3 字符串混淆"></a>4.3.3 字符串混淆</h4><p>字符串混淆，就是将一个字符串声明放到一个数组里面，使之无法被直接搜索到。这可以通过stringArray参数来控制，默认为true。</p>
<p>此外，我们还可以通过rotateStringArray参数来控制数组化后结果的元素顺序，默认为true。</p>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">var a = &#x27;helloworld&#x27;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  stringArray: true,</span><br><span class="line">  rotateStringArray: true,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>


<p>另外，我们还可以使用unicodeEscapeSequence这个参数对字符串进行Unicode转码，使之更加难以辨认，示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">var a = &#x27;hello world&#x27;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  compact: false,</span><br><span class="line">  unicodeEscapeSequence: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options)</span><br></pre></td></tr></table></figure>



<p>可以看到，这里字符串被数字化和Unicode化，非常难以辨认。</p>
<p>在很多JavaScript逆向过程中，一些关键的字符串可能会作为切入点来查找加密入口，用了这种混淆之后，如果有人想通过全局搜索的方式搜索hello这样的字符串找加密入口，也就没法搜到了。</p>
<h4 id="4-3-4-代码自我保护"><a href="#4-3-4-代码自我保护" class="headerlink" title="4.3.4 代码自我保护"></a>4.3.4 代码自我保护</h4><p>我们可以通过设置selfDefending参数来开启代码自我保护功能。开启之后混淆后的JavaScript会强制以一行显示。如果我们将混淆后的代码进行格式化或者重命名，该段代码将无法执行。</p>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">console.log(&#x27;hello world&#x27;)</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  selfDefending: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>



<p>如果我们将上述代码放到控制台，它的执行结果和之前是一模一样的，没有任何问题。</p>
<p>如果我们将其进行格式化，然后粘贴到浏览器控制台里面，浏览器会直接卡死无法运行。这样如果有人对代码进行了格式化，就无法正常对代码进行运行和调试，从而起到了保护作用。</p>
<h4 id="4-3-5-控制流平坦化"><a href="#4-3-5-控制流平坦化" class="headerlink" title="4.3.5 控制流平坦化"></a>4.3.5 控制流平坦化</h4><p>控制流平坦化其实就是将代码的执行逻辑混淆，使其变得复杂、难度。其基本的思想是将一些逻辑处理块都统一加上一个前驱逻辑块，每个逻辑块都由前驱逻辑块进行条件判断个分发，构成一个个闭环逻辑，这导致整个执行逻辑十分复杂、难度。</p>
<p>比如说这里有一段示例代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">console.log(c);</span><br><span class="line">console.log(a);</span><br><span class="line">console.log(b);</span><br></pre></td></tr></table></figure>

<p>代码逻辑一目了然，一次在控制台输出了c, a, b三个变量的值。但是如果把这段代码进行控制流平坦化处理，代码就会变成这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">console.log(c);</span><br><span class="line">console.log(a);</span><br><span class="line">console.log(b);</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  compact: false,</span><br><span class="line">  controlFlowFlattening: true,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>



<p>使用控制流平坦化可以使得执行逻辑更加复杂、难读，目前非常多的前端混淆都会加上这个选项。但启用控制流平坦化之后，代码的执行时间会变长。</p>
<h4 id="4-3-6-无用代码注入"><a href="#4-3-6-无用代码注入" class="headerlink" title="4.3.6 无用代码注入"></a>4.3.6 无用代码注入</h4><p>无用代码即不会被执行的代码或对上下文没有任何影响的代码，注入之后可以对现有的JavaScript代码的阅读形成干扰。我们可以使用deadCodeInjection参数开启这个选项，其默认值为false。</p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">console.log(c);</span><br><span class="line">console.log(a);</span><br><span class="line">console.log(b);</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  compact: false,</span><br><span class="line">  deadCodeInjection: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>这种混淆方式通过混入一些特殊的判断条件并加入一些不会被执行的代码，可以对代码起到一定的干扰作用。</p>
<h4 id="4-3-7-对象键名替换"><a href="#4-3-7-对象键名替换" class="headerlink" title="4.3.7 对象键名替换"></a>4.3.7 对象键名替换</h4><p>如果是一个对象，可以使用transformObjectKeys来对对象的键值进行替换，示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">(function()&#123;</span><br><span class="line">    var object = &#123;</span><br><span class="line">        foo: &#x27;test1&#x27;,</span><br><span class="line">        bar: &#123;</span><br><span class="line">            baz: &#x27;test2&#x27;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  compact: false,</span><br><span class="line">  transformObjectKeys: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，Object的变量名被替换为了特殊的变量，代码的可读性变差，这样我们就不好直接通过变量名进行搜寻了，这也可以起到一定的防护作用。</p>
<h4 id="4-3-8-禁用控制台输出"><a href="#4-3-8-禁用控制台输出" class="headerlink" title="4.3.8 禁用控制台输出"></a>4.3.8 禁用控制台输出</h4><p>我们可以使用disableConsoleOutput来禁用掉console.log输出功能，加大调试难度，示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">console.log(&#x27;hello world&#x27;)</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">    disableConsoleOutput: true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>



<p>此时，我们如果执行这段代码，发现是没有任何输出的，这里实际上就是将console的一些功能禁用了。</p>
<h4 id="4-3-9-调试保护"><a href="#4-3-9-调试保护" class="headerlink" title="4.3.9 调试保护"></a>4.3.9 调试保护</h4><p>我们知道，如果Javascript代码中加入关键字debugger关键字，那么执行到该位置的时候，就会进入断点调试模式。如果在代码多个位置都加入debugger关键字，或者定义某个逻辑来反复执行debugger，就会不断进入断点调试模式，原本的代码就无法顺畅执行了。这个过程可以称为调试保护，即通过反复执行debugger来使得原来的代码无法顺畅执行。</p>
<p>其效果类似于执行了如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setInterval(() =&gt; &#123;debugger;&#125;, 3000)</span><br></pre></td></tr></table></figure>

<p>如果我们把这段代码粘贴到控制台，它就会反复执行debugger语句，进入断点调试模式，从而干扰正常的调试流程。</p>
<p>在javascript-obfuscator中，我们可以使用debugProtection来启用调试保护机制，还可以使用debugProtectionInterval来启用无限调试（debug），使得代码在调试过程中不断进入断点模式，无法顺畅执行。配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const options = &#123;</span><br><span class="line">    debugProtection: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>混淆后的代码会跳到debugger代码的位置，使得整个代码无法顺畅执行，对JavaScript代码的调试形成干扰。</p>
<h4 id="4-3-10-域名锁定"><a href="#4-3-10-域名锁定" class="headerlink" title="4.3.10 域名锁定"></a>4.3.10 域名锁定</h4><p>我们还可以通过控制domainLock来控制JavaScript代码只能在特定域名下运行，这样就可以降低代码被模拟或者盗用的风险。</p>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const code = `</span><br><span class="line">console.log(&#x27;hello world&#x27;)</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">    domainLock: [&#x27;kk.com&#x27;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const obfuscator = require(&#x27;javascript-obfuscator&#x27;)</span><br><span class="line"></span><br><span class="line">function obfuscate(code, options) &#123;</span><br><span class="line">  return obfuscator.obfuscate(code, options).getObfuscatedCode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obfuscate(code, options))</span><br></pre></td></tr></table></figure>

<p>这里我们使用domainLock指定了一个域名kk.com，也就是设置了一个域名白名单，混淆后的代码结果如下：</p>
<p>这段代码就只能在指定的域名kk.com下运行，不能在其他网站运行。这样的话，如果一些相关JavaScript代码被单独剥离出来，想在其他网站运行或者使用程序模拟运行的话，运行结果只有失败，这样就可以有效降低代码被模拟或盗用的风险。</p>
<h4 id="4-3-11特殊编码"><a href="#4-3-11特殊编码" class="headerlink" title="4.3.11特殊编码"></a>4.3.11特殊编码</h4><p>另外，还有一些特殊的工具包（jjencode，aaencode等）他们可以对代码进行混淆和编码。</p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.sojson.com/">https://www.sojson.com</a></p>
<p>示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var kk = 100</span><br></pre></td></tr></table></figure>

<p>使用jjencode工具的结果：</p>


<p>使用aaencode工具的结果：</p>


<p>可以看到，通过这些工具，原本非常简单的代码被转化为一些几乎完全不可读的代码，但实际上运行效果还是相同的。这些混淆方式比较另类，看起来虽然没有什么头绪，但实际上找到规律是非常好还原的，并没有真正达到强力混淆的效果。</p>
<p>关于这种混淆代码的解码方法，一般直接复制到控制台运行或者用解码工具进行转换，如果运行失败，就需要按分号分割语句，逐行调试分析源码。</p>
<p>以上便是对JavaScript混淆方式的介绍和总结。总的来说经过混淆的JavaScript代码的可读性大大降低，同时其防护效果也大大增强。</p>
<h2 id="第五章-常见的编码和加密"><a href="#第五章-常见的编码和加密" class="headerlink" title="第五章 常见的编码和加密"></a>第五章 常见的编码和加密</h2><p>我们在爬取网站的时候，会遇到一些需要分析接口或URL信息的情况，这时会有各种各样的类似加密的情形。</p>
<ul>
<li>某个网站的URL带有一些看不太懂的长串加密参数，要抓取就得必须懂得这些参数是怎么构造的，否则我们连完整的URL都构造不出来，更不用说爬取了。</li>
<li>在分析某个网站的Ajax接口时，可以看到接口的一些参数也是加密的，Request Headers 里面也可能带有一些加密参数，如果不知道这些参数的具体构造逻辑，就没法直接用程序来模拟这些Ajax请求。</li>
</ul>
<p>常见的编码有base64、unicode、urlencode编码，加密有MD5、SHA1、HMAC、DES、RSA等。</p>
<p>本节简单介绍一下常见的编码加密，同时附上Python实现加密的方法。</p>
<h3 id="5-1-base64"><a href="#5-1-base64" class="headerlink" title="5.1 base64"></a>5.1 base64</h3><p>base64是一种基于64个可打印ASCLL字符对任意字节数据进行编码的算法，其在编码后具有一定意义的加密作用。在逆向过程中经常会碰到base64编码（不论是Js逆向还是安卓逆向）。</p>
<p>浏览器提供了原生的base64编码、解码方法，方法名就是btoa和atob如下图所示：</p>


<p>在python中使用base64：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(base64.<span class="title function_">b64encode</span>(<span class="string">&#x27;msb&#x27;</span>.<span class="title function_">encode</span>()))</span><br><span class="line"><span class="title function_">print</span>(base64.<span class="title function_">b64decode</span>(<span class="string">&#x27;bXNi&#x27;</span>.<span class="title function_">encode</span>()))<span class="keyword">var</span> str1 = <span class="string">&quot;msb&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>unicode和urlencode比较简单，unicode是计算机中字符集、编码的一项业界标准，被称为统一码、万国码，表现形式一般以“\u” 或者 “&amp;#”开头。urlencode是URL编码，也称作百分号编码用于把URL中的符号进行转换。</p>
<h3 id="5-2-MD5"><a href="#5-2-MD5" class="headerlink" title="5.2 MD5"></a>5.2 MD5</h3><p>MD5消息摘要算法（英文：MD5 Message-Digest Algorithm），一种被广泛使用的密码散列函数，可以产出一个128位（16字节）的散列值（hash value），用于确保信息传输完整一致。MD5加密算法是不可逆的，所以解密一般都是通过暴力穷举方法，以及网站的接口实现解密。</p>
<p>python代码实现加密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">pwd = &quot;123&quot;</span><br><span class="line"># 生成MD5对象</span><br><span class="line">m = hashlib.md5()</span><br><span class="line"># 对数据进行加密</span><br><span class="line">m.update(pwd.encode(&#x27;utf-8&#x27;))</span><br><span class="line"># 获取密文</span><br><span class="line">pwd = m.hexdigest()</span><br><span class="line">print(pwd)</span><br></pre></td></tr></table></figure>

<p>解密工具：<a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a></p>


<h3 id="5-3-SHA1"><a href="#5-3-SHA1" class="headerlink" title="5.3 SHA1"></a>5.3 SHA1</h3><p>SHA1（Secure Hash Algorithm）安全哈希算法主要适用于数字签名标准里面定义的数字签名算法，SHA1比MD5的安全性更强。对于长度小于2^64位的消息，SHA1会产生一个160位的消息摘要。</p>
<p>一般在没有高度混淆的Js代码中，SHA1加密的关键词就是sha1。</p>
<p>Python实现代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">sha1 = hashlib.sha1()</span><br><span class="line">data1 = &quot;msb&quot;</span><br><span class="line">data2 = &quot;kkk&quot;</span><br><span class="line">sha1.update(data1.encode(&quot;utf-8&quot;))</span><br><span class="line">sha1_data1 = sha1.hexdigest()</span><br><span class="line">print(sha1_data1)</span><br><span class="line">sha1.update(data2.encode(&quot;utf-8&quot;))</span><br><span class="line">sha1_data2 = sha1.hexdigest()</span><br><span class="line">print(sha1_data2)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>


<p>解密工具：<a target="_blank" rel="noopener" href="http://tool.geekapp.cn/index.php">http://tool.geekapp.cn/index.php</a></p>


<h3 id="5-4-HMAC"><a href="#5-4-HMAC" class="headerlink" title="5.4 HMAC"></a>5.4 HMAC</h3><p>HMAC全称：散列消息鉴别码。HMAC加密算法是一种安全的基于加密hash函数和共享密钥的消息认证协议。实现原理是用公开函数和密钥产生一个固定长度的值作为认证标识，用这个标识鉴别消息的完整性。</p>
<p>python实现代码：</p>
<p>new（key,msg&#x3D;None,digestmod）方法</p>
<ul>
<li>创建哈希对象</li>
<li>key和digestmod参数必须指定，key和msg（需要加密的内容）均为bytes类型，digestmod指定加密算法，比如‘md5’,’sha1’等</li>
</ul>
<p>对象digest（）方法：返回bytes类型哈希值</p>
<p>对象hexdigest（）方法：返回十六进制哈希值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">key = <span class="string">&quot;key&quot;</span>.encode()</span><br><span class="line">text = <span class="string">&quot;msb&quot;</span>.encode()</span><br><span class="line">m = hmac.new(key, text, hashlib.sha256)</span><br><span class="line"><span class="built_in">print</span>(m.digest())</span><br><span class="line"><span class="built_in">print</span>(m.hexdigest())</span><br></pre></td></tr></table></figure>

<h3 id="5-5-DES"><a href="#5-5-DES" class="headerlink" title="5.5 DES"></a>5.5 DES</h3><p>DES全称：数据加密标准（Data Encryption Standard），属于对称加密算法。DES是一个分组加密算法，典型的DES以64位为分组对数据加密，加密和解密用的是同一个算法。它的密钥长度是56位（因为每个第8位都用作奇偶校验），密钥可以是任意的56位数，而且可以任意时候改变。</p>
<p>Js逆向时，DES加密的搜索关键词有DES、mode、padding等。</p>
<p>python实现代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># pyDes需要安装</span><br><span class="line">from pyDes import des, CBC, PAD_PKCS5</span><br><span class="line">import binascii</span><br><span class="line"># 秘钥</span><br><span class="line">KEY = &#x27;dsj2020q&#x27;</span><br><span class="line">def des_encrypt(s):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    DES 加密</span><br><span class="line">    :param s: 原始字符串</span><br><span class="line">    :return: 加密后字符串，16进制</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    secret_key = KEY</span><br><span class="line">    iv = secret_key</span><br><span class="line">    k = des(secret_key, CBC, iv, pad=None, padmode=PAD_PKCS5)</span><br><span class="line">    en = k.encrypt(s, padmode=PAD_PKCS5)</span><br><span class="line">    return binascii.b2a_hex(en).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def des_decrypt(s):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    DES 解密</span><br><span class="line">    :param s: 加密后的字符串，16进制</span><br><span class="line">    :return:  解密后的字符串</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    secret_key = KEY</span><br><span class="line">    iv = secret_key</span><br><span class="line">    k = des(secret_key, CBC, iv, pad=None, padmode=PAD_PKCS5)</span><br><span class="line">    de = k.decrypt(binascii.a2b_hex(s), padmode=PAD_PKCS5)</span><br><span class="line">    return de.decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">text = &#x27;msb&#x27;</span><br><span class="line">secret_str = des_encrypt(text)</span><br><span class="line">print(secret_str)</span><br><span class="line"></span><br><span class="line">clear_str = des_decrypt(secret_str)</span><br><span class="line">print(clear_str)</span><br></pre></td></tr></table></figure>

<h3 id="5-5-AES"><a href="#5-5-AES" class="headerlink" title="5.5 AES"></a>5.5 AES</h3><p>AES全程：高级加密标准，在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。</p>
<p>AES也是对称加密算法，如果能够获取到密钥，那么就能对密文解密。</p>
<p>Js逆向时，AES加密的搜索关键词有AES、mode、padding等。</p>
<p>python代码实现之前</p>
<p>pip install pycryptodome</p>
<p>python实现代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line"># AES</span><br><span class="line"># 需要补位，str不是16的倍数那就补足为16的倍数</span><br><span class="line">def add_to_16(value):</span><br><span class="line">    while len(value) % 16 != 0:</span><br><span class="line">        value += &#x27;\0&#x27;</span><br><span class="line">    return str.encode(value)  # 返回bytes</span><br><span class="line"></span><br><span class="line"># 加密方法</span><br><span class="line">def encrypt(key, text):</span><br><span class="line">    aes = AES.new(add_to_16(key), AES.MODE_ECB)  # 初始化加密器</span><br><span class="line">    encrypt_aes = aes.encrypt(add_to_16(text))  # 先进行aes加密</span><br><span class="line">    encrypted_text = str(base64.encodebytes(encrypt_aes), encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    return encrypted_text</span><br><span class="line"></span><br><span class="line"># 解密方法</span><br><span class="line">def decrypt(key, text):</span><br><span class="line">    aes = AES.new(add_to_16(key), AES.MODE_ECB)  # 初始化加密器</span><br><span class="line">    base64_decrypted = base64.decodebytes(text.encode(encoding=&#x27;utf-8&#x27;))</span><br><span class="line">    decrypted_text = str(aes.decrypt(base64_decrypted), encoding=&#x27;utf-8&#x27;).replace(&#x27;\0&#x27;, &#x27;&#x27;)  # 执行解密密并转码返回str</span><br><span class="line">    return decrypted_text</span><br></pre></td></tr></table></figure>

<h3 id="5-6-RSA"><a href="#5-6-RSA" class="headerlink" title="5.6 RSA"></a>5.6 RSA</h3><p>RSA全称：Rivest-Shamir-Adleman, RSA加密算法是一种非对称加密算法，在公开密钥加密和电子商业中RSA被广泛使用，它被普遍认为是目前最优秀的公钥方案之一。RSA是第一个能同时用于加密和数字签名的算法，它能够抵抗目前为止已知的所有密码攻击。</p>
<p>注意Js代码中的RSA常见标志setPublickey。</p>
<p>算法原理参考：<a target="_blank" rel="noopener" href="https://www.yht7.com/news/184380">https://www.yht7.com/news/184380</a></p>
<p>实现代码之前先安装 ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome </span><br></pre></td></tr></table></figure>

<p>python代码实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">from Crypto.Cipher import PKCS1_v1_5</span><br><span class="line">from Crypto import Random</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------------------------生成密钥对------------------------</span><br><span class="line">def create_rsa_pair(is_save=False):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    创建rsa公钥私钥对</span><br><span class="line">    :param is_save: default:False</span><br><span class="line">    :return: public_key, private_key</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    f = RSA.generate(2048)</span><br><span class="line">    private_key = f.exportKey(&quot;PEM&quot;)  # 生成私钥</span><br><span class="line">    public_key = f.publickey().exportKey()  # 生成公钥</span><br><span class="line">    if is_save:</span><br><span class="line">        with open(&quot;crypto_private_key.pem&quot;, &quot;wb&quot;) as f:</span><br><span class="line">            f.write(private_key)</span><br><span class="line">        with open(&quot;crypto_public_key.pem&quot;, &quot;wb&quot;) as f:</span><br><span class="line">            f.write(public_key)</span><br><span class="line">    return public_key, private_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def read_public_key(file_path=&quot;crypto_public_key.pem&quot;) -&gt; bytes:</span><br><span class="line">    with open(file_path, &quot;rb&quot;) as x:</span><br><span class="line">        b = x.read()</span><br><span class="line">        return b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def read_private_key(file_path=&quot;crypto_private_key.pem&quot;) -&gt; bytes:</span><br><span class="line">    with open(file_path, &quot;rb&quot;) as x:</span><br><span class="line">        b = x.read()</span><br><span class="line">        return b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------------------------加密------------------------</span><br><span class="line">def encryption(text: str, public_key: bytes):</span><br><span class="line">    # 字符串指定编码（转为bytes）</span><br><span class="line">    text = text.encode(&quot;utf-8&quot;)</span><br><span class="line">    # 构建公钥对象</span><br><span class="line">    cipher_public = PKCS1_v1_5.new(RSA.importKey(public_key))</span><br><span class="line">    # 加密（bytes）</span><br><span class="line">    text_encrypted = cipher_public.encrypt(text)</span><br><span class="line">    # base64编码，并转为字符串</span><br><span class="line">    text_encrypted_base64 = base64.b64encode(text_encrypted).decode()</span><br><span class="line">    return text_encrypted_base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------------------------解密------------------------</span><br><span class="line">def decryption(text_encrypted_base64: str, private_key: bytes):</span><br><span class="line">    # 字符串指定编码（转为bytes）</span><br><span class="line">    text_encrypted_base64 = text_encrypted_base64.encode(&quot;utf-8&quot;)</span><br><span class="line">    # base64解码</span><br><span class="line">    text_encrypted = base64.b64decode(text_encrypted_base64)</span><br><span class="line">    # 构建私钥对象</span><br><span class="line">    cipher_private = PKCS1_v1_5.new(RSA.importKey(private_key))</span><br><span class="line">    # 解密（bytes）</span><br><span class="line">    text_decrypted = cipher_private.decrypt(text_encrypted, Random.new().read)</span><br><span class="line">    # 解码为字符串</span><br><span class="line">    text_decrypted = text_decrypted.decode()</span><br><span class="line">    return text_decrypted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # 生成密钥对</span><br><span class="line">    # create_rsa_pair(is_save=True)</span><br><span class="line">    # public_key = read_public_key()</span><br><span class="line">    # private_key = read_private_key()</span><br><span class="line">    public_key, private_key = create_rsa_pair(is_save=False)</span><br><span class="line"></span><br><span class="line">    # 加密</span><br><span class="line">    text = &quot;msb&quot;</span><br><span class="line">    text_encrypted_base64 = encryption(text, public_key)</span><br><span class="line">    print(&quot;密文：&quot;, text_encrypted_base64)</span><br><span class="line"></span><br><span class="line">    # 解密</span><br><span class="line">    text_decrypted = decryption(text_encrypted_base64, private_key)</span><br><span class="line">    print(&quot;明文：&quot;, text_decrypted)</span><br></pre></td></tr></table></figure>

<h2 id="第六章-加密参数还原与模拟"><a href="#第六章-加密参数还原与模拟" class="headerlink" title="第六章 加密参数还原与模拟"></a>第六章 加密参数还原与模拟</h2><p>加密参数还原的逻辑很简单，找到代码中加密参数的生成过程，然后模拟出相同的方法。很多时候会卡到加密参数定位上，然后遇到混淆加密过的复杂Js，导致还原的过程无比艰辛。本章我们准备了由易到难的逆向案例，带大家体验精彩的逆向过程。</p>
<h3 id="6-1-Newrank榜单逆向案例"><a href="#6-1-Newrank榜单逆向案例" class="headerlink" title="6.1 Newrank榜单逆向案例"></a>6.1 Newrank榜单逆向案例</h3><p>本节内容是分析新榜榜单接口的加密参数，网页上的微信榜、微博榜、抖音榜、快手榜、bilibili榜、资讯等都使用了相同的参数。</p>


<p>网站链接：<a target="_blank" rel="noopener" href="https://www.newrank.cn/public/info/list.html">https://www.newrank.cn/public/info/list.html</a></p>
<p>首先通过控制台抓包，以微信榜单的文化日榜为例查看接口，如图所示：</p>


<p>已知post请求，再看From Data，发现两个加密参数nonce和xyz，如图所示：</p>


<p>通过Ctrl+F快捷键全局搜索nonce和xyz关键字，如图所示：</p>


<p>可以在控制台输入j查看该方法的内容：</p>


<p>可用鼠标双击函数跳转查看：</p>


<p>回到刚才的位置打上断点，刷新一下往下走一步：</p>


<p>可以发现h是当前的Api加一些params。</p>
<p>接着通过d（h）点进去查看，如图所示：</p>


<p>到这里就结束了，b中的具体运算这里不做深究，整体流程分析完毕，此时将b（a）复制出来即可。</p>
<p>Js模拟示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line">j = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> a = [<span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>], b = <span class="number">0</span>; b &lt; <span class="number">500</span>; b++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="string">&quot;&quot;</span>, d = <span class="number">0</span>; d &lt; <span class="number">9</span>; d++) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">16</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">                c += a[e]</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nonce = <span class="title function_">j</span>();</span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&quot;/xdnphb/common/account/getFull?AppKey=joker&amp;nonce=&quot;</span> + nonce;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">d</span>(<span class="title function_">c</span>(<span class="title function_">e</span>(a)))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">c</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">g</span>(<span class="title function_">h</span>(<span class="title function_">f</span>(a), <span class="number">8</span> * a.<span class="property">length</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">d</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> b, c = p ? <span class="string">&quot;0123456789ABCDEF&quot;</span> : <span class="string">&quot;0123456789abcdef&quot;</span>, d = <span class="string">&quot;&quot;</span>, e = <span class="number">0</span>; e &lt; a.<span class="property">length</span>; e++)</span><br><span class="line">                b = a.<span class="title function_">charCodeAt</span>(e),</span><br><span class="line">                d += c.<span class="title function_">charAt</span>(b &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">15</span>) + c.<span class="title function_">charAt</span>(<span class="number">15</span> &amp; b);</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> b, c, d = <span class="string">&quot;&quot;</span>, e = -<span class="number">1</span>; ++e &lt; a.<span class="property">length</span>; )</span><br><span class="line">                b = a.<span class="title function_">charCodeAt</span>(e),</span><br><span class="line">                c = e + <span class="number">1</span> &lt; a.<span class="property">length</span> ? a.<span class="title function_">charCodeAt</span>(e + <span class="number">1</span>) : <span class="number">0</span>,</span><br><span class="line">                <span class="number">55296</span> &lt;= b &amp;&amp; b &lt;= <span class="number">56319</span> &amp;&amp; <span class="number">56320</span> &lt;= c &amp;&amp; c &lt;= <span class="number">57343</span> &amp;&amp; (b = <span class="number">65536</span> + ((<span class="number">1023</span> &amp; b) &lt;&lt; <span class="number">10</span>) + (<span class="number">1023</span> &amp; c),</span><br><span class="line">                e++),</span><br><span class="line">                b &lt;= <span class="number">127</span> ? d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(b) : b &lt;= <span class="number">2047</span> ? d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">192</span> | b &gt;&gt;&gt; <span class="number">6</span> &amp; <span class="number">31</span>, <span class="number">128</span> | <span class="number">63</span> &amp; b) : b &lt;= <span class="number">65535</span> ? d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">224</span> | b &gt;&gt;&gt; <span class="number">12</span> &amp; <span class="number">15</span>, <span class="number">128</span> | b &gt;&gt;&gt; <span class="number">6</span> &amp; <span class="number">63</span>, <span class="number">128</span> | <span class="number">63</span> &amp; b) : b &lt;= <span class="number">2097151</span> &amp;&amp; (d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">240</span> | b &gt;&gt;&gt; <span class="number">18</span> &amp; <span class="number">7</span>, <span class="number">128</span> | b &gt;&gt;&gt; <span class="number">12</span> &amp; <span class="number">63</span>, <span class="number">128</span> | b &gt;&gt;&gt; <span class="number">6</span> &amp; <span class="number">63</span>, <span class="number">128</span> | <span class="number">63</span> &amp; b));</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> b = <span class="title class_">Array</span>(a.<span class="property">length</span> &gt;&gt; <span class="number">2</span>), c = <span class="number">0</span>; c &lt; b.<span class="property">length</span>; c++)</span><br><span class="line">                b[c] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; <span class="number">8</span> * a.<span class="property">length</span>; c += <span class="number">8</span>)</span><br><span class="line">                b[c &gt;&gt; <span class="number">5</span>] |= (<span class="number">255</span> &amp; a.<span class="title function_">charCodeAt</span>(c / <span class="number">8</span>)) &lt;&lt; c % <span class="number">32</span>;</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> b = <span class="string">&quot;&quot;</span>, c = <span class="number">0</span>; c &lt; <span class="number">32</span> * a.<span class="property">length</span>; c += <span class="number">8</span>)</span><br><span class="line">                b += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(a[c &gt;&gt; <span class="number">5</span>] &gt;&gt;&gt; c % <span class="number">32</span> &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">h</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">            a[b &gt;&gt; <span class="number">5</span>] |= <span class="number">128</span> &lt;&lt; b % <span class="number">32</span>,</span><br><span class="line">            a[<span class="number">14</span> + (b + <span class="number">64</span> &gt;&gt;&gt; <span class="number">9</span> &lt;&lt; <span class="number">4</span>)] = b;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">1732584193</span>, d = -<span class="number">271733879</span>, e = -<span class="number">1732584194</span>, f = <span class="number">271733878</span>, g = <span class="number">0</span>; g &lt; a.<span class="property">length</span>; g += <span class="number">16</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> h = c</span><br><span class="line">                  , i = d</span><br><span class="line">                  , o = e</span><br><span class="line">                  , p = f;</span><br><span class="line">                c = <span class="title function_">j</span>(c, d, e, f, a[g + <span class="number">0</span>], <span class="number">7</span>, -<span class="number">680876936</span>),</span><br><span class="line">                f = <span class="title function_">j</span>(f, c, d, e, a[g + <span class="number">1</span>], <span class="number">12</span>, -<span class="number">389564586</span>),</span><br><span class="line">                e = <span class="title function_">j</span>(e, f, c, d, a[g + <span class="number">2</span>], <span class="number">17</span>, <span class="number">606105819</span>),</span><br><span class="line">                d = <span class="title function_">j</span>(d, e, f, c, a[g + <span class="number">3</span>], <span class="number">22</span>, -<span class="number">1044525330</span>),</span><br><span class="line">                c = <span class="title function_">j</span>(c, d, e, f, a[g + <span class="number">4</span>], <span class="number">7</span>, -<span class="number">176418897</span>),</span><br><span class="line">                f = <span class="title function_">j</span>(f, c, d, e, a[g + <span class="number">5</span>], <span class="number">12</span>, <span class="number">1200080426</span>),</span><br><span class="line">                e = <span class="title function_">j</span>(e, f, c, d, a[g + <span class="number">6</span>], <span class="number">17</span>, -<span class="number">1473231341</span>),</span><br><span class="line">                d = <span class="title function_">j</span>(d, e, f, c, a[g + <span class="number">7</span>], <span class="number">22</span>, -<span class="number">45705983</span>),</span><br><span class="line">                c = <span class="title function_">j</span>(c, d, e, f, a[g + <span class="number">8</span>], <span class="number">7</span>, <span class="number">1770035416</span>),</span><br><span class="line">                f = <span class="title function_">j</span>(f, c, d, e, a[g + <span class="number">9</span>], <span class="number">12</span>, -<span class="number">1958414417</span>),</span><br><span class="line">                e = <span class="title function_">j</span>(e, f, c, d, a[g + <span class="number">10</span>], <span class="number">17</span>, -<span class="number">42063</span>),</span><br><span class="line">                d = <span class="title function_">j</span>(d, e, f, c, a[g + <span class="number">11</span>], <span class="number">22</span>, -<span class="number">1990404162</span>),</span><br><span class="line">                c = <span class="title function_">j</span>(c, d, e, f, a[g + <span class="number">12</span>], <span class="number">7</span>, <span class="number">1804603682</span>),</span><br><span class="line">                f = <span class="title function_">j</span>(f, c, d, e, a[g + <span class="number">13</span>], <span class="number">12</span>, -<span class="number">40341101</span>),</span><br><span class="line">                e = <span class="title function_">j</span>(e, f, c, d, a[g + <span class="number">14</span>], <span class="number">17</span>, -<span class="number">1502002290</span>),</span><br><span class="line">                d = <span class="title function_">j</span>(d, e, f, c, a[g + <span class="number">15</span>], <span class="number">22</span>, <span class="number">1236535329</span>),</span><br><span class="line">                c = <span class="title function_">k</span>(c, d, e, f, a[g + <span class="number">1</span>], <span class="number">5</span>, -<span class="number">165796510</span>),</span><br><span class="line">                f = <span class="title function_">k</span>(f, c, d, e, a[g + <span class="number">6</span>], <span class="number">9</span>, -<span class="number">1069501632</span>),</span><br><span class="line">                e = <span class="title function_">k</span>(e, f, c, d, a[g + <span class="number">11</span>], <span class="number">14</span>, <span class="number">643717713</span>),</span><br><span class="line">                d = <span class="title function_">k</span>(d, e, f, c, a[g + <span class="number">0</span>], <span class="number">20</span>, -<span class="number">373897302</span>),</span><br><span class="line">                c = <span class="title function_">k</span>(c, d, e, f, a[g + <span class="number">5</span>], <span class="number">5</span>, -<span class="number">701558691</span>),</span><br><span class="line">                f = <span class="title function_">k</span>(f, c, d, e, a[g + <span class="number">10</span>], <span class="number">9</span>, <span class="number">38016083</span>),</span><br><span class="line">                e = <span class="title function_">k</span>(e, f, c, d, a[g + <span class="number">15</span>], <span class="number">14</span>, -<span class="number">660478335</span>),</span><br><span class="line">                d = <span class="title function_">k</span>(d, e, f, c, a[g + <span class="number">4</span>], <span class="number">20</span>, -<span class="number">405537848</span>),</span><br><span class="line">                c = <span class="title function_">k</span>(c, d, e, f, a[g + <span class="number">9</span>], <span class="number">5</span>, <span class="number">568446438</span>),</span><br><span class="line">                f = <span class="title function_">k</span>(f, c, d, e, a[g + <span class="number">14</span>], <span class="number">9</span>, -<span class="number">1019803690</span>),</span><br><span class="line">                e = <span class="title function_">k</span>(e, f, c, d, a[g + <span class="number">3</span>], <span class="number">14</span>, -<span class="number">187363961</span>),</span><br><span class="line">                d = <span class="title function_">k</span>(d, e, f, c, a[g + <span class="number">8</span>], <span class="number">20</span>, <span class="number">1163531501</span>),</span><br><span class="line">                c = <span class="title function_">k</span>(c, d, e, f, a[g + <span class="number">13</span>], <span class="number">5</span>, -<span class="number">1444681467</span>),</span><br><span class="line">                f = <span class="title function_">k</span>(f, c, d, e, a[g + <span class="number">2</span>], <span class="number">9</span>, -<span class="number">51403784</span>),</span><br><span class="line">                e = <span class="title function_">k</span>(e, f, c, d, a[g + <span class="number">7</span>], <span class="number">14</span>, <span class="number">1735328473</span>),</span><br><span class="line">                d = <span class="title function_">k</span>(d, e, f, c, a[g + <span class="number">12</span>], <span class="number">20</span>, -<span class="number">1926607734</span>),</span><br><span class="line">                c = <span class="title function_">l</span>(c, d, e, f, a[g + <span class="number">5</span>], <span class="number">4</span>, -<span class="number">378558</span>),</span><br><span class="line">                f = <span class="title function_">l</span>(f, c, d, e, a[g + <span class="number">8</span>], <span class="number">11</span>, -<span class="number">2022574463</span>),</span><br><span class="line">                e = <span class="title function_">l</span>(e, f, c, d, a[g + <span class="number">11</span>], <span class="number">16</span>, <span class="number">1839030562</span>),</span><br><span class="line">                d = <span class="title function_">l</span>(d, e, f, c, a[g + <span class="number">14</span>], <span class="number">23</span>, -<span class="number">35309556</span>),</span><br><span class="line">                c = <span class="title function_">l</span>(c, d, e, f, a[g + <span class="number">1</span>], <span class="number">4</span>, -<span class="number">1530992060</span>),</span><br><span class="line">                f = <span class="title function_">l</span>(f, c, d, e, a[g + <span class="number">4</span>], <span class="number">11</span>, <span class="number">1272893353</span>),</span><br><span class="line">                e = <span class="title function_">l</span>(e, f, c, d, a[g + <span class="number">7</span>], <span class="number">16</span>, -<span class="number">155497632</span>),</span><br><span class="line">                d = <span class="title function_">l</span>(d, e, f, c, a[g + <span class="number">10</span>], <span class="number">23</span>, -<span class="number">1094730640</span>),</span><br><span class="line">                c = <span class="title function_">l</span>(c, d, e, f, a[g + <span class="number">13</span>], <span class="number">4</span>, <span class="number">681279174</span>),</span><br><span class="line">                f = <span class="title function_">l</span>(f, c, d, e, a[g + <span class="number">0</span>], <span class="number">11</span>, -<span class="number">358537222</span>),</span><br><span class="line">                e = <span class="title function_">l</span>(e, f, c, d, a[g + <span class="number">3</span>], <span class="number">16</span>, -<span class="number">722521979</span>),</span><br><span class="line">                d = <span class="title function_">l</span>(d, e, f, c, a[g + <span class="number">6</span>], <span class="number">23</span>, <span class="number">76029189</span>),</span><br><span class="line">                c = <span class="title function_">l</span>(c, d, e, f, a[g + <span class="number">9</span>], <span class="number">4</span>, -<span class="number">640364487</span>),</span><br><span class="line">                f = <span class="title function_">l</span>(f, c, d, e, a[g + <span class="number">12</span>], <span class="number">11</span>, -<span class="number">421815835</span>),</span><br><span class="line">                e = <span class="title function_">l</span>(e, f, c, d, a[g + <span class="number">15</span>], <span class="number">16</span>, <span class="number">530742520</span>),</span><br><span class="line">                d = <span class="title function_">l</span>(d, e, f, c, a[g + <span class="number">2</span>], <span class="number">23</span>, -<span class="number">995338651</span>),</span><br><span class="line">                c = <span class="title function_">m</span>(c, d, e, f, a[g + <span class="number">0</span>], <span class="number">6</span>, -<span class="number">198630844</span>),</span><br><span class="line">                f = <span class="title function_">m</span>(f, c, d, e, a[g + <span class="number">7</span>], <span class="number">10</span>, <span class="number">1126891415</span>),</span><br><span class="line">                e = <span class="title function_">m</span>(e, f, c, d, a[g + <span class="number">14</span>], <span class="number">15</span>, -<span class="number">1416354905</span>),</span><br><span class="line">                d = <span class="title function_">m</span>(d, e, f, c, a[g + <span class="number">5</span>], <span class="number">21</span>, -<span class="number">57434055</span>),</span><br><span class="line">                c = <span class="title function_">m</span>(c, d, e, f, a[g + <span class="number">12</span>], <span class="number">6</span>, <span class="number">1700485571</span>),</span><br><span class="line">                f = <span class="title function_">m</span>(f, c, d, e, a[g + <span class="number">3</span>], <span class="number">10</span>, -<span class="number">1894986606</span>),</span><br><span class="line">                e = <span class="title function_">m</span>(e, f, c, d, a[g + <span class="number">10</span>], <span class="number">15</span>, -<span class="number">1051523</span>),</span><br><span class="line">                d = <span class="title function_">m</span>(d, e, f, c, a[g + <span class="number">1</span>], <span class="number">21</span>, -<span class="number">2054922799</span>),</span><br><span class="line">                c = <span class="title function_">m</span>(c, d, e, f, a[g + <span class="number">8</span>], <span class="number">6</span>, <span class="number">1873313359</span>),</span><br><span class="line">                f = <span class="title function_">m</span>(f, c, d, e, a[g + <span class="number">15</span>], <span class="number">10</span>, -<span class="number">30611744</span>),</span><br><span class="line">                e = <span class="title function_">m</span>(e, f, c, d, a[g + <span class="number">6</span>], <span class="number">15</span>, -<span class="number">1560198380</span>),</span><br><span class="line">                d = <span class="title function_">m</span>(d, e, f, c, a[g + <span class="number">13</span>], <span class="number">21</span>, <span class="number">1309151649</span>),</span><br><span class="line">                c = <span class="title function_">m</span>(c, d, e, f, a[g + <span class="number">4</span>], <span class="number">6</span>, -<span class="number">145523070</span>),</span><br><span class="line">                f = <span class="title function_">m</span>(f, c, d, e, a[g + <span class="number">11</span>], <span class="number">10</span>, -<span class="number">1120210379</span>),</span><br><span class="line">                e = <span class="title function_">m</span>(e, f, c, d, a[g + <span class="number">2</span>], <span class="number">15</span>, <span class="number">718787259</span>),</span><br><span class="line">                d = <span class="title function_">m</span>(d, e, f, c, a[g + <span class="number">9</span>], <span class="number">21</span>, -<span class="number">343485551</span>),</span><br><span class="line">                c = <span class="title function_">n</span>(c, h),</span><br><span class="line">                d = <span class="title function_">n</span>(d, i),</span><br><span class="line">                e = <span class="title function_">n</span>(e, o),</span><br><span class="line">                f = <span class="title function_">n</span>(f, p)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Array</span>(c, d, e, f)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">i</span>(<span class="params">a, b, c, d, e, f</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">n</span>(<span class="title function_">o</span>(<span class="title function_">n</span>(<span class="title function_">n</span>(b, a), <span class="title function_">n</span>(d, f)), e), c)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">j</span>(<span class="params">a, b, c, d, e, f, g</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">i</span>(b &amp; c | ~b &amp; d, a, b, e, f, g)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">k</span>(<span class="params">a, b, c, d, e, f, g</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">i</span>(b &amp; d | c &amp; ~d, a, b, e, f, g)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">l</span>(<span class="params">a, b, c, d, e, f, g</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">i</span>(b ^ c ^ d, a, b, e, f, g)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">a, b, c, d, e, f, g</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">i</span>(c ^ (b | ~d), a, b, e, f, g)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> c = (<span class="number">65535</span> &amp; a) + (<span class="number">65535</span> &amp; b);</span><br><span class="line">            <span class="keyword">return</span> (a &gt;&gt; <span class="number">16</span>) + (b &gt;&gt; <span class="number">16</span>) + (c &gt;&gt; <span class="number">16</span>) &lt;&lt; <span class="number">16</span> | <span class="number">65535</span> &amp; c</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">o</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> a &lt;&lt; b | a &gt;&gt;&gt; <span class="number">32</span> - b</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">b</span>(a)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">b</span>(a));</span><br></pre></td></tr></table></figure>

<p>经过调试发现，每个接口对应的a(“&#x2F;xdnphd&#x2F;******”)是不同的，所以要根据不同接口进行修改。</p>
<h3 id="6-3-MD5加密逆向案例"><a href="#6-3-MD5加密逆向案例" class="headerlink" title="6.3 MD5加密逆向案例"></a>6.3 MD5加密逆向案例</h3><p>本节内容是对MD5加密的逆向案例，主要内容是对POST表单的加密分析。</p>
<p>目标网站链接：<a target="_blank" rel="noopener" href="https://fanyi.youdao.com/">https://fanyi.youdao.com/</a></p>
<p>在输入框输入”你好”会自动翻译成我们的目标内容”hello”</p>


<p>通过开发者工具查看该网站链接发送的请求头内容，发现POST表单数据：</p>


<p>参数i是我们手动输入的内容；salt，sign，lts，bv是我们需要获取的。</p>
<p>可以在一个一个js请求里面搜索sign，找到我们需要的关键字sign。进行断点：</p>


<p>可以看出来n.md5就是我们要解密的方法了，点击进入该方法查看详细内容：</p>


<p>我们找到加密参数，就可以编写python代码了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs  <span class="comment"># 安装一下PyExeJS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.js&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ctx = execjs.<span class="built_in">compile</span>(f.read())  <span class="comment"># 获取代码编译完成后的对象</span></span><br><span class="line">result = ctx.call(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;你好&#x27;</span>)  <span class="comment"># 调用函数get，传入它的参数</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>将我们找到的js代码保存在”test.js”文件中，替换变量t的值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function get(e) &#123;</span><br><span class="line">        var t = &#x27;db3e6fc05e1796cb0030cda74ecb0567&#x27;</span><br><span class="line">          , r = &quot;&quot; + (new Date).getTime()</span><br><span class="line">          , i = r + parseInt(10 * Math.random(), 10);</span><br><span class="line">        return &#123;</span><br><span class="line">            ts: r,</span><br><span class="line">            bv: t,</span><br><span class="line">            salt: i,</span><br><span class="line">            sign: md5(&quot;fanyideskweb&quot; + e + i + &quot;Ygy_4c=r#e#4EX^NUGUc5&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>在程序运行过程中，发现代码会报错显示参数未定义，例如：execjs._exceptions.ProgramError: ReferenceError: md5 is not defined，所以接下来核心方法就是「缺啥补啥」。其中md5方法我们已获取，直接补充到js文件中，然后根据代码报错的提示不断填补参数代码，直到程序正常运行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">p = function(e) &#123;</span><br><span class="line">    var t, n = &quot;&quot;, r = &quot;&quot;;</span><br><span class="line">    for (t = 0; t &lt;= 3; t++)</span><br><span class="line">        n += (r = &quot;0&quot; + (e &gt;&gt;&gt; 8 * t &amp; 255).toString(16)).substr(r.length - 2, 2);</span><br><span class="line">    return n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s = function(e, t, n) &#123;</span><br><span class="line">    return t ^ (e | ~n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">d = function(e, t, i, o, a, l, c) &#123;</span><br><span class="line">    return e = r(e, r(r(s(t, i, o), a), c)),</span><br><span class="line">    r(n(e, l), t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a = function(e, t, n) &#123;</span><br><span class="line">    return e ^ t ^ n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">u = function(e, t, i, o, s, l, c) &#123;</span><br><span class="line">    return e = r(e, r(r(a(t, i, o), s), c)),</span><br><span class="line">    r(n(e, l), t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">o = function(e, t, n) &#123;</span><br><span class="line">    return e &amp; n | t &amp; ~n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c = function(e, t, i, a, s, l, c) &#123;</span><br><span class="line">    return e = r(e, r(r(o(t, i, a), s), c)),</span><br><span class="line">    r(n(e, l), t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">n = function(e, t) &#123;</span><br><span class="line">    return e &lt;&lt; t | e &gt;&gt;&gt; 32 - t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">i = function(e, t, n) &#123;</span><br><span class="line">    return e &amp; t | ~e &amp; n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = function(e, t) &#123;</span><br><span class="line">    var n, r, i, o, a;</span><br><span class="line">    return i = 2147483648 &amp; e,</span><br><span class="line">    o = 2147483648 &amp; t,</span><br><span class="line">    n = 1073741824 &amp; e,</span><br><span class="line">    r = 1073741824 &amp; t,</span><br><span class="line">    a = (1073741823 &amp; e) + (1073741823 &amp; t),</span><br><span class="line">    n &amp; r ? 2147483648 ^ a ^ i ^ o : n | r ? 1073741824 &amp; a ? 3221225472 ^ a ^ i ^ o : 1073741824 ^ a ^ i ^ o : a ^ i ^ o</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">l = function(e, t, o, a, s, l, c) &#123;</span><br><span class="line">    return e = r(e, r(r(i(t, o, a), s), c)),</span><br><span class="line">    r(n(e, l), t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f = function(e) &#123;</span><br><span class="line">    for (var t, n = e.length, r = n + 8, i = 16 * ((r - r % 64) / 64 + 1), o = Array(i - 1), a = 0, s = 0; s &lt; n; )</span><br><span class="line">        a = s % 4 * 8,</span><br><span class="line">        o[t = (s - s % 4) / 4] = o[t] | e.charCodeAt(s) &lt;&lt; a,</span><br><span class="line">        s++;</span><br><span class="line">    return t = (s - s % 4) / 4,</span><br><span class="line">    a = s % 4 * 8,</span><br><span class="line">    o[t] = o[t] | 128 &lt;&lt; a,</span><br><span class="line">    o[i - 2] = n &lt;&lt; 3,</span><br><span class="line">    o[i - 1] = n &gt;&gt;&gt; 29,</span><br><span class="line">    o</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h = function(e) &#123;</span><br><span class="line">    e = e.replace(/\x0d\x0a/g, &quot;\n&quot;);</span><br><span class="line">    for (var t = &quot;&quot;, n = 0; n &lt; e.length; n++) &#123;</span><br><span class="line">        var r = e.charCodeAt(n);</span><br><span class="line">        if (r &lt; 128)</span><br><span class="line">            t += String.fromCharCode(r);</span><br><span class="line">        else if (r &gt; 127 &amp;&amp; r &lt; 2048)</span><br><span class="line">            t += String.fromCharCode(r &gt;&gt; 6 | 192),</span><br><span class="line">            t += String.fromCharCode(63 &amp; r | 128);</span><br><span class="line">        else if (r &gt;= 55296 &amp;&amp; r &lt;= 56319) &#123;</span><br><span class="line">            if (n + 1 &lt; e.length) &#123;</span><br><span class="line">                var i = e.charCodeAt(n + 1);</span><br><span class="line">                if (i &gt;= 56320 &amp;&amp; i &lt;= 57343) &#123;</span><br><span class="line">                    var o = 1024 * (r - 55296) + (i - 56320) + 65536;</span><br><span class="line">                    t += String.fromCharCode(240 | o &gt;&gt; 18 &amp; 7),</span><br><span class="line">                    t += String.fromCharCode(128 | o &gt;&gt; 12 &amp; 63),</span><br><span class="line">                    t += String.fromCharCode(128 | o &gt;&gt; 6 &amp; 63),</span><br><span class="line">                    t += String.fromCharCode(128 | 63 &amp; o),</span><br><span class="line">                    n++</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else</span><br><span class="line">            t += String.fromCharCode(r &gt;&gt; 12 | 224),</span><br><span class="line">            t += String.fromCharCode(r &gt;&gt; 6 &amp; 63 | 128),</span><br><span class="line">            t += String.fromCharCode(63 &amp; r | 128)</span><br><span class="line">    &#125;</span><br><span class="line">    return t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function md5(e) &#123;</span><br><span class="line">        var t, n, i, o, a, s, m, g, v, y = Array();</span><br><span class="line">        for (e = h(e),</span><br><span class="line">        y = f(e),</span><br><span class="line">        s = 1732584193,</span><br><span class="line">        m = 4023233417,</span><br><span class="line">        g = 2562383102,</span><br><span class="line">        v = 271733878,</span><br><span class="line">        t = 0; t &lt; y.length; t += 16)</span><br><span class="line">            n = s,</span><br><span class="line">            i = m,</span><br><span class="line">            o = g,</span><br><span class="line">            a = v,</span><br><span class="line">            s = l(s, m, g, v, y[t + 0], 7, 3614090360),</span><br><span class="line">            v = l(v, s, m, g, y[t + 1], 12, 3905402710),</span><br><span class="line">            g = l(g, v, s, m, y[t + 2], 17, 606105819),</span><br><span class="line">            m = l(m, g, v, s, y[t + 3], 22, 3250441966),</span><br><span class="line">            s = l(s, m, g, v, y[t + 4], 7, 4118548399),</span><br><span class="line">            v = l(v, s, m, g, y[t + 5], 12, 1200080426),</span><br><span class="line">            g = l(g, v, s, m, y[t + 6], 17, 2821735955),</span><br><span class="line">            m = l(m, g, v, s, y[t + 7], 22, 4249261313),</span><br><span class="line">            s = l(s, m, g, v, y[t + 8], 7, 1770035416),</span><br><span class="line">            v = l(v, s, m, g, y[t + 9], 12, 2336552879),</span><br><span class="line">            g = l(g, v, s, m, y[t + 10], 17, 4294925233),</span><br><span class="line">            m = l(m, g, v, s, y[t + 11], 22, 2304563134),</span><br><span class="line">            s = l(s, m, g, v, y[t + 12], 7, 1804603682),</span><br><span class="line">            v = l(v, s, m, g, y[t + 13], 12, 4254626195),</span><br><span class="line">            g = l(g, v, s, m, y[t + 14], 17, 2792965006),</span><br><span class="line">            m = l(m, g, v, s, y[t + 15], 22, 1236535329),</span><br><span class="line">            s = c(s, m, g, v, y[t + 1], 5, 4129170786),</span><br><span class="line">            v = c(v, s, m, g, y[t + 6], 9, 3225465664),</span><br><span class="line">            g = c(g, v, s, m, y[t + 11], 14, 643717713),</span><br><span class="line">            m = c(m, g, v, s, y[t + 0], 20, 3921069994),</span><br><span class="line">            s = c(s, m, g, v, y[t + 5], 5, 3593408605),</span><br><span class="line">            v = c(v, s, m, g, y[t + 10], 9, 38016083),</span><br><span class="line">            g = c(g, v, s, m, y[t + 15], 14, 3634488961),</span><br><span class="line">            m = c(m, g, v, s, y[t + 4], 20, 3889429448),</span><br><span class="line">            s = c(s, m, g, v, y[t + 9], 5, 568446438),</span><br><span class="line">            v = c(v, s, m, g, y[t + 14], 9, 3275163606),</span><br><span class="line">            g = c(g, v, s, m, y[t + 3], 14, 4107603335),</span><br><span class="line">            m = c(m, g, v, s, y[t + 8], 20, 1163531501),</span><br><span class="line">            s = c(s, m, g, v, y[t + 13], 5, 2850285829),</span><br><span class="line">            v = c(v, s, m, g, y[t + 2], 9, 4243563512),</span><br><span class="line">            g = c(g, v, s, m, y[t + 7], 14, 1735328473),</span><br><span class="line">            m = c(m, g, v, s, y[t + 12], 20, 2368359562),</span><br><span class="line">            s = u(s, m, g, v, y[t + 5], 4, 4294588738),</span><br><span class="line">            v = u(v, s, m, g, y[t + 8], 11, 2272392833),</span><br><span class="line">            g = u(g, v, s, m, y[t + 11], 16, 1839030562),</span><br><span class="line">            m = u(m, g, v, s, y[t + 14], 23, 4259657740),</span><br><span class="line">            s = u(s, m, g, v, y[t + 1], 4, 2763975236),</span><br><span class="line">            v = u(v, s, m, g, y[t + 4], 11, 1272893353),</span><br><span class="line">            g = u(g, v, s, m, y[t + 7], 16, 4139469664),</span><br><span class="line">            m = u(m, g, v, s, y[t + 10], 23, 3200236656),</span><br><span class="line">            s = u(s, m, g, v, y[t + 13], 4, 681279174),</span><br><span class="line">            v = u(v, s, m, g, y[t + 0], 11, 3936430074),</span><br><span class="line">            g = u(g, v, s, m, y[t + 3], 16, 3572445317),</span><br><span class="line">            m = u(m, g, v, s, y[t + 6], 23, 76029189),</span><br><span class="line">            s = u(s, m, g, v, y[t + 9], 4, 3654602809),</span><br><span class="line">            v = u(v, s, m, g, y[t + 12], 11, 3873151461),</span><br><span class="line">            g = u(g, v, s, m, y[t + 15], 16, 530742520),</span><br><span class="line">            m = u(m, g, v, s, y[t + 2], 23, 3299628645),</span><br><span class="line">            s = d(s, m, g, v, y[t + 0], 6, 4096336452),</span><br><span class="line">            v = d(v, s, m, g, y[t + 7], 10, 1126891415),</span><br><span class="line">            g = d(g, v, s, m, y[t + 14], 15, 2878612391),</span><br><span class="line">            m = d(m, g, v, s, y[t + 5], 21, 4237533241),</span><br><span class="line">            s = d(s, m, g, v, y[t + 12], 6, 1700485571),</span><br><span class="line">            v = d(v, s, m, g, y[t + 3], 10, 2399980690),</span><br><span class="line">            g = d(g, v, s, m, y[t + 10], 15, 4293915773),</span><br><span class="line">            m = d(m, g, v, s, y[t + 1], 21, 2240044497),</span><br><span class="line">            s = d(s, m, g, v, y[t + 8], 6, 1873313359),</span><br><span class="line">            v = d(v, s, m, g, y[t + 15], 10, 4264355552),</span><br><span class="line">            g = d(g, v, s, m, y[t + 6], 15, 2734768916),</span><br><span class="line">            m = d(m, g, v, s, y[t + 13], 21, 1309151649),</span><br><span class="line">            s = d(s, m, g, v, y[t + 4], 6, 4149444226),</span><br><span class="line">            v = d(v, s, m, g, y[t + 11], 10, 3174756917),</span><br><span class="line">            g = d(g, v, s, m, y[t + 2], 15, 718787259),</span><br><span class="line">            m = d(m, g, v, s, y[t + 9], 21, 3951481745),</span><br><span class="line">            s = r(s, n),</span><br><span class="line">            m = r(m, i),</span><br><span class="line">            g = r(g, o),</span><br><span class="line">            v = r(v, a);</span><br><span class="line">        return (p(s) + p(m) + p(g) + p(v)).toLowerCase()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">function get(e) &#123;</span><br><span class="line">    var t = &#x27;db3e6fc05e1796cb0030cda74ecb0567&#x27;</span><br><span class="line">      , r = &quot;&quot; + (new Date).getTime()</span><br><span class="line">      , i = r + parseInt(10 * Math.random(), 10);</span><br><span class="line">    return &#123;</span><br><span class="line">        ts: r,</span><br><span class="line">        bv: t,</span><br><span class="line">        salt: i,</span><br><span class="line">        sign: md5(&quot;fanyideskweb&quot; + e + i + &quot;Ygy_4c=r#e#4EX^NUGUc5&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行python代码：</p>


<h3 id="6-4-RSA参数加密逆向案例"><a href="#6-4-RSA参数加密逆向案例" class="headerlink" title="6.4 RSA参数加密逆向案例"></a>6.4 RSA参数加密逆向案例</h3><p>本节是对RSA加密的逆向案例，主要内容是对登录参数的RSA加密分析。</p>
<p>网站链接：<a target="_blank" rel="noopener" href="https://login.10086.cn/html/login/email_login.html">https://login.10086.cn/html/login/email_login.html</a></p>
<p>进入之后选择电脑版：</p>


<p>去到登陆界面：</p>


<p>登录之前我们打开控制台，然后登陆进行抓包。</p>


<p>输入用户名和密码之后点击登录，会抓到一个login的包。</p>
<p>它是一个post的请求，我们观察一下Form Data里面的数据：</p>


<p>我们发现用户和密码都进行了加密，但是不确定是哪种加密方式。</p>
<p>此时我们可以全局搜索一下password关键字，发现能搜索到很多相关的信息：</p>


<p>如果一个一个的找会很麻烦，这里告诉大家一个技巧，我们可以搜索encrypt这个关键字（它其实就是表示加密的操作）</p>


<p>这时我们就能找到加密的地方，我们在加密的位置打上断点，再重新登录，看能不能拦截到。</p>
<p>拦截之前先进入资源面板打上断点。</p>


<p>登录的时候可以被拦截，点进去看看它的方法：</p>


<p>发现有明显的RSA标志setPublicKey，接下来就用代码进行模拟。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_v1_5</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def encrypt_str(data):</span><br><span class="line">    key = &quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsgDq4OqxuEisnk2F0EJFmw4xKa5IrcqEYHvqxPs2CHEg2kolhfWA2SjNuGAHxyDDE5MLtOvzuXjBx/5YJtc9zj2xR/0moesS+Vi/xtG1tkVaTCba+TV+Y5C61iyr3FGqr+KOD4/XECu0Xky1W9ZmmaFADmZi7+6gO9wjgVpU9aLcBcw/loHOeJrCqjp7pA98hRJRY+MML8MK15mnC4ebooOva+mJlstW6t/1lghR8WNV8cocxgcHHuXBxgns2MlACQbSdJ8c6Z3RQeRZBzyjfey6JCCfbEKouVrWIUuPphBL3OANfgp0B+QG31bapvePTfXU48TYK0M5kE+8LgbbWQIDAQAB&quot;</span><br><span class="line">    rsakey = RSA.import_key(base64.b64decode(key))</span><br><span class="line">    cipher = PKCS1_v1_5.new(rsakey)</span><br><span class="line">    cipher_text = base64.b64encode(cipher.encrypt(data.encode(encoding=&quot;utf-8&quot;)))</span><br><span class="line">    return cipher_text</span><br><span class="line"></span><br><span class="line">password = encrypt_str(&quot;123&quot;)</span><br><span class="line">print(password.decode())</span><br></pre></td></tr></table></figure>

<p>Crypto是第三方库，属于对PyCrypto库的扩展，所以需要进行安装，Windows安装命令pip install pycryptodome。</p>
<h3 id="6-5-AES数据加密逆向案例"><a href="#6-5-AES数据加密逆向案例" class="headerlink" title="6.5 AES数据加密逆向案例"></a>6.5 AES数据加密逆向案例</h3><p>前面小节中的案例是对接口中的参数进行逆向还原，本节内容来看看针对行行查网站响应内容的加密逆向案例。</p>
<p>网站链接：<a target="_blank" rel="noopener" href="https://www.hanghangcha.com/">https://www.hanghangcha.com/</a></p>


<p>这里我们需要先登录，然后尝试点击产业概述：</p>


<p>通过控制台可以发现，当我们点击右边菜单栏的时候，该网站返回的response都是经过加密的，如图所示：</p>


<p>首先通过堆栈调试进行断点，在调用中看到了一个名为feachData的堆栈，（因为名字里面有Data），猜测就是我们要找的部分：</p>


<p>尝试点进去看看：</p>


<p>这时会发现有decrypt和JSON.parse，在这里进行断点。</p>
<p>尝试刷新页面触发断点，不难发现V[“a”].decrypt(e)就是解密。</p>
<p>进入该方法查看详细内容：</p>


<p>这就不难看出是AES加密了，继续断点看一下：</p>


<p>可以发现密钥是 “<code>3sd&amp;d24h@$udD2s*</code>”，mode是ECB，padding是Pkcs7。解密算法分析完成，接下来就可以编写还原代码了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64, json, re</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">info</span>):</span><br><span class="line">    key = <span class="string">&#x27;3sd&amp;d24h@$udD2s*&#x27;</span>.encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, mode=AES.MODE_ECB)</span><br><span class="line">    json_str = <span class="built_in">str</span>(cipher.decrypt(base64.b64decode(info)), encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = re.sub(<span class="string">&#x27;[\x00-\x09|\x0b-\x0c|\x0e-\x1f]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, json_str)</span><br><span class="line">    <span class="keyword">return</span> json.loads(data)</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;UM_distinctid=18354eaabe89d7-0970db4b1f0d01-26021c51-144000-18354eaabe9158a; Hm_lvt_1521e0fb49013136e79181f2888214a7=1663577010; Hm_lpvt_1521e0fb49013136e79181f2888214a7=1663577010; JSESSIONID=BE4CBF8DDEF824CAAA58E75F33E7DCCF; _ACCOUNT_=YjBiZjRkMTA3YmM1NDY3N2E4NGJkNTljMDRlNGRiNWUlNDAlNDBtb2JpbGU6MTY2NDc5NjI4NDc4NDoyM2FkNDY2ZDYxOWY2ZmFmOTg4YzQzMTYxOWMzMDljNQ&#x27;</span></span><br><span class="line">&#125;<span class="comment"># 需要把你的header复制进去</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://api.hanghangcha.com/hhc/api/member/chains/getList?filter=%7B%22keyword%22%3A%22%22%2C%22limit%22%3A20%2C%22skip%22%3A0%2C%22isOpen%22%3A1%7D&quot;</span>  <span class="comment"># 产业图谱接口</span></span><br><span class="line">res = requests.get(url, headers=headers)</span><br><span class="line">payload = json.loads(res.content)[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">data = decrypt(payload)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<p>运行代码得到解密后的结果：</p>


<h2 id="第七章-浏览器环境补充"><a href="#第七章-浏览器环境补充" class="headerlink" title="第七章 浏览器环境补充"></a>第七章 浏览器环境补充</h2><p>现在很多网站的Js都引入了浏览器的特征，就是检测浏览器环境和浏览器使用的一些方法。比如用Node直接去运行复制下来的Js代码，可能会报未定义的错误或者找不到方法，导致无法运行或者得到的结果与浏览器不一致。因为Node环境和浏览器具有一定的区别，比如window对象区别，this指向区别、Js引擎区别，以及一些DOM操作的区别，很多网站也会以此检测来判断是不是真实用户，此时就需要对Js代码进行补充。</p>
<p>又比如对浏览器一些参数的设置，网站设置了window、navigate的某一个属性，在模拟的时候没有进行这些设置，就会被检测到。</p>
<p>通常情况下简单的补充只需要补上window或者document以及定义一些变量，比如直接在开头定义一个window&#x3D;global；或者根据报错和调试结果缺啥补啥。但是不同网站的检测标准和补充难度参差不齐，先来看看哪些环境是经常被检测的。</p>
<h3 id="7-1-常被检测的环境"><a href="#7-1-常被检测的环境" class="headerlink" title="7.1 常被检测的环境"></a>7.1 常被检测的环境</h3><p>在常被检测的环境中，有window、location、navigate、document、native、canvas等。除了这些属性外，还有针对自动化的检测、Node环境的检测，以及浏览器指纹检测、TLS指纹校验等。下面列出了一些经常用来做检测的属性和方法。</p>
<p>window检测：</p>
<ul>
<li>window是否为方法</li>
<li>window对象是否freeze</li>
<li>各属性检测</li>
</ul>
<p>location检测：</p>
<ul>
<li>hostname</li>
<li>protocol</li>
<li>host</li>
<li>hash</li>
<li>origin</li>
</ul>
<p>navigator检测：</p>
<ul>
<li>AppName</li>
<li>AppVersion</li>
<li>cookieEnabled</li>
<li>language</li>
<li>userAgent</li>
<li>product</li>
<li>platform</li>
<li>plugins浏览器插件</li>
<li>javaEnabled()方法</li>
<li>taintEnabled()方法</li>
</ul>
<p>document检测：</p>
<ul>
<li>referrer</li>
<li>cookie</li>
<li>createElement()方法</li>
</ul>
<p>canvas指纹：</p>
<ul>
<li>不同类型图片的canvas指纹应当不一样，如 .jpg .png</li>
<li>不同质量quality的canvas指纹应该不一样</li>
<li>不同属性的canvas指纹应该不一样</li>
<li>同一个条件的canvas多次绘制时应该保持一致</li>
</ul>
<p>浏览器指纹信息：</p>
<ul>
<li>window.screen屏幕分辨率&#x2F;宽高</li>
<li>navigator.useragent</li>
<li>location.href&#x2F;host</li>
<li>navigator.platform平台、语言等信息</li>
<li>cancas2D图像指纹</li>
<li>navigator.plugin浏览器插件信息</li>
<li>webgl3D图像指纹</li>
<li>浏览器字体信息</li>
<li>本地存储的cookie信息</li>
</ul>
<p>除了上面列出的之外，还有对自动化痕迹的检测，比如chromedriver属性检测。还有异常堆栈检测，通过检测堆栈来判断所处的执行环境。native方法检测，检测某个方法是否被重写。这里不再多说了，在接下来的小节中来了解一下补充环境时的几种方案。</p>
<p>补充：浏览器指纹很重要，在数据采集、搜索引擎、埋点分析、网站测试等方面都有体现。指纹通常是指服务端的为了做识别而收集的客户端设备信息。即使没有cookie，指纹也可用于识别个人用户或设备。比如常用于记录的指纹 Header、Cookie、IP、DNS、UserAgent，Font（字体列表），Language，localStorage、Plugin（插件），Canvas（渲染绘图），WebGL（3D渲染图形），Web Vendor，Timezone（时区），WebRTC，ScreenResolution（分辨率），Platform（系统），Audio（音频设置和硬件特征指纹），以及enumerateDevices（其他媒体设备）、CPU、GPU信息等等。</p>
<h3 id="7-2-手动补充环境"><a href="#7-2-手动补充环境" class="headerlink" title="7.2 手动补充环境"></a>7.2 手动补充环境</h3><p>一般在手动补充时，根据报错信息缺什么补什么。比如’window’ is not defined，就补上window&#x3D;global；或者widow&#x3D;{}。</p>
<p>如果报错没有plugins，可以在navigator中写上plugins。同时用Symbol.toStringTag标识一下该对象的类型标签，因为目前有很多toString检测，而toStringTag也能被toString()方法识别并返回。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var navigator = &#123;</span><br><span class="line">    plugins:&#123;</span><br><span class="line">        0:&#123;</span><br><span class="line">            0:&#123;description:&quot;&quot;, type:&quot;&quot;&#125;,</span><br><span class="line">            name:&quot;&quot;,</span><br><span class="line">            length:1,</span><br><span class="line">            filename:&quot;&quot;,</span><br><span class="line">            description:&quot;&quot;,</span><br><span class="line">            length:1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">navigator.plugins[Symbol.toStringTag] = &quot;PluginArry&quot;;</span><br><span class="line">navigator.plugins[0][Symbol.toStringTag] = &quot;Plugin&quot;;</span><br></pre></td></tr></table></figure>

<p>如果报错没有getElementByTagName，就到document中去定义一个，但是参数和方法中具体实现，以及返回内容都需要根据调试结果来进行补充。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">document = &#123;</span><br><span class="line">    getElementsByTagName:function(x)&#123;</span><br><span class="line">        return&#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    createElement:function(x)&#123;</span><br><span class="line">        return&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果报错没有canvas，那么可以用createElement去创建一个简单的元素节点，通过此方法可返回一个canvas对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var document = &#123;</span><br><span class="line">    createElement:function createElement(x)&#123;</span><br><span class="line">        if (x==&quot;canvas&quot;)&#123;</span><br><span class="line">            return&#123;</span><br><span class="line">                toDataURL:function toDataURL()&#123;</span><br><span class="line">                    return &quot;data:image/png&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-JSDOM环境补充"><a href="#7-3-JSDOM环境补充" class="headerlink" title="7.3 JSDOM环境补充"></a>7.3 JSDOM环境补充</h3><p>js中的DOM指的是“Document Object Model”，也就是文档对象模型的意思，是HTML和XML文档的编程接口；它提供了对文档的结构化的表述，并定义了一种方式可以使从程序中对该结构进行访问，从而改变文档的结构，样式和内容。</p>
<p>JSDOM对浏览器环境的还原非常到位，它可以被当作无头浏览器使用。一般来说，在node环境下需要补充最多的就是document和window对象。通过下面的代码来看JSDOM是如何模拟成浏览器的。</p>
<p>通过HTML文本来创建一个JSDOM的实例，然后就可以通过实例取得window对象和document对象。JSDOM生成的window对象下还实现了history、location、postMessage、setTimeout、setInterval等熟悉的Api。</p>
<p>JSDOM安装：npm install jsdom  查看jsdom的位置：npm root -g。</p>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const &#123; JSDOM &#125; = require (&#x27;jsdom&#x27;);</span><br><span class="line"></span><br><span class="line">const NewjsDom = new JSDOM(</span><br><span class="line">    `&lt;!DOCTYPE html&gt;</span><br><span class="line">     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">            &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">            &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;P&gt;web js逆向&lt;/P&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;`</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const window = NewjsDom.window; //window对象</span><br><span class="line">const document = window.document; //document对象</span><br><span class="line"></span><br><span class="line">console.log(&#x27;123&#x27;);</span><br></pre></td></tr></table></figure>

<p>另外要提的一点是Python中的execjs库也可以切换成jsdom来执行含有document、window等对象的Js代码。</p>
<p>代码示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">signature = execjs.compile(js, cwd=jsdom_path).call(&quot;sign&quot;)</span><br></pre></td></tr></table></figure>

<p>JSDOM能满足大部分测试场景下对浏览器环境的还原，但在一些场景下也会被检测出来。某些时候并不知道网站检测了什么属性，也不知道修补环境时，可以使用真实的浏览器驱动来加载Js代码。比如像抖音web版、头条新闻页面，这两个站点的Js代码都具备深度检测浏览器身份的功能。</p>
<h3 id="7-4-Selenium环境模拟"><a href="#7-4-Selenium环境模拟" class="headerlink" title="7.4 Selenium环境模拟"></a>7.4 Selenium环境模拟</h3><p>我们喜欢用的方法是使用selenium来驱动浏览器，先把Js和参数都写到本地的html文件，然后用selenium打开html文件加载Js，生成加密参数。当然也可以使用其他的Web自动化测试工具，比如Pyppeteer、htmlunit等。</p>
<p>具体方法如下：</p>
<p>HTML文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>web js逆向<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我们在学习js逆向<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//此处省略n行</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>python文件：</p>
<p>使用selenium需要安装selenium库。</p>
<p>还得安装浏览器驱动，这里提供chrome的驱动：</p>
<p>下载地址：<a target="_blank" rel="noopener" href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a></p>
<p>注意需下载和自己本地谷歌浏览器版本一致的驱动。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from selenium import webdriver</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">PRO_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">def driver_sig(html_file):</span><br><span class="line">    driver = webdriver.Chrome()</span><br><span class="line">    # 请求当前目录下的&#x27;get_sign.html&#x27;文件</span><br><span class="line">    driver.get(&quot;file://&quot; + PRO_DIR + &quot;/&quot; + html_file)</span><br><span class="line">    time.sleep(5)</span><br><span class="line">    sig = driver.title</span><br><span class="line">    driver.quit()</span><br><span class="line">    return sig</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    html_file = &#x27;get_sign.html&#x27;</span><br><span class="line">    sig = driver_sig(html_file)</span><br><span class="line">    print(sig)</span><br></pre></td></tr></table></figure>

<h3 id="7-5-puppeteer环境模拟"><a href="#7-5-puppeteer环境模拟" class="headerlink" title="7.5 puppeteer环境模拟"></a>7.5 puppeteer环境模拟</h3><p>puppeteer是一个Node.js的库，支持调用Chrome的Api来操纵Web，相比较Selenium或是PhantomJs，它最大的特点就是操作DOM可以完全在内存中进行模拟（可用代码驱动浏览器操作），既在v8引擎中处理，又不打开浏览器，而且这个是Chrome团队在维护，会拥有更好的兼容性和发展前景。</p>
<p>Puppeteer 是一个Chrome官方团队提供的node库，它可以通过 Puppeteer 的提供的 API 直接控制 Chrome 或 Chromium。</p>
<p>Puppeteer可以做什么？</p>
<p>1） 生成网页截图或者 PDF<br>2） 爬取SPA应用，并生成预渲染内容（即“SSR” 服务端渲染）<br>3） 高级爬虫，可以爬取大量异步渲染内容的网页<br>4） 模拟键盘输入、表单自动提交、登录网页等<br>5） 创建一个最新的自动化测试环境，实现 UI 自动化测试<br>6） 捕获站点的时间线，以便追踪网站、帮助分析网站性能问题<br>7） 用于测试 Chrome 扩展程序</p>
<p>Puppeteer安装：</p>


<p>下面是简单的调用代码：</p>
<ul>
<li>puppeteer.launch 启动浏览器实例</li>
<li>browser.newPage() 创建一个新页面</li>
<li>page.goto 进入指定网页</li>
<li>page.screenshot 截图</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">const puppeteer = require(&#x27;puppeteer&#x27;);</span><br><span class="line"> </span><br><span class="line">(async () =&gt; &#123;</span><br><span class="line">  //打开浏览器</span><br><span class="line">  const browser = await puppeteer.launch(&#123; </span><br><span class="line">      headless: false //是否在 无头模式 下运行浏览器 false显示浏览器，true不显示</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">  //打开新页面</span><br><span class="line">  const page = await browser.newPage();</span><br><span class="line"> </span><br><span class="line">  //设置页面大小</span><br><span class="line">  page.setViewport(&#123;</span><br><span class="line">        width:1024,</span><br><span class="line">        height:800</span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">  //打开百度</span><br><span class="line">  await page.goto(&#x27;https://www.baidu.com&#x27;);</span><br><span class="line"> </span><br><span class="line">  //截图</span><br><span class="line">  await page.screenshot(&#123;path: &#x27;example.png&#x27;&#125;);</span><br><span class="line"> </span><br><span class="line">  //关闭浏览器</span><br><span class="line">  await browser.close();</span><br><span class="line"> </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>puppeteer的中文文档：<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/puppeteer/">https://www.w3cschool.cn/puppeteer/</a></p>
<p>示例：哔哩哔哩音乐爬取</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">&#x27;puppeteer&#x27;</span>);</span><br><span class="line"></span><br><span class="line">(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> args = [</span><br><span class="line">        <span class="string">&#x27;--no-sandbox&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-setuid-sandbox&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-infobars&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--window-position=0,0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--ignore-certifcate-errors&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--ignore-certifcate-errors-spki-list&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--user-agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3312.0 Safari/537.36&quot;&#x27;</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">        args,</span><br><span class="line">        <span class="attr">headless</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">ignoreHTTPSErrors</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">userDataDir</span>: <span class="string">&#x27;./tmp2&#x27;</span>,</span><br><span class="line">        <span class="attr">defaultViewport</span>:&#123;<span class="attr">width</span>:<span class="number">1280</span>,<span class="attr">height</span>:<span class="number">800</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(options);</span><br><span class="line">  <span class="keyword">const</span> browserWSEndpoint = browser.<span class="title function_">wsEndpoint</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(browserWSEndpoint,<span class="string">&#x27;site&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">goto</span>(<span class="string">&#x27;https://www.bilibili.com/v/music/original/?spm_id_from=333.5.b_6d757369635f6f726967696e616c.59#/all/click/0/1/?open=hot&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">waitForSelector</span>(<span class="string">&#x27;#videolist_box &gt; div.vd-list-cnt &gt; ul &gt; li &gt; div &gt; div.r &gt; a&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> title = <span class="keyword">await</span> page.$$eval(<span class="string">&#x27;#videolist_box &gt; div.vd-list-cnt &gt; ul &gt; li &gt; div &gt; div.r &gt; a&#x27;</span>,</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="params">link</span>=&gt;</span>link.<span class="title function_">map</span>(<span class="function"><span class="params">v</span>=&gt;</span>&#123; <span class="keyword">return</span> &#123; <span class="attr">title</span>:v.<span class="property">innerText</span>, <span class="attr">href</span>:v.<span class="property">href</span>&#125; &#125;)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(title)</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>参数详解：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43382853/article/details/103688551">https://blog.csdn.net/qq_43382853/article/details/103688551</a></p>
<p>手动补充环境相对耗时耗力，如果采集频率要求不高时，直接在浏览器中模拟环境调用即可，在接下来的小节中来学习一下对浏览器环境的检测。</p>
<h2 id="第八章-加密方法远程调用"><a href="#第八章-加密方法远程调用" class="headerlink" title="第八章 加密方法远程调用"></a>第八章 加密方法远程调用</h2><p>加密方法的远程调用主要是使用了RPC协议，RPC（Remote Procedure Call）是远程调用的意思。RPC的应用十分广泛，比如在分布式中的进程间通信、微服务中的节点通信。</p>
<p>我们这里使用的rpc其实是实现两个不同进程通信的一种方式，比如在浏览器执行一些方法，将结果返回给本地使用。</p>
<p>在Js逆向时，本地可以和浏览器以服务端和客户端的形式通过webSocket协议进行RPC通信，这样可以直接调用浏览器中的一些函数方法，不必去在意函数具体的执行逻辑，可以省去大量的逆向调试时间。</p>
<p>在RPC中，发出请求的程序是客户端，而提供服务的程序是服务端，所以大家的浏览器是客户端，本地是服务端。</p>
<h3 id="8-1-微博登录参数RPC"><a href="#8-1-微博登录参数RPC" class="headerlink" title="8.1 微博登录参数RPC"></a>8.1 微博登录参数RPC</h3><p>本节内容以新浪微博网页版为例，来讲解一下如何在Web上使用RPC协议完成加密参数的获取。</p>
<p>网站链接：<a target="_blank" rel="noopener" href="https://weibo.com/">https://weibo.com</a></p>


<p>首先输出账号：（随机）密码：（随机）进行登录，通过控制台进行抓包，可以发现POST的登录接口：</p>


<p>在Form Data中有很多经过加密的参数su、rsakv、sp如图所示：</p>


<p>此时如果按照正常的逆向流程，需要对每个加密参数进行分析和逆向，比较浪费时间和精力。</p>
<p>先通过搜索定位一个加密参数的位置，比如全局搜索关键词rsakv，只有一个Js文件中有该关键词，点击进去并格式化代码，继续搜索准确位置，如图所示：</p>


<p>如果有很多搜索结果，而且不确定具体位置，就在所有关键字前打上断点进行分析。</p>
<p>刷新，再重新登录：</p>


<p>经过简单分析我们发现，a是账号，b是密码，e.sp是对b进行加密后的结果</p>


<p>我们尝试在console调用该方法：</p>


<p>调用成功后，接下来可以对Js文件进行修改，添加一个WebSocket客户端，供大家进行RPC调用。</p>
<p>首先需要修改Js文件，鉴于方便操作和讲解，我们选择通过控制台的Overriders来进行Js文件替换。当然也可以选择通过Fiddler、Mitmproxy等抓包工具替换，或者通过谷歌的GRPC协议来进行Js内容替换。</p>
<p>在source中选择Overrides，然后创建一个本地目录，需要勾选Enable Local Overrrides：</p>


<p>然后在没有格式化的Js文件上单击鼠标右键，选择【Save for overrides】命令：</p>




<p>接下来就可以进行修改了，将格式化后的代码复制到save的文件中，然后按Ctrl+s快捷键进行保存（注意微博的inDex.js文件，它每隔一个小时会进行重命名，所以需要重新进行覆盖）</p>


<p>接着要做的就是选择一个位置来插入一个webSocket连接供大家进行RPC调用。</p>
<p>首先要确定代码注入位置，可以写到makeRequest &#x3D; function(a, b, c, d){}中，然后手动激活该函数。</p>
<p>不能单纯地在该函数中写入创建客户端，这样会导致死循环，无限创建客户端。所以需要进行代码上的判断，如果已经创建过，就不再创建客户端。</p>
<p>注入的Js代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">!function()&#123;</span><br><span class="line">     if (window.flagMsb)&#123;&#125;</span><br><span class="line">     else&#123;</span><br><span class="line">    window.weiboMsb = makeRequest;</span><br><span class="line">    var ws = new WebSocket(&quot;ws://127.0.0.1:9999&quot;);</span><br><span class="line">    window.flagMsb =true;</span><br><span class="line">    ws.open = function(evt)&#123;&#125;;</span><br><span class="line">    ws.onmessage = function(evt)&#123;</span><br><span class="line">        var Msb = evt.data;</span><br><span class="line">        var result = Msb.split(&quot;,&quot;);</span><br><span class="line">        var res = window.weiboMsb(result[0],result[1],7,false);</span><br><span class="line">        ws.send(JSON.stringify(res));</span><br><span class="line">    &#125;&#125;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>

<p>接下来用python创建一个webSocket服务端。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import asyncio</span><br><span class="line">import websockets</span><br><span class="line"></span><br><span class="line">async def check_permit(websocket):</span><br><span class="line">    # 账号列表</span><br><span class="line">    for send_text in [</span><br><span class="line">        &#x27;11111111111,111&#x27;,</span><br><span class="line">        &#x27;11111111112,112&#x27;,</span><br><span class="line">        &#x27;11111111113,113&#x27;,</span><br><span class="line">        &#x27;11111111114,114&#x27;</span><br><span class="line">    ]:</span><br><span class="line">        await websocket.send(send_text)</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">async def recv_msg(websocket):</span><br><span class="line">    while 1:</span><br><span class="line">        recv_text = await websocket.recv()</span><br><span class="line">        print(recv_text)</span><br><span class="line"></span><br><span class="line">async def main_logic(websocket, path):</span><br><span class="line">    await check_permit(websocket)</span><br><span class="line">    await recv_msg(websocket)</span><br><span class="line"></span><br><span class="line">start_server = websockets.serve(main_logic, &#x27;127.0.0.1&#x27;, 9999)</span><br><span class="line">asyncio.get_event_loop().run_until_complete(start_server)</span><br><span class="line">asyncio.get_event_loop().run_forever()</span><br></pre></td></tr></table></figure>

<p>运行python代码开启本地服务，然后刷新页面，填入账号密码单击“登录”按钮，触发Js代码。可以在请求中看到来自127.0.0.1:9999的ws数据包：</p>


<p>在大家的控制台也有了对应的输出：</p>


<p>此时一个RPC调用案例已经结束，学会了RPC可以在某些时候快速解决问题，毕竟不需要追代码逻辑和补浏览器环境。案例中实现的方法需要手动替换Js文件，可以通过谷歌的开发者工具远程调试协议来实现Js文件的注入。更多的应用需要大家动手实践。</p>
<h2 id="第九章-AST技术简介"><a href="#第九章-AST技术简介" class="headerlink" title="第九章 AST技术简介"></a>第九章 AST技术简介</h2><p>前面我们介绍了一些javascript混淆的基本知识，可以看到混淆方式多种多样，比如字符串混淆、变量名混淆、对象键名替换、控制流平坦化等，当然，我们也学习了一些相关的调试技巧，比如Hook、断点调试等。但是这些方法本质上其实还是在已经混淆的代码上进行的操作，所以代码的可读性依然比较差。</p>
<p>有没有什么办法可以直接提高代码的可读性呢？比如说，字符串混淆了，我们想办法把它还原了；对象键名替换了，我们想办法把它们重新组装好了，控制流平坦化之后逻辑不直观了，我们想办法把它还原成一个代码控制流。</p>
<p>到底应该怎么做呢？这就需要用到AST相关的知识了。本节中，我们就来了解AST相关的基础知识，并介绍操作AST的相关方法。</p>
<h3 id="9-1-AST介绍"><a href="#9-1-AST介绍" class="headerlink" title="9.1 AST介绍"></a>9.1 AST介绍</h3><p>首先，我们来了解什么是AST。AST的全称叫作Abstract Syntax Tree，中文翻译叫作抽象语法树。</p>
<p>如果你对编译原理有所了解的话，一段代码在执行之前，通常要经历这么三个步骤。</p>
<ul>
<li>词法分析：一段代码首先会被分解成一段段有意义的词法单元，比如const name &#x3D; “msb”这段代码，它可以被拆分成四部分：const、name、&#x3D;、“msb”，每个部分都具备一定的含义。</li>
<li>语法分析：接着编译器会尝试对一个个词法单元进行语法分析，将其转换为能代表程序语法结构的数据结构。比如，const 就被分析为 VariableDeclaration 类型，代表变量声明的具体定义；name就被分析为Identifier类型，代表一个标识符。代码内容多了，这一个个词法就会有依赖、嵌套等关系，因此表示语法结构的数据结构就构成了一个树状的结构，也就成了语法树，即AST。</li>
<li>指令生成：最后将AST转换为实际真正可执行的指令并执行即可。</li>
</ul>
<p>AST是源代码的抽象语法结构的树状表示，树上的每个节点都表示源代码的一种结构，这种数据结构其实可以类比成一个大的JSON对象。</p>
<p>在前端开发中，AST技术应用十分广泛，有了AST，我们可以方便地对JavaScript代码进行转换和改写，因此还原混淆后的Javascript代码也就不在话下了。</p>
<p>接下来，我们通过一些实例了解AST的一些基本理念和操作。</p>
<h3 id="9-2-实例引入"><a href="#9-2-实例引入" class="headerlink" title="9.2 实例引入"></a>9.2 实例引入</h3><p>首先，推荐一个AST在线解析的网站 <a target="_blank" rel="noopener" href="http://astexplorer.net/%EF%BC%8C%E6%88%91%E4%BB%AC%E5%85%88%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%B8%B8%E7%AE%80%E5%8D%95%E7%9A%84%E5%AE%9E%E4%BE%8B%E6%9D%A5%E6%84%9F%E5%8F%97%E4%B8%80%E4%B8%8BAST%E7%A9%B6%E7%AB%9F%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E5%AD%90%E7%9A%84%EF%BC%8C%E8%BE%93%E5%85%A5%E4%B8%8A%E8%BF%B0%E7%9A%84%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A">http://astexplorer.net/，我们先通过一个非常简单的实例来感受一下AST究竟是什么样子的，输入上述的示例代码：</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const name = &quot;msb&quot;</span><br></pre></td></tr></table></figure>

<p>这时候我们就可以看到在右侧就出现了一个树状结构，这就是AST，如图所示：</p>


<p>这就是一个层层嵌套的数据结构，可以看到他把代码的每一个部分都进行了拆分并分析出对应的类型、位置和值。比如说，name被解析成一个type为Identifier的数据结构，start和end分别代表代码的起始和终止位置，name属性代表该Identifier的名称。另外，msb这个字符串被解析成了StringLiteral类型的数据结构，它同样有start、end等属性，同时还有extra属性。我们所看到的这些数据结构就构成了一个层层嵌套的AST。</p>
<p>另外，在右上角，我们还看到一个Parser标识。这是一个目前最流行的JavaScript语法编译器Babel的Node.js包，同时它也是主流前端开发技术中必不可少的一个包。它内置了很多分析JavaScript代码的方法，可以实现JavaScript代码到AST的转换。</p>
<p>接下来，我们使用Babel来实现一下AST的解析、修改。</p>
<h3 id="9-3-准备工作"><a href="#9-3-准备工作" class="headerlink" title="9.3 准备工作"></a>9.3 准备工作</h3><p>由于本节内容需要用到babel，而Babel是基于Node.js的，所以这里需要先安装Node.js。</p>
<p>安装好Node.js之后，我们便可以使用npm命令了，接着，我们还需要安装一个Babel的命令行工具@babel&#x2F;node，安装命令如下：</p>
<p>npm install -g @babel&#x2F;node</p>
<p>接下来，我们再初始化一个Node.js项目learn-ast，然后在learn-ast目录下运行初始化命令，具体如下：</p>
<p>npm install -D @babel&#x2F;core @babel&#x2F;cli @babel&#x2F;preset-env</p>


<p>运行完毕之后，就会生成一个package.json文件并在devDependencies中列出了刚刚安装的几个Node.js包。</p>
<p>接着，我们需要在learn-ast目录下创建一个，.babelrc文件，其内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;presets&quot;:[</span><br><span class="line">        &quot;@babel/preset-env&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们就算完成了初始化操作。</p>
<h3 id="9-4-节点类型"><a href="#9-4-节点类型" class="headerlink" title="9.4 节点类型"></a>9.4 节点类型</h3><p>在刚才的示例中，我们看到不同的代码词法单元被解析成了不同的类型，所以这里先简单列举Babel中所支持的一些类型。</p>
<p>Literal：中文可以理解为字面量，既简单的文字表示，比如3、”abc”、null这些都是基本的字面表示。</p>
<p>Declarations：声明，比如声明方法或者变量。</p>
<p>Expressions：表达式，它本身会返回一个计算结果，通常有两个作用：一个是放在赋值语句的右边进行赋值，另外还可以作为方法的参数。</p>
<p>Statements：语句。</p>
<p>Identifier：标识符，指代一些变量的名称，比如上述例子中的name就是Identifier。</p>
<p>Classes：类，代表一个类的定义。</p>
<p>Functions：方法声明。</p>
<p>Modules：模块，可以理解为一个Node.js模块。</p>
<p>Program：程序，整个代码可以称为Program。</p>
<p>当然除此之外还有很多的类型，具体可以参考：<a target="_blank" rel="noopener" href="https://babeljs.io/docs/en/babel-types%E3%80%82">https://babeljs.io/docs/en/babel-types。</a></p>
<h3 id="9-5-babel-parser的使用"><a href="#9-5-babel-parser的使用" class="headerlink" title="9.5 @babel&#x2F;parser的使用"></a>9.5 @babel&#x2F;parser的使用</h3><p>@babel&#x2F;parser是Babel中的Javascript解析器，也是一个Node.js包，他提供了一个重要的方法，就是parse和parseExpression方法，前者支持解析一段JavaScript代码，后者则是尝试解析单个JavaScript表达式并考虑了性能问题。一般来说，我们直接使用parse方法就够了。</p>
<p>对于parse方法来说，输入和输出如下。</p>
<p>输入：一段JavaScript代码。</p>
<p>输出：该段JavaScript代码对应的抽象语法树，即AST，它基于ESTree规范。</p>
<p>现在我们来测试一下。</p>
<p>新建一个JavaScript文件，将其保存为codes&#x2F;code1.js，其内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const a = 3;</span><br><span class="line">let string = &quot;hello&quot;;</span><br><span class="line">for (let i = 0; i &lt; a; i++)&#123;</span><br><span class="line">    string += &quot;world&quot;;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&quot;string&quot;, string);</span><br></pre></td></tr></table></figure>

<p>下面我们需要使用parse方法将其转化为一个抽象语法树，即AST。</p>
<p>新建一个basic1.js文件，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">console.log(ast);</span><br></pre></td></tr></table></figure>

<p>接着我们可以使用babel-node运行：</p>
<p>babel-node basic1.js</p>
<p>结果如下：</p>


<p>可以看到，整个AST的根节点就是一个Node，其中type是File，代表一个File类型的节点，其中包括type、start、end、loc、program等属性。其中program也是一个Node，但它的type是Program，代表一个程序。同样，Program也包括了一些属性，比如start、end、loc、interpreter、body等。其中，body是最为重要的属性，是一个列表类型，列表中的每个元素也都是一个Node，但这些不同的Node其实也是不同的类型，它们的type多种多样，不过这里控制台并没有把其中的节点内容输出出来。</p>
<p>我们可以增加一行代码，再专门输出一下body的内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(ast.program.body);</span><br></pre></td></tr></table></figure>

<p>重新运行，可以发现这里又多输出了一些内容，具体如下：</p>


<p>由于内容过多，这里省略了一些内容。可以看到，我们直接通过ast.program.body即可将body获取到。可以看到，刚才的四个Node的具体结构也被输出出来了。前面两个Node都是VariableDeclaration类型，这正好对应了前面两行代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const a = 3;</span><br><span class="line">let string = &quot;hello&quot;;</span><br></pre></td></tr></table></figure>

<p>这里我们分别声明了一个数字类型和字符串类型的变量，所以每句都被解析为VariableDeclaration类型。每个VariableDeclaration都包含了一个declarations属性，其内部又是一个Node列表，其中包含了具体的详情信息。</p>
<p>接着，我们再继续观察下一个Node，它是ForStatement类型，代表一个for循环语句，对应的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (let i = 0; i &lt; a; i++)&#123;</span><br><span class="line">    string += &quot;world&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>for循环通常包括四个部分，for初始逻辑、判断逻辑、更新逻辑以及以及for循环区块的主循环执行逻辑，所以对于一个ForStatement，它也自然有几个对应的属性表示这些内容，分别为init、test、update和body。</p>
<p>对于init，即循环的初始逻辑，其代码如：let i &#x3D; 0；</p>
<p>它相当于声明一个变量声明，所以它又被解释为VariableDeclaration类型，这和上文是一样的。</p>
<p>对于test，即判断逻辑，其代码如下：</p>
<p>i &#x3c; a</p>
<p>它是一个逻辑表达式，被解析BinaryExpression，代表逻辑运算。</p>
<p>对于update，即更新逻辑，其代码如下：</p>
<p>i++</p>
<p>它就是对i+1，也是一个表达式，被解析为UpdateExpression类型。</p>
<p>对于body，它被一个大括号包围，其内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    string += &quot;world&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>整个内容算作一个代码块，所以被解析为BlockStatement类型，其body属性又是一个列表。</p>
<p>对于最后一行，代码如下：</p>
<p>console.log(“string”, string);</p>
<p>它被解析为ExpressionStatement类型，expression的属性是CallExpression。CallExpression又包含了callee和arguments属性，对应的就是console对象的log方法的调用逻辑。</p>
<p>到现在为止，我们应该能弄明白这个基本过程了。</p>
<p>parser会将代码根据逻辑区块进行划分，每个逻辑区块根据其作用都会归类成不同的类型，不同的类型拥有不同的属性表示。同时代码和代码之间有嵌套关系，所以最终整个代码就会被解析成一个层层嵌套的表示结果。</p>
<h3 id="9-6-babel-generator的使用"><a href="#9-6-babel-generator的使用" class="headerlink" title="9.6 @babel&#x2F;generator的使用"></a>9.6 @babel&#x2F;generator的使用</h3><p>@babel&#x2F;generator也是一个Node.js包，它提供了generate方法将AST还原成JavaScript代码，调用如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line"></span><br><span class="line">const &#123; code: output &#125; = generate(ast)</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>重新运行可以得到如下结果：</p>


<p>这时候我们可以看到，利用generate方法，我们成功地把一个AST对象转化成为Javascript代码。</p>
<p>到这里我们就清楚了，如果要把一段JavaScript解析成AST对象，就用parse方法。如果要把AST对象还原成代码，就用generate方法。</p>
<h3 id="9-7-babel-traverse的使用"><a href="#9-7-babel-traverse的使用" class="headerlink" title="9.7 @babel&#x2F;traverse的使用"></a>9.7 @babel&#x2F;traverse的使用</h3><p>前面我们了解了AST的解析，输入任意一段JavaScript代码，我们便可以分析出其AST。但是只是了解AST，我们并不能实现JavaScript代码的反混淆。下面我们还需要进一步了解另一个强大的功能，就是AST的遍历和修改。</p>
<p>遍历我们使用的是@babel&#x2F;traverse，它可以接收一个AST利用tracerse方法就可以遍历其中的所有节点。在遍历方法中，我们便可以对每一个节点进行对应的操作了。</p>
<p>我们先来感受一下遍历的基本实现。新建一个JavaScript文件，将其命名为basic2.js，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  enter(path) &#123;</span><br><span class="line">   console.log(path)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);   </span><br></pre></td></tr></table></figure>

<p>这里我们调用了traverse方法，给第一个参数传入AST对象，给第二个参数定义了相关的处理逻辑，这里声明了一个enter方法，它接收path参数。这个enter方法在每个节点被遍历到时都会被调用，其中path里面就包含了当前被遍历到的节点相关信息。这里我们先把path输出出来，看看遍历时能拿到什么信息。</p>
<p>运行如下代码：</p>
<p>babel-node basic2.js</p>
<p>这时我们看到控制台输出了非常多的内容，调用很多次log方法输出了对应的内容。每次输出都代表一个path对象，我们拿其中一次输出结果看下。</p>


<p>可以看到内容比较复杂。首先我们可以看到它的类型是NodePath，拥有parent、container、node、scope、type等多个属性。比如node属性是一个Node类型的对象，他代表当前正在遍历的节点。比如，利用parent也能获得一个Node类型对象，它代表该节点的父节点。</p>
<p>所以我们可以利用path.node拿到当前对应的Node对象，利用path.parent拿到当前Node对象的父节点。</p>
<p>既然如此，我们便可以使用他来对Node进行一些处理。比如，我们可以把值变化一下，原来的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const a = 3;</span><br><span class="line">let string = &quot;hello&quot;;</span><br><span class="line">for (let i = 0; i &lt; a; i++)&#123;</span><br><span class="line">    string += &quot;world&quot;;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&quot;string&quot;, string);</span><br></pre></td></tr></table></figure>

<p>我们想要通过修改AST的方式对如上代码进行修改，比如修改一下a变量和string变量的值，变成如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const a = 5;</span><br><span class="line">let string = &quot;hi&quot;;</span><br><span class="line">for (let i = 0; i &lt; a; i++)&#123;</span><br><span class="line">    string += &quot;world&quot;;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&quot;string&quot;, string);</span><br></pre></td></tr></table></figure>

<p>我们可以这样实现逻辑:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line"></span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  enter(path) &#123;</span><br><span class="line">    let node = path.node;</span><br><span class="line">    if (node.type === &quot;NumericLiteral&quot; &amp;&amp; node.value === 3) &#123;</span><br><span class="line">      node.value = 5;</span><br><span class="line">    &#125;</span><br><span class="line">    if (node.type === &quot;StringLiteral&quot; &amp;&amp; node.value === &quot;hello&quot;) &#123;</span><br><span class="line">      node.value = &quot;hi&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const &#123; code: output &#125; = generate(ast, &#123;</span><br><span class="line">  retainLines: true,</span><br><span class="line">&#125;);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>这里我们判断了node的类型和值，然后将node的value进行了替换，这样执行完毕traverse方法之后，AST就被更新完毕了。</p>
<p>运行结果如下：</p>


<p>可以看到，原始的JavaScript代码就被成功更改了！</p>
<p>另外，除了定义enter方法外，我们还可以直接定义对应特定类型的解析方法，这样遇到此类型的节点时，该方法就会被自动调用，用法类似如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  NumericLiteral(path) &#123;</span><br><span class="line">    if (path.node.value === 3) &#123;</span><br><span class="line">      path.node.value = 5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  StringLiteral(path) &#123;</span><br><span class="line">    if (path.node.value === &quot;hello&quot;) &#123;</span><br><span class="line">      path.node.value = &quot;hi&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; code: output &#125; = generate(ast, &#123;</span><br><span class="line">  retainLines: true,</span><br><span class="line">&#125;);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>运行结果完全是相同的，单独定义特定的类型的解析方法会显得更有条理。</p>
<p>另外，我们可以再看下其他的操作方法，比如，删除某个node，这里可以试着删除最后一行代码对应的节点，此时直接调用remove方法即可，用法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code1.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  CallExpression(path) &#123;</span><br><span class="line">    let node = path.node;</span><br><span class="line">    if (</span><br><span class="line">      node.callee.object.name === &quot;console&quot; &amp;&amp;</span><br><span class="line">      node.callee.property.name === &quot;log&quot;</span><br><span class="line">    ) &#123;</span><br><span class="line">      path.remove();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; code: output &#125; = generate(ast, &#123;</span><br><span class="line">  retainLines: true,</span><br><span class="line">&#125;);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>这样我们就可以删除所有的console.log语句。</p>
<p>运行结果如下：</p>


<p>上面说了简单的替换和删除，那么如果我们要插入一个节点，该怎么办呢？插入新的节点时，需要先声明一个节点，怎么声明呢？这时候就要用到types了。</p>
<h3 id="9-8-babel-types的使用"><a href="#9-8-babel-types的使用" class="headerlink" title="9.8 @babel&#x2F;types的使用"></a>9.8 @babel&#x2F;types的使用</h3><p>@babel&#x2F;types是一个Node.js包，里面定义了各种各样的对象，我们可以方便地使用types声明一个新的节点。</p>
<p>比如说，这里有这样一个代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const a = 1;</span><br></pre></td></tr></table></figure>

<p>我们想增加一行代码，将原始的代码变成：</p>
<p>const a &#x3D; 1;</p>
<p>const b &#x3D; a + 1;</p>
<p>该怎么办呢？这时候我们可以借助types实现如下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import * as types from &quot;@babel/types&quot;;</span><br><span class="line"></span><br><span class="line">const code = &quot;const a = 1;&quot;;</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  VariableDeclaration(path) &#123;</span><br><span class="line">    let init = types.binaryExpression(</span><br><span class="line">      &quot;+&quot;,</span><br><span class="line">      types.identifier(&quot;a&quot;),</span><br><span class="line">      types.numericLiteral(1)</span><br><span class="line">    );</span><br><span class="line">    let declarator = types.variableDeclarator(types.identifier(&quot;b&quot;), init);</span><br><span class="line">    let declaration = types.variableDeclaration(&quot;const&quot;, [declarator]);</span><br><span class="line">    path.insertAfter(declaration);</span><br><span class="line">    path.stop();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; code: output &#125; = generate(ast, &#123;</span><br><span class="line">  retainLines: true,</span><br><span class="line">&#125;);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>


<p>这里我们成功使用AST完成了节点的插入，增加了一行代码。</p>
<p>但上面的代码看起来似乎不知道怎么实现的，init、declarator、declaration都是怎么来的呢？</p>
<p>别担心我们，接下来我们详细剖析一下。首先我们可以把最终想要变换的代码进行AST解析，结果如图所示：</p>


<p>这时候我们可以看到第二行代码的节点结构了，现在需要做的就是构造这个节点，需要从内而外依次构造。</p>
<p>首先看到整行代码对应的节点是VariableDeclaration。要生成VariableDeclaration，我们可以借助types的variableDeclaration的方法，二者的差别仅仅是后者的开头字母是小写的。</p>
<p>API怎么用呢？这就需要查阅官方文档了。我们查到variableDeclaration的用法如下：</p>
<p>t.variableDeclaration(kind, declarations)</p>
<p>可以看到，构造他需要两个参数，具体如下。</p>
<ul>
<li>kind：必需，可以是“var”|“let”|“const”。</li>
<li>declarations：必需，是Array&#x3c;VariableDeclarator&gt;，即VariableDeclarator组成的列表。</li>
</ul>
<p>这里kind我们可以确定了，那么declarations怎么构造呢？</p>
<p>要构造declarations，我们需要进一步构造VariableDeclarator，它也可以借助types的variableDeclarator方法，用法如下：</p>
<p>t.variableDeclarator(id, init)</p>
<p>他需要id和init两个参数。</p>
<ul>
<li>id：必需，即Identifier对象</li>
<li>init：Epression对象，默认为空。</li>
</ul>
<p>因此，我们还需要构造 id 和 init 对象。这里 id 其实就是 b 了，我们可以借助于types的identifier方法来构造。而对于init，它是expression，在AST中我们可以观察到它是BinaryExpression类型，所以我们可以借助于types的binaryExpression来构造。binaryExpression的用法如下：</p>
<p>t.binaryExpression(operator, left, right)</p>
<p>他有三个参数，具体如下。</p>
<ul>
<li>operator：必需，”+” | “-“ | “&#x2F;“ | “%” | “*” | “**” | “&amp;” | “|” | “&gt;&gt;” | “&gt;&gt;&gt;” | “&#x3c;&#x3c;” | “^” | “&#x3D;&#x3D;” | “&#x3D;&#x3D;&#x3D;” | “!&#x3D;” | “!&#x3D;&#x3D;” | “in” | “instanceof” | “&gt;” | “&#x3c;” | “&gt;&#x3D;” | “&#x3c;&#x3D;”。</li>
<li>left：必需，Expression，即operator左侧的表达式。</li>
<li>rught：必需，Expression，即operator右侧的表达式。</li>
</ul>
<p>这里又需要三个参数，operator就是运算符，left就是运算符左侧的内容，right就是运算符右侧的内容。后面两个参数都需要是Expression，根据AST，这里的Expression可以直接声明为Identifier和NumericLiteral，所以又可以分别用types的identifier和numericLiteral创建。</p>
<p>这样梳理清楚后，我们从里到外将代码实现出来，一层一层构造，最后就声明了一个VariableDeclaration类型的节点。</p>
<p>最后，调用path的insertAfter方法便可以成功将节点插入到path对相应的节点。</p>
<h2 id="第十章-使用AST技术还原混淆代码"><a href="#第十章-使用AST技术还原混淆代码" class="headerlink" title="第十章 使用AST技术还原混淆代码"></a>第十章 使用AST技术还原混淆代码</h2><p>在上一节中，我们介绍了AST相关的基本知识和基础的操作方法，本节中我们就来实际应用这些方法来还原JavaScript混淆后的代码，即反混淆的实现。</p>
<p>由于JavaScript混淆方式多种多样，这里就介绍一些常见的反混淆方案，如表达式还原，字符串还原，无用代码剔除，反控制流平坦化等。</p>
<h3 id="10-1-表达式还原"><a href="#10-1-表达式还原" class="headerlink" title="10.1 表达式还原"></a>10.1 表达式还原</h3><p>有时候，我们会看到有一些混淆的JavaScript代码其实就是把简单的东西复杂化，比如说一个布尔常量true，被写成 !![] ; 一个数字，被转化为parseInt加一些字符串的拼接。通过这些方式，一些简单又直观的表达式就被复杂化了。</p>
<p>看下面的这几个例子，代码如下：code2.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const a = !![];</span><br><span class="line">const b = &quot;abc&quot; == &quot;bcd&quot;;</span><br><span class="line">const c = (1 &lt;&lt; 3) | 2;</span><br><span class="line">const d = parseInt(&quot;5&quot; + &quot;0&quot;);</span><br></pre></td></tr></table></figure>

<p>对于这种情况，有没有还原的方法呢？当然有，借助于AST，我们可以轻松实现。</p>
<p>首先，在&#x3D;的右侧，其实都是一些表达式的类型，比如 “abc” &#x3D; “bcd” 就是一个BinaryExpression，他代表的是一个布尔类型的结果。</p>
<p>怎么处理呢？我们将上述代码保存为code2.js，根据上一章节学到的知识，可以编写如下还原代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import * as types from &quot;@babel/types&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code2.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  &quot;UnaryExpression|BinaryExpression|ConditionalExpression|CallExpression&quot;: (</span><br><span class="line">    path</span><br><span class="line">  ) =&gt; &#123;</span><br><span class="line">    const &#123; confident, value &#125; = path.evaluate();</span><br><span class="line">    if (value == Infinity || value == -Infinity) return;</span><br><span class="line">    confident &amp;&amp; path.replaceWith(types.valueToNode(value));</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const &#123; code: output &#125; = generate(ast);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>这里我们使用traverse方法对AST对象进行遍历，，使用</p>
<p>“<code>UnaryExpression|BinaryExpression|ConditionalExpression|CallExpression</code>“作为对象的键名，分别用于处理一元表达式、布尔表达式、条件表达式、调用表达式。如果AST对应的path对象符合这几种表达式，就会执行我们定义的回调方法。在回调方法里面，我们调用了path的evaluate方法，该方法会对path对象进行执行，计算所得到的结果。其内部实现会返回一个confident的value字段表示置信度，如果认定结果是可信的，那么confident就是true，我们可以调用path的replaceWith方法把执行的结果value进行替换，否侧不替换。</p>
<p>运行结果如下：</p>


<p>可以看到，原本看起来不怎么直观的代码现在被还原得非常直观了。</p>
<p>所以，利用这个原理，我们可以实现一些表达式的还原和计算，提高整个代码的可读性。</p>
<h3 id="10-2-字符串还原"><a href="#10-2-字符串还原" class="headerlink" title="10.2 字符串还原"></a>10.2 字符串还原</h3><p>之前我们了解到，JavaScript被混淆后，有些字符串会被转化为Unicode或者UTF-8编码的数据，比如说这个样子：const string &#x3D; [“\x68\x65\x6c\x6c\x6f”, “\x77\x6f\x72\x6c\x64”];</p>
<p>其实这原本就是一个简单的字符串，被转换成UTF-8编码之后，其可读性大大降低了，如果这样的字符串被隐藏在JavaScript代码里面，我们想通过搜索字符串的方式寻找关键突破口，就搜不到了。</p>
<p>对于这种字符串，我们能用AST还原码？当然可以。</p>
<p>我们先在<a target="_blank" rel="noopener" href="https://astexplorer.net/%E9%87%8C%E9%9D%A2%E6%8A%8A%E8%BF%99%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%B2%98%E8%B4%B4%E8%BF%9B%E5%8E%BB%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E5%9B%BE%E6%89%80%E7%A4%BA%EF%BC%9A">https://astexplorer.net/里面把这行代码粘贴进去，结果如图所示：</a></p>


<p>可以看到，两个字符串都被识别成了 <code>StringLiteral</code>类型，它们都有一个extra属性。extra属性里卖有一个raw属性和rawValue属性，二者是不一样的，rawValue的真实值已经被分析出来了。</p>
<p>因此，我们只需要将 StringLiteral 中 extra 属性的 raw 值替换为 rawValue 的值即可，实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import traverse from &quot;@babel/traverse&quot;;</span><br><span class="line">import &#123; parse &#125; from &quot;@babel/parser&quot;;</span><br><span class="line">import generate from &quot;@babel/generator&quot;;</span><br><span class="line">import fs from &quot;fs&quot;;</span><br><span class="line"></span><br><span class="line">const code = fs.readFileSync(&quot;codes/code3.js&quot;, &quot;utf-8&quot;);</span><br><span class="line">let ast = parse(code);</span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  StringLiteral(&#123; node &#125;) &#123;</span><br><span class="line">    if (node.extra &amp;&amp; /\\[ux]/gi.test(node.extra.raw)) &#123;</span><br><span class="line">      node.extra.rawValue = node.extra.raw;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; code: output &#125; = generate(ast);</span><br><span class="line">console.log(output);</span><br></pre></td></tr></table></figure>

<p>输出结果如下：</p>


<p>这样我们就成功实现了混淆字符串的还原。</p>
<p>如果我们把这个脚本应用于混杂了混淆字符串的JavaScript文件，那么其中的混淆字符串就可以被还原出来。</p>
<h2 id="第十一章-WebAssembly案例分析和爬取实战"><a href="#第十一章-WebAssembly案例分析和爬取实战" class="headerlink" title="第十一章 WebAssembly案例分析和爬取实战"></a>第十一章 WebAssembly案例分析和爬取实战</h2><p>WebAssembly是一种可以使用非JavaScript编程语言编写代码并且能在浏览器上运行的技术方案。</p>
<p>前面我们也简单介绍过了，借助Emscripten编译工具，我们能将C&#x2F;C++文件转成wasm格式的文件，JavaScript可以直接调用该文件执行其中的方法。</p>
<p>这样做的好处如下。</p>
<ul>
<li>一些核心逻辑（比如API参数的加密逻辑）使用C&#x2F;C++实现，这样这些逻辑就可以“隐藏”在编译生成的wasm文件中，其逆向难度比JavaScript更大。</li>
<li>一些逻辑是基于C&#x2F;C++编写的，有更高的执行效率，这使得以各种语言编写的代码都可以以接近原生的速度在Web中运行。</li>
</ul>
<p>对于这种类型的网站，一般我们会看到网站会加载一些wasm后缀的文件，这就是WebAssembly技术常见的呈现形式，即原生代码被编译成了wasm后缀的文件，JavaScript通过调用wasm文件得到对应的计算结果，然后配合其他JavaScript代码实现页面数据的加载和页面的渲染。</p>
<p>本节中，我们就来通过一个集成WebAssembly的案例网站来认识下WebAssembly，并通过简易的模拟技术来实现网站的爬取。</p>
<h3 id="11-1-案例介绍"><a href="#11-1-案例介绍" class="headerlink" title="11.1 案例介绍"></a>11.1 案例介绍</h3><p>下面我们来看一个案例，网址是 <a target="_blank" rel="noopener" href="https://spa14.scrape.center/%EF%BC%8C%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E8%A1%A8%E9%9D%A2%E4%B8%8A%E5%92%8C%E4%B9%8B%E5%89%8D%E9%9D%9E%E5%B8%B8%E7%B1%BB%E4%BC%BC%EF%BC%8C%E4%BD%86%E6%98%AF%E5%AE%9E%E9%99%85%E4%B8%8A%E5%85%B6API%E7%9A%84%E5%8A%A0%E5%AF%86%E5%8F%82%E6%95%B0%E6%98%AF%E9%80%9A%E8%BF%87WebAssembly%E5%AE%9E%E7%8E%B0%E7%9A%84%E3%80%82">https://spa14.scrape.center/，这个网站表面上和之前非常类似，但是实际上其API的加密参数是通过WebAssembly实现的。</a></p>
<p>首先，我们还是像之前一样，加载首页，然后通过Network面版分析Ajax请求，如图所示：</p>


<p>可以看到，这里就找到了第一页数据的Ajax请求。和之前的案例类似，limit、offset参数用来控制分页，sign参数用来做校验，它的值是一个数字。通过观察后面几页的内容，我们发现sign的值一直在变化。</p>
<p>因此，这里的关键就是在于找到sign值的生成逻辑，我们再模拟请求即可。</p>
<p>接下来，我们就进行一下逆向，先看看这个参数生成的逻辑在哪里吧。</p>
<p>这里我们还是设置一个Ajax断点，再Sources面板的 XHR&#x2F;fetch Breakpoints 这里添加一个断点，内容为&#x2F;api&#x2F;movie，就是在请求加载数据的时候进如断点，如图所示：</p>


<p>接下来，重新刷新页面，可以看到页面执行到断点的位置后停下来，如图所示：</p>


<p>这里我们还是通过Call Stack找到构造逻辑。经过简单的查找和推测，可以判断逻辑的入口在onFetchData方法里面，如图所示：</p>


<p>点击onFetchData方法，找到方法所在的JavaScript代码如图所示：</p>


<p>和之前的案例类似，params的参数有三个——limit、offset、sign，这和Ajax请求一致。</p>
<p>这里关键的参数就是sign了，可以看到它的值是用变量e表示的，而e的生成代码就在上面，如下所示：</p>


<p>可以看到，它通过调用this.$wasm.asm对象的encrypt方法传入了n和一个时间戳构造出来了。</p>
<p>接下来，我们进一步在此处调试一下，在2100行添加断点，如图所示：</p>


<p>重新刷新页面，可以发现页面运行到该段点的位置并停了下来，如图：</p>


<p>这相当于JavaScript上下文处于onFetchData方法内部，所以现在我们可以访问方法内部的所有变量，比如this、this.$wasm等。</p>
<p>接下来，我们在Watch面板中添加一个变量this.$wasm，先看看它是什么对象，如图所示：</p>


<p>可以看到这个this.$wasm对象里面又定义了很多对象和方法，其中就包括了asm对象。因为代码中又调用了asm对象的encrypt来生产sign，所以我们进一步看看asm对象、encrypt方法都是什么。将asm对象直接展开即可：</p>


<p>这时候我们可以看到asm对象里面又包含了 几个对象和方法，比较重要的就是encrypt方法了，其中它的 [[FunctionLocation]]指向了另外一个位置，名称是  Wasm.wasm:0xd9。因为我们就是想知道这个方法内部究竟是什么逻辑，所以直接点击进入，如图：</p>


<p>可以看到，我们进入了一个似乎不是JavaScript代码的位置，文件名称叫作Wasm.wasm。</p>
<p>代码跳转的位置可以看到encrypt字样，其代码定义如下：</p>


<p>如果你了解汇编语言的话，会发现这有点汇编语言的味道。</p>
<p>这其实就是wasm文件，这里面的逻辑其实原本使用C++编写的，通过Emscripten转化为wasm文件，就成了现在的这个样子。</p>
<p>这时候我们可以找下Network请求，搜索wasm后缀的文件，如图：(把断点先去掉)</p>


<p>可以看到，这里就有一个wasm后缀的文件，其逻辑就是刚才看到的内容。</p>


<p>到了这里，wasm代码已经完全看不懂了，接下来怎么做呢？</p>
<p>有两种办法，一种是直接把wasm文件进行反编译，还原成C++代码，此种方法上手难度大，需要了解WebAssembly和逆向相关的知识，另外一种就是通过模拟执行的方式来直接得到加密结果。</p>
<p>本节我们主要来了解第二种方案。拿到wasm文件，然后通过Python模拟执行的方式调用wasm文件，模拟调用它的encrypt方法，传入对应的参数即可。</p>
<h3 id="11-2-模拟执行"><a href="#11-2-模拟执行" class="headerlink" title="11.2 模拟执行"></a>11.2 模拟执行</h3><p>首先，我们把wasm文件下载下来，地址为 <a target="_blank" rel="noopener" href="https://spa14.scrape.center/js/Wasm.wasm%EF%BC%8C%E5%B0%86%E5%85%B6%E4%BF%9D%E5%AD%98%E4%B8%BAWasm.wasm%E6%96%87%E4%BB%B6">https://spa14.scrape.center/js/Wasm.wasm，将其保存为Wasm.wasm文件</a></p>
<p>要使用Python模拟执行wasm，可以使用两个Python库，一个叫作pywasm，另一个叫作wasmer-python，前者使用更加简单，后者功能更加强大。我们使用任意一个库都可以完成wasm文件的模拟。</p>
<p>这里我们以pywasm为例</p>
<p>这个库比较简单，其主要功能就是加载一个wasm文件，然后用Python执行。</p>
<p>安装命令如下：</p>
<p>pip install pywasm</p>
<p>安装完之后，我们可以用如下代码来加载一个wasm文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import pywasm</span><br><span class="line"></span><br><span class="line">runtime = pywasm.load(&quot;./Wasm.wasm&quot;)</span><br><span class="line">print(runtime)</span><br></pre></td></tr></table></figure>

<p>这里我们调用了pywasm的load方法，直接将wasm文件的路径传入，实现了wasm文件的读取，输出结果如下：</p>


<p>可以看到，返回结果就是一个pywasm.Runtime类型的对象。</p>
<p>有了这个Runtime对象之后，我们就可以调用它的exec方法来模拟执行Wasm里面的方法。</p>
<p>比如，在网页中我们可以看到他执行了encrypt方法，并传入了两个参数。我们也来试一下，要模拟调用wasm的方法，只需要调用Runtime对象的exec方法并传入对应的方法名和参数内容即可。</p>
<p>我们可以将代码改写如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import pywasm</span><br><span class="line"></span><br><span class="line">runtime = pywasm.load(&quot;./Wasm.wasm&quot;)</span><br><span class="line">result = runtime.exec(&quot;encrypt&quot;, [1, 2])</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>这里我们调用了exec方法来，第一个参数就是要调用的wasm中的方法名，这里我们传入字符串encrypt，第二个参数是一个列表，代表encrypt方法接收的参数，如果是两个，那么列表长度就是2，参数和列表的元素一一对应即可。</p>
<p>运行结果如下：</p>


<p>调用成功！</p>
<p>成功的输出了结果，但是这似乎并不是我们想要的，因为这里传入的参数其实是我们自定义的，要真正模拟网站的Ajax请求，就要用网站里面的真实参数。</p>
<p>通过分析逻辑，我们知道传入的参数其实一个是offset，一个是时间戳。</p>
<p>其中时间戳的实现是这样的：</p>
<p>parseInt(Math.round((new Date).getTime() &#x2F; 1e3).toString())</p>
<p>这是JavaScript中的实现，我们将其输出到控制台，可以看到运行结果如图所示：</p>


<p>输出的其实就是一个时间戳，结果是数值类型，位数是10位。使用Python实现同样的结果，可以这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">print(int(time.time()))</span><br></pre></td></tr></table></figure>

<p>最终，我们可以将爬虫逻辑实现，具体如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import pywasm</span><br><span class="line">import time</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">base_url = &quot;https://spa14.scrape.center&quot;</span><br><span class="line">page = 10</span><br><span class="line">runtime = pywasm.load(&quot;./Wasm.wasm&quot;)</span><br><span class="line">for i in range(page):</span><br><span class="line">    offset = i * 10</span><br><span class="line">    sign = runtime.exec(&#x27;encrypt&#x27;, [offset, int(time.time())])</span><br><span class="line">    url = f&#x27;&#123;base_url&#125;/api/movie/?limit=10&amp;offset=&#123;offset&#125;&amp;sign=&#123;sign&#125;&#x27;</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    print(response.json())</span><br></pre></td></tr></table></figure>

<p>这里我们先定义了page是10，就是10页，然后开始一个for循环遍历，i就是0~9的数字，offset就是0、10、20、30……、90，sign就是利用刚才的实现，将参数转化为offset变量和时间戳，最后构造url请求即可：</p>
<p>运行结果如下：</p>


<p>可以看到，Ajax请求被成功模拟了，成功爬取到了结果。</p>
<h2 id="第十二章-无限debugger的原理与绕过"><a href="#第十二章-无限debugger的原理与绕过" class="headerlink" title="第十二章 无限debugger的原理与绕过"></a>第十二章 无限debugger的原理与绕过</h2><p>debugger是JavaScript中定义的一个专门用于断点调试的关键字，只要遇到他，JavaScritp的执行便会在此处中断，进入调试模式。</p>
<p>有了debugger这个关键字，我们就可以非常方便地对JavaScript代码进行调试，比如使用JavaScript Hook时，我们可以加入debugger关键字，使其在关键的位置停下来，以便查找逆向突破口。</p>
<p>但有时候，debugger会被网站开发者利用，使其成为阻挠我们正常调试的拦路虎。</p>
<p>本节我们介绍一个案例来绕过无限debugger</p>
<h3 id="12-1-案例介绍"><a href="#12-1-案例介绍" class="headerlink" title="12.1 案例介绍"></a>12.1 案例介绍</h3><p>我们先看一个案例，网址是 <a target="_blank" rel="noopener" href="https://antispider8.scrape.center/%EF%BC%8C%E6%89%93%E5%BC%80%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%EF%BC%8C%E4%B8%80%E8%88%AC%E6%93%8D%E4%BD%9C%E5%92%8C%E4%B9%8B%E5%89%8D%E7%9A%84%E7%BD%91%E7%AB%99%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E4%B8%8D%E5%90%8C%E3%80%82%E4%BD%86%E6%98%AF%EF%BC%8C%E4%B8%80%E6%97%A6%E6%88%91%E4%BB%AC%E6%89%93%E5%BC%80%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%B1%E5%8F%91%E7%8E%B0%E5%AE%83%E7%AB%8B%E5%8D%B3%E8%BF%9B%E5%85%A5%E4%BA%86%E6%96%AD%E7%82%B9%E6%A8%A1%E5%BC%8F%EF%BC%8C%E5%A6%82%E5%9B%BE%EF%BC%9A">https://antispider8.scrape.center/，打开这个网站，一般操作和之前的网站没有什么不同。但是，一旦我们打开开发者工具，就发现它立即进入了断点模式，如图：</a></p>


<p>我们既没有设置任何断点，也没有执行任何额外的脚本，它就直接进入了断点模式。这时候我们可以点击 Resume script execution（恢复脚本执行）按钮，尝试跳过这个断点继续执行。如图所示：</p>


<p>然而不管我们点击多少次按钮，它仍然一次次地进入断点模式，无限循环下去，我们称这样的情况为无限debugger。</p>
<p>怎么办呢？似乎无法正常添加断点调试了，有什么解决办法吗？</p>
<p>肯定是有办法的，本节我们就来总结一下无限debugger的应对方案。</p>
<h3 id="12-2-实现原理"><a href="#12-2-实现原理" class="headerlink" title="12.2 实现原理"></a>12.2 实现原理</h3><p>我们首先要做的是找到无限debugger的源头。在Sources面板中可以看到，debugger关键字出现在一个JavaScript文件里，这时点击左下角的格式化按钮，如图：</p>


<p>格式化后可以发现这里通过setInterval循环，每秒执行1次debugger语句。</p>
<p>当然，还有很多类似的实现，比如无限for循环、无限while循环、无限递归调用等，它们都可以实现这样的效果，原理大同小异。</p>
<p>了解了原理，下面我们就对症下药吧！</p>
<h3 id="12-3-禁用断点"><a href="#12-3-禁用断点" class="headerlink" title="12.3 禁用断点"></a>12.3 禁用断点</h3><p>因为debugger其实就是对应的一个断点，它相当于用代码显式地声明了一个断点，要解除它，我们只需要禁用所有断点就好了。</p>
<p>首先，我们可以禁用所有断点。全局禁用开关位于Sources面板地右上角，叫作 Deactivate breakpoints，如图所示：</p>


<p>这时候我们重新点击一下 Resume script execution 按钮，跳过当前断点，页面就不会进入到无限debugger的状态了。</p>
<p>但是这种全局禁用其实并不是一个好的方案因为禁用之后我们也无法在其他位置增加断点进行调试了，所有的断点都失效了。</p>
<p>这时候我们可以选择禁用局部断点。取消刚才的 Deactivate breakpoints 模式，页面会重新进入无限debugger模式，我们尝试使用另一种方法来跳过这个无限循环debugger。</p>
<p>我们可以在debugger语句所在的行的行号上单击鼠标右键，此时会出现一个快捷菜单如图：</p>


<p>这里会有一个 Never pause here选项，意思是从不在此处暂停。选择这个选项，于是页面变成如图：</p>


<p>当前断点显示为橙色，并且断点前面多了一个？符号，同时Breakpoints也出现了刚才添加的断点位置。这时再次点击 Resume script execution 按钮，就可以发现不会再进入无限debugger模式了。</p>
<p>当然，我们也可以选择另外一个选项 Add conditional breakpoint 如图：</p>


<p>这个模式更加高级，我们可以设置进入断点的条件，比如在调试过程中，期望某个变量的值大于某个具体值的时候才停下来。但在本案例中，由于这里是无限循环，我们没有什么具体的变量可以作为判断依据，因此可以直接写一个简单的表达式来控制。</p>
<p>选择 Add conditional breakpoint 选项，直接填入false 即可。</p>


<p>按下回车键，就跟 Never pause here 选项一样，重新点击 Resume script execution 按钮，也不会进入无限debugger循环了。</p>
<h3 id="12-4-替换文件"><a href="#12-4-替换文件" class="headerlink" title="12.4 替换文件"></a>12.4 替换文件</h3><p>之前我们介绍过Overrides面板的用法，利用它可以将远程的JavaScript文件替换成本地的JavaScript文件，这里我们依然可以使用这个方法来对文件进行替换。</p>
<p>很简单，只需要在新的文件里面把debugger这个关键字删除或者是注释。</p>
<p>我们将当前的JavaScript文件复制到文本编辑器中，删除或者直接注释掉debugger这个关键字，修改如下：</p>


<p>替换完成之后，重新刷新网页，这时候发现不会进入无限debugger模式了。</p>
<h2 id="第十三章-JavaScript逆向技巧总结"><a href="#第十三章-JavaScript逆向技巧总结" class="headerlink" title="第十三章 JavaScript逆向技巧总结"></a>第十三章 JavaScript逆向技巧总结</h2><p>前面我们已经学习了不少JavaScript逆向相关的知识，包括浏览器调试、Hook、AST、无限debugger的绕过以及JavaScript的模拟调用等，这些知识点都比较松散，有时大家学完了可能觉得没有形成一个知识体系，或者说没有一个常规“套路”来应对一些JavaScript逆向的处理流程。</p>
<p>本节中，我们就对前面的知识点做一个串联和总结，总结出JavaScript逆向过程中常用的流程，这个流程适用于大多数JavaScript逆向过程。大家熟练运用之后，可以在不同情况下运用不同的技巧来进行JavaScript逆向操作。</p>
<p>总的来说，JavaScript逆向可以分为三大部分：寻找入口、调试分析、模拟执行。下面我们来分别介绍。</p>
<ul>
<li>寻找入口：这是非常关键的一步，逆向在大部分情况下就是找一些加密参数到底是怎么来的，比如请求中token、sign等参数到底是在哪里构造的，这个关键逻辑可能写在某个关键的方法里面或者隐藏在某个关键变量里面。一个网站加载了很多JavaScript文件，那么怎么从这么多JavaScript代码里面找到关键的位置，那就是一个关键问题。这就是寻找入口。</li>
<li>调试分析：找到入口之后，比如说我们可以定位到某个参数可能是在某个方法里面执行的了，那么里面的逻辑究竟是怎样的，里面调用了多少加密算法，经过了多少变量赋值和转换等，这些我们需要先把整体思路搞清楚，以便于我们后面进行模拟调用或者逻辑改写。在这个过程中，我们主要借助于浏览器的调试工具进行调试分析，或者借助于一些反混淆工具进行代码的反混淆等。</li>
<li>模拟执行：经过调试分析之后，我们差不多已经搞清楚整个逻辑了，但我们的最终目的还是写爬虫，怎么爬到数据才是根本，因此这里就需要对整个加密过程进行逻辑复写或者模拟执行，以把整个加密流程模拟出来，比如输入一些已知变量，调用之后我们就可以拿到一些token内容，再用合格token来进行数据爬取即可。</li>
</ul>
<h3 id="13-1-寻找入口"><a href="#13-1-寻找入口" class="headerlink" title="13.1 寻找入口"></a>13.1 寻找入口</h3><p>首先，我们来看下怎么寻找入口，其中包括查看请求、搜索参数、分析发起调用、断点、Hook等操作，下面我们来分别介绍一下。</p>
<h4 id="13-1-1-查看请求"><a href="#13-1-1-查看请求" class="headerlink" title="13.1.1 查看请求"></a>13.1.1 查看请求</h4><p>一般来说，我们都是先分析想要的数据到底是从哪里来的，比如说对于示例网站 <a target="_blank" rel="noopener" href="https://spa6.scrape.center/%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E9%A6%96%E9%A1%B5%E6%9C%89%E4%B8%80%E6%9D%A1%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%A6%82%E2%80%9C%E9%9C%B8%E7%8E%8B%E5%88%AB%E5%A7%AC%E2%80%9D%E3%80%81%E2%80%9C%E8%BF%99%E4%B8%AA%E6%9D%80%E6%89%8B%E4%B8%8D%E5%A4%AA%E5%86%B7%E2%80%9D%E7%AD%89%EF%BC%8C%E8%BF%99%E4%BA%9B%E6%95%B0%E6%8D%AE%E8%82%AF%E5%AE%9A%E6%98%AF%E6%9F%90%E4%B8%AA%E8%AF%B7%E6%B1%82%E8%BF%94%E5%9B%9E%E7%9A%84%EF%BC%8C%E9%82%A3%E5%AE%83%E7%A9%B6%E7%AB%9F%E6%98%AF%E4%BB%8E%E5%93%AA%E4%B8%AA%E8%AF%B7%E6%B1%82%E9%87%8C%E9%9D%A2%E6%9D%A5%E7%9A%84%E5%91%A2%EF%BC%9F%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%85%88%E5%B0%9D%E8%AF%95%E6%90%9C%E7%B4%A2%E4%B8%80%E4%B8%8B%E3%80%82">https://spa6.scrape.center/，我们可以看到首页有一条条数据，如“霸王别姬”、“这个杀手不太冷”等，这些数据肯定是某个请求返回的，那它究竟是从哪个请求里面来的呢？我们可以先尝试搜索一下。</a><br>打开浏览器开发者工具，打开Network面板，然后点击搜索按钮，比如这里我们就搜索“霸王别姬”这四个字，如图：</p>


<p>此时可以看到对应的搜索结果，点击搜索到的结果，我们就可以定位到对应的响应结果的位置。</p>
<p>找到对应的响应之后，我们也就可以顺便找到是哪个请求发起的了。</p>
<p>比如这里，我们就顺利找到想要的数据所对应的请求位置了，可以看到这是一个GET请求，同时还有一个token参数，我们可以在后面继续分析。</p>


<p>一般来说，我们可以通过这种方法来尝试寻找最初的突破口。如果这个请求带有加密参数，就顺着继续找下这个参数究竟是在哪里生成的，如果这个请求对应的参数甚至都没有什么加密参数，那么这个请求都可以直接模拟爬取了。</p>
<h4 id="13-1-2-搜索参数"><a href="#13-1-2-搜索参数" class="headerlink" title="13.1.2 搜索参数"></a>13.1.2 搜索参数</h4><p>在上一步中，我们找到了最初的突破口，也就是关键请求是怎么发起的，带有什么加密参数，比如，在上面的例子中，我们发现这里有一个关键的加密参数token，那这又是怎么构造出来的呢？</p>
<p>一种简单有效的方法就是直接进行全局搜索。一般来说，参数名大多数情况下就是一个普通的字符串，比如这里就叫作token，那么这个字符串肯定隐藏在某个JavaScript文件里面，我们可以尝试进行搜索，也可以加冒号、空格、引号等来配合搜索。因为一般来说这个参数通常会配合一些符号一起出现，比如我们可以搜索：token、token：、“token”等。</p>
<p>在哪里搜索呢？我们可以直接利用浏览器调试面板的搜索功能，如图：</p>


<p>这是一个资源搜索的入口，比如可以搜索下载下来的JavaScript文件的内容，这里我们输入token来进行搜索，结果如图：</p>


<p>这样我们就可以找到一些关键的位置点了，一共五个结果，结果不多，我们可以进一步点击并定位到对应的JavaScript文件中，然后进一步进行分析。</p>
<h4 id="13-1-3-分析发起调用"><a href="#13-1-3-分析发起调用" class="headerlink" title="13.1.3 分析发起调用"></a>13.1.3 分析发起调用</h4><p>上述的搜索是其中一种查找入口的方式，这是从源码级别上直接查找。当然，我们也可以通过其他的思路来查找入口，比如可以查看发起调用的流程，怎么查看呢？</p>
<p>可以直接从Network请求里面的Initiator查看当前请求的相关逻辑，如图：</p>


<p>右侧显示了一步步调用对应的源码的位置，我们可以顺次点进去找到对应的位置，比如这里第8层调用，里面有个 onFetchData 方法。点击右侧的代码位置，就可以找到一些相关的逻辑，如图：</p>


<p>这里可以看到一些 token 相关的逻辑调用过程了。</p>
<h4 id="13-1-4-断点"><a href="#13-1-4-断点" class="headerlink" title="13.1.4 断点"></a>13.1.4 断点</h4><p>另外，我们还可以通过断点来进行入口的查找，比如XHR断点，DOM断点，事件断点等。</p>
<p>我们可以在开发者工具Sources面板里面调价设置，比如我们之前添加了XHR断点，如图：</p>


<p>这样网页就可以在发起Ajax请求的时候停下来，进入断点调试模式，也就是说，通过浏览器断点调试功能，我们也可以找到到对应的入口。</p>
<h3 id="13-2-调试分析"><a href="#13-2-调试分析" class="headerlink" title="13.2 调试分析"></a>13.2 调试分析</h3><p>找到对应的入口位置之后，接下来我们就需要进行调试分析了。在这个步骤中，我们通常需要进行一些格式化、断点调试、反混淆等操作来辅助整个流程的分析。</p>
<h4 id="13-2-1-格式化"><a href="#13-2-1-格式化" class="headerlink" title="13.2.1 格式化"></a>13.2.1 格式化</h4><p>格式化这个流程是非常重要的，它可以大大增加代码的可读性，一般来说很多JavaScript代码都是经过打包和压缩的，多数情况下，我们可以使用Sources面板下的JavaScript窗口左下角的格式化按钮对代码就行格式化，如图：</p>


<h4 id="13-2-2-断点调试"><a href="#13-2-2-断点调试" class="headerlink" title="13.2.2 断点调试"></a>13.2.2 断点调试</h4><p>代码格式化之后，我们就可以进入正式的调试流程了，基本操作就是给想要调试的代码添加断点，同时在对应的面板里面观察对应变量的值。</p>
<p>如图所示：我们在190行添加断点，然后逐行运行对应的代码，这时代码页面就会出现对应变量的值，同时我们也可以在Watch面板上监听关注的变量。</p>


<p>通过这样的方式，我们就可以对整个代码流程有一个大致的了解。</p>
<h4 id="13-2-3-反混淆"><a href="#13-2-3-反混淆" class="headerlink" title="13.2.3 反混淆"></a>13.2.3 反混淆</h4><p>在某些情况下，我们还有可能遇到一些混淆的方式，此时通过之前章节所讲的反混淆技术还原代码即可。</p>
<h3 id="13-3-模拟执行"><a href="#13-3-模拟执行" class="headerlink" title="13.3 模拟执行"></a>13.3 模拟执行</h3><p>经过一系列调试，现在我们已经可以理清其中的逻辑了，接下来就是一些调用执行的过程了。在前面的章节中，我们已经讲过一些案例执行的流程了。</p>
<h4 id="13-3-1-python改写或者模拟执行"><a href="#13-3-1-python改写或者模拟执行" class="headerlink" title="13.3.1 python改写或者模拟执行"></a>13.3.1 python改写或者模拟执行</h4><p>由于python简单易用，同时也能够模拟调用执行JavaScript。如果整体逻辑不复杂的话，我们可以尝试使用python来把整个加密流程完整实现一遍。如果整体流程相对复杂，我们可以尝试使用python来模拟调用JavaScript的执行。</p>
<h4 id="13-3-2-JavaScript模拟执行-API"><a href="#13-3-2-JavaScript模拟执行-API" class="headerlink" title="13.3.2 JavaScript模拟执行+API"></a>13.3.2 JavaScript模拟执行+API</h4><p>由于整个逻辑是JavaScript实现的，使用python来执行JavaScript难免会有一些不太方便的地方。</p>
<p>而node.js天生就有对javaScript的支持。为了更通用地实现JavaScript的模拟调用。我们可以用express来模拟调用JavaScript，同时将其暴露成一个API，从而实现跨域语言的调用。</p>
<h4 id="13-3-3-浏览器模拟执行"><a href="#13-3-3-浏览器模拟执行" class="headerlink" title="13.3.3 浏览器模拟执行"></a>13.3.3 浏览器模拟执行</h4><p>由于整个逻辑是运行在浏览器里面的，我们当然也可以将浏览器当作整个执行环境，比如使用Selenium等工具尝试执行一些JavaScript代码，得到一些返回结果。</p>
<p>调用的方式有很多，不同的情况我们可以根据实现的难以程度来选择不同的方案。</p>
<h2 id="第十四章-JavaScript逆向爬取实战"><a href="#第十四章-JavaScript逆向爬取实战" class="headerlink" title="第十四章 JavaScript逆向爬取实战"></a>第十四章 JavaScript逆向爬取实战</h2><p>前面我们学习了各种JavaScirpt逆向技巧，本节中我们综合应用之前学习到的知识点进行一个完整的JavaScript逆向分析和爬取实战。</p>
<h3 id="14-1-案例介绍"><a href="#14-1-案例介绍" class="headerlink" title="14.1 案例介绍"></a>14.1 案例介绍</h3><p>本节的案例网站不仅在API参数有加密，而且前端JavaScript也带有压缩和混淆，其前端压缩打包工具使用webpack，混淆工具使用javascript-obfuscator。分析该网站需要熟练掌握浏览器的开发者工具和一定的调试技巧，另外还需要用到一些Hook技术等辅助分析手段。</p>
<p>案例的地址为 <a target="_blank" rel="noopener" href="https://spa6.scrape.center/,%E9%A1%B5%E9%9D%A2%E9%A6%96%E9%A1%B5%E5%A6%82%E5%9B%BE%E6%89%80%E7%A4%BA%EF%BC%9A">https://spa6.scrape.center/,页面首页如图所示：</a></p>


<p>和之前的网站并没有什么不同之处，但仔细观察可以发现其Ajax请求接口和每部电影的url都包含了加密参数。</p>
<p>比如我们点击任意一部电影，观察一下URL的变化，如图：</p>


<p>可以看到详情页的url包含了一个长字符串，看上去像是Base64编码的内容。</p>
<p>接下来，看看Ajax请求。我们从列表页的第1页到第10页依次点一下，观察Ajax请求时怎样的，如图所示：</p>


<p>可以看到，Ajax接口的url里多了一个token，而且在不同的页码，token是不一样的，它们同样看似时Base64编码的字符串。</p>
<p>另外，更困难的是，这个接口还有时效性。如果我们把Ajax接口的url直接复制下来，短期内可以访问，但是过一段时间之后就无法访问了，会直接返回401状态码。</p>
<p>我们再看一下列表的返回结果，比如打开第一个请求，看看第一部电影数据的返回结果，如图所示：</p>


<p>这里看似是把第一部电影的返回结果全展开了，但是刚才我们观察到第一部电影的url是<a target="_blank" rel="noopener" href="https://spa6.scrape.center/detail/ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx%EF%BC%8C%E7%9C%8B%E8%B5%B7%E6%9D%A5%E6%98%AFBase64%E7%BC%96%E7%A0%81%EF%BC%8C%E6%88%91%E4%BB%AC%E5%AF%B9%E5%AE%83%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B8%BA">https://spa6.scrape.center/detail/ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx，看起来是Base64编码，我们对它进行解码，结果为</a> ef34#teuq0btua#(-57w1q5o5--j@98xygimlyfxs*-!i-0-mb1（用在线解码工具）看起来还是没有规律，这个解码后的结果又是怎么来的？返回的结果里并不包含这个字符串，这又是怎么构造的呢？</p>
<p>还有，这仅仅是某个详情页页面的url，其真实数据是通过Ajax加载的，那么Ajax请求又是怎么样的呢？我们再观察一下如图所示：</p>


<p>这里我们发现其Ajax接口除了包含刚才所说的url中携带的字符串，又多了一个token，同样也是类似Base64编码的内容。总结下来，这个网站就有如下特点：</p>
<ul>
<li>列表页的Ajax接口参数带有加密token；</li>
<li>详情页的URL参数带有加密id；</li>
<li>详情页的Ajax接口参数带有加密id和加密token。</li>
</ul>
<p>如果我们要想通过接口的形式进行爬取，必须把这些加密id和token构造出来才行，而且必须一步一步来。首先我们要构造出列表页Ajax接口的token参数，然后获取每部电影的数据信息，接着根据数据信息构造出加密id和token。</p>
<p>到现在为止，我们知道了这个网站接口的加密情况，下一步就是去找这个加密实现逻辑。</p>
<p>由于是网页，所以其加密逻辑一定藏在前端代码里，但上一节我们也说了，前端为了保护其接口加密逻辑不被轻易分析出来，会采取压缩、混淆等方式来加大分析的难度。下面我们就来看看这个网站的源代码和JavaScript文件是怎样的。</p>
<p>首先看网站的源代码，我们在网站上点击鼠标右键，此时会弹出快捷菜单，然后点击“查看源代码”选项，如图所示：</p>


<p>内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html lang=en&gt;&lt;head&gt;&lt;meta charset=utf-8&gt;&lt;meta http-equiv=X-UA-Compatible content=&quot;IE=edge&quot;&gt;&lt;meta name=viewport content=&quot;width=device-width,initial-scale=1&quot;&gt;&lt;link rel=icon href=/favicon.ico&gt;&lt;title&gt;Scrape | Movie&lt;/title&gt;&lt;link href=/css/chunk-19c920f8.2a6496e0.css rel=prefetch&gt;&lt;link href=/css/chunk-2f73b8f3.5b462e16.css rel=prefetch&gt;&lt;link href=/js/chunk-19c920f8.c3a1129d.js rel=prefetch&gt;&lt;link href=/js/chunk-2f73b8f3.8f2fc3cd.js rel=prefetch&gt;&lt;link href=/js/chunk-4dec7ef0.e4c2b130.js rel=prefetch&gt;&lt;link href=/css/app.ea9d802a.css rel=preload as=style&gt;&lt;link href=/js/app.5ef0d454.js rel=preload as=script&gt;&lt;link href=/js/chunk-vendors.77daf991.js rel=preload as=script&gt;&lt;link href=/css/app.ea9d802a.css rel=stylesheet&gt;&lt;/head&gt;&lt;body&gt;&lt;noscript&gt;&lt;strong&gt;We&#x27;re sorry but portal doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.&lt;/strong&gt;&lt;/noscript&gt;&lt;div id=app&gt;&lt;/div&gt;&lt;script src=/js/chunk-vendors.77daf991.js&gt;&lt;/script&gt;&lt;script src=/js/app.5ef0d454.js&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>这是一个典型的SPA(单页Web应用)页面，其JavaScript文件名带有编码字符、chunk、vendors等关键字，这就是经过webpack打包压缩后的源代码，目前主流的前端开发框架Vue.js、React.js等的输出结果都是类似这样的。</p>
<p>接下来，我们再看一下其JavaScript代码是什么样子的。再开发者工具中打开Sources选项卡下的page选项，然后打开js文件夹，在这里我们能看到JavaScript的源代码，如图：</p>


<p>我们随便复制一些出来，看看是什么样子的，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(window[&#x27;webpackJsonp&#x27;]=window[&#x27;webpackJsonp&#x27;]||[])[&#x27;push&#x27;]([[&#x27;chunk-4dec7ef0&#x27;],&#123;&#x27;00bb&#x27;:function(_0x4f8837,_0x262b1b,_0x47f85e)&#123;(function(_0x353526,_0x29d305,_0x4a28d3)&#123;_0x4f8837[&#x27;exports&#x27;]=_0x29d305(_0x47f85e(&#x27;21bf&#x27;),_0x47f85e(&#x27;38ba&#x27;));&#125;(0x0,function(_0x47ffa6)&#123;return _0x47ffa6[&#x27;mode&#x27;][&#x27;CFB&#x27;]=function()&#123;var _0x130a3a=_0x47ffa6[&#x27;lib&#x27;][&#x27;BlockCipherMode&#x27;][&#x27;extend&#x27;]();function _0x56a78e(_0x38b9fa,_0x5a30b0,_0x15e394,_0x4b6cda)&#123;var _0x4f1b23=this[&#x27;_iv&#x27;];if(_0x4f1b23)&#123;var _0x36e95d=_0x4f1b23[&#x27;slice&#x27;](0x0);this[&#x27;_iv&#x27;]=void 0x0;&#125;else _0x36e95d=this[&#x27;_prevBlock&#x27;];_0x4b6cda[&#x27;encryptBlock&#x27;](_0x36e95d,0x0);for(var _0x593f2f=0x0;_0x593f2f&lt;_0x15e394;_0x593f2f++)_0x38b9fa[_0x5a30b0+_0x593f2f]^=_0x36e95d[_0x593f2f];&#125;return _0x130a3a[&#x27;Encryptor&#x27;]=_0x130a3a[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x52b87e,_0x7bf075)&#123;var _0x552022=this[&#x27;_cipher&#x27;],_0x146f2c=_0x552022[&#x27;blockSize&#x27;];_0x56a78e[&#x27;call&#x27;](this,_0x52b87e,_0x7bf075,_0x146f2c,_0x552022),this[&#x27;_prevBlock&#x27;]=_0x52b87e[&#x27;slice&#x27;](_0x7bf075,_0x7bf075+_0x146f2c);&#125;&#125;),_0x130a3a[&#x27;Decryptor&#x27;]=_0x130a3a[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x30eec8,_0x2f0556)&#123;var _0x5f1763=this[&#x27;_cipher&#x27;],_0x397e68=_0x5f1763[&#x27;blockSize&#x27;],_0x132675=_0x30eec8[&#x27;slice&#x27;](_0x2f0556,_0x2f0556+_0x397e68);_0x56a78e[&#x27;call&#x27;](this,_0x30eec8,_0x2f0556,_0x397e68,_0x5f1763),this[&#x27;_prevBlock&#x27;]=_0x132675;&#125;&#125;),_0x130a3a;&#125;(),_0x47ffa6[&#x27;mode&#x27;][&#x27;CFB&#x27;];&#125;));&#125;,&#x27;0bfb&#x27;:function(_0x3a7403,_0x16a22c,_0x3a87dd)&#123;&#x27;use strict&#x27;;var _0x4083a8=_0x3a87dd(&#x27;cb7c&#x27;);_0x3a7403[&#x27;exports&#x27;]=function()&#123;var _0x17ba27=_0x4083a8(this),_0x146dd9=&#x27;&#x27;;return _0x17ba27[&#x27;global&#x27;]&amp;&amp;(_0x146dd9+=&#x27;g&#x27;),_0x17ba27[&#x27;ignoreCase&#x27;]&amp;&amp;(_0x146dd9+=&#x27;i&#x27;),_0x17ba27[&#x27;multiline&#x27;]&amp;&amp;(_0x146dd9+=&#x27;m&#x27;),_0x17ba27[&#x27;unicode&#x27;]&amp;&amp;(_0x146dd9+=&#x27;u&#x27;),_0x17ba27[&#x27;sticky&#x27;]&amp;&amp;(_0x146dd9+=&#x27;y&#x27;),_0x146dd9;&#125;;&#125;,&#x27;10b7&#x27;:function(_0x1b566f,_0xf63964,_0x3674a7)&#123;(function(_0x3bed90,_0x285472)&#123;_0x1b566f[&#x27;exports&#x27;]=_0x285472(_0x3674a7(&#x27;21bf&#x27;));&#125;(0x0,function(_0x361f76)&#123;/** @preserve</span><br><span class="line">	(c) 2012 by Cédric Mesnil. All rights reserved.</span><br><span class="line"></span><br><span class="line">	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span><br><span class="line"></span><br><span class="line">	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span><br><span class="line">	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span><br><span class="line"></span><br><span class="line">	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span><br><span class="line">	*/</span><br><span class="line">return function(_0x2ed6a3)&#123;var _0x331eab=_0x361f76,_0x189535=_0x331eab[&#x27;lib&#x27;],_0x17f5f4=_0x189535[&#x27;WordArray&#x27;],_0x40c120=_0x189535[&#x27;Hasher&#x27;],_0x403605=_0x331eab[&#x27;algo&#x27;],_0x2e6fec=_0x17f5f4[&#x27;create&#x27;]([0x0,0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x7,0x4,0xd,0x1,0xa,0x6,0xf,0x3,0xc,0x0,0x9,0x5,0x2,0xe,0xb,0x8,0x3,0xa,0xe,0x4,0x9,0xf,0x8,0x1,0x2,0x7,0x0,0x6,0xd,0xb,0x5,0xc,0x1,0x9,0xb,0xa,0x0,0x8,0xc,0x4,0xd,0x3,0x7,0xf,0xe,0x5,0x6,0x2,0x4,0x0,0x5,0x9,0x7,0xc,0x2,0xa,0xe,0x1,0x3,0x8,0xb,0x6,0xf,0xd]),_0x87cf80=_0x17f5f4[&#x27;create&#x27;]([0x5,0xe,0x7,0x0,0x9,0x2,0xb,0x4,0xd,0x6,0xf,0x8,0x1,0xa,0x3,0xc,0x6,0xb,0x3,0x7,0x0,0xd,0x5,0xa,0xe,0xf,0x8,0xc,0x4,0x9,0x1,0x2,0xf,0x5,0x1,0x3,0x7,0xe,0x6,0x9,0xb,0x8,0xc,0x2,0xa,0x0,0x4,0xd,0x8,0x6,0x4,0x1,0x3,0xb,0xf,0x0,0x5,0xc,0x2,0xd,0x9,0x7,0xa,0xe,0xc,0xf,0xa,0x4,0x1,0x5,0x8,0x7,0x6,0x2,0xd,0xe,0x0,0x3,0x9,0xb]),_0x16f5f8=_0x17f5f4[&#x27;create&#x27;]([0xb,0xe,0xf,0xc,0x5,0x8,0x7,0x9,0xb,0xd,0xe,0xf,0x6,0x7,0x9,0x8,0x7,0x6,0x8,0xd,0xb,0x9,0x7,0xf,0x7,0xc,0xf,0x9,0xb,0x7,0xd,0xc,0xb,0xd,0x6,0x7,0xe,0x9,0xd,0xf,0xe,0x8,0xd,0x6,0x5,0xc,0x7,0x5,0xb,0xc,0xe,0xf,0xe,0xf,0x9,0x8,0x9,0xe,0x5,0x6,0x8,0x6,0x5,0xc,0x9,0xf,0x5,0xb,0x6,0x8,0xd,0xc,0x5,0xc,0xd,0xe,0xb,0x8,0x5,0x6]),_0x3bf4b6=_0x17f5f4[&#x27;create&#x27;]([0x8,0x9,0x9,0xb,0xd,0xf,0xf,0x5,0x7,0x7,0x8,0xb,0xe,0xe,0xc,0x6,0x9,0xd,0xf,0x7,0xc,0x8,0x9,0xb,0x7,0x7,0xc,0x7,0x6,0xf,0xd,0xb,0x9,0x7,0xf,0xb,0x8,0x6,0x6,0xe,0xc,0xd,0x5,0xe,0xd,0xd,0x7,0x5,0xf,0x5,0x8,0xb,0xe,0xe,0x6,0xe,0x6,0x9,0xc,0x9,0xc,0x5,0xf,0x8,0x8,0x5,0xc,0x9,0xc,0x5,0xe,0x6,0x8,0xd,0x6,0x5,0xf,0xd,0xb,0xb]),_0x476366=_0x17f5f4[&#x27;create&#x27;]([0x0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),_0xe04516=_0x17f5f4[&#x27;create&#x27;]([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0x0]),_0x4578f4=_0x403605[&#x27;RIPEMD160&#x27;]=_0x40c120[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=_0x17f5f4[&#x27;create&#x27;]([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);&#125;,&#x27;_doProcessBlock&#x27;:function(_0x544b29,_0x4b8691)&#123;for(var _0xa7aa64=0x0;_0xa7aa64&lt;0x10;_0xa7aa64++)&#123;var _0x444cba=_0x4b8691+_0xa7aa64,_0x509c8e=_0x544b29[_0x444cba];_0x544b29[_0x444cba]=0xff00ff&amp;(_0x509c8e&lt;&lt;0x8|_0x509c8e&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x509c8e&lt;&lt;0x18|_0x509c8e&gt;&gt;&gt;0x8);&#125;var _0x4543ab,_0xfe3678,_0x2fb20f,_0x11467d,_0x2dfb0f,_0x3716af,_0x3a0ef8,_0x5643ff,_0xe8aedc,_0x2dd504,_0x5ecd24,_0x2e2a43=this[&#x27;_hash&#x27;][&#x27;words&#x27;],_0x1ab7cb=_0x476366[&#x27;words&#x27;],_0x439df4=_0xe04516[&#x27;words&#x27;],_0x4e925f=_0x2e6fec[&#x27;words&#x27;],_0x4cbb1a=_0x87cf80[&#x27;words&#x27;],_0xa7eaeb=_0x16f5f8[&#x27;words&#x27;],_0x492ac7=_0x3bf4b6[&#x27;words&#x27;];_0x3716af=_0x4543ab=_0x2e2a43[0x0],_0x3a0ef8=_0xfe3678=_0x2e2a43[0x1],_0x5643ff=_0x2fb20f=_0x2e2a43[0x2],_0xe8aedc=_0x11467d=_0x2e2a43[0x3],_0x2dd504=_0x2dfb0f=_0x2e2a43[0x4];for(_0xa7aa64=0x0;_0xa7aa64&lt;0x50;_0xa7aa64+=0x1)_0x5ecd24=_0x4543ab+_0x544b29[_0x4b8691+_0x4e925f[_0xa7aa64]]|0x0,_0x5ecd24+=_0xa7aa64&lt;0x10?_0x47834c(_0xfe3678,_0x2fb20f,_0x11467d)+_0x1ab7cb[0x0]:_0xa7aa64&lt;0x20?_0x30ff01(_0xfe3678,_0x2fb20f,_0x11467d)+_0x1ab7cb[0x1]:_0xa7aa64&lt;0x30?_0x1c28cf(_0xfe3678,_0x2fb20f,_0x11467d)+_0x1ab7cb[0x2]:_0xa7aa64&lt;0x40?_0x4956ff(_0xfe3678,_0x2fb20f,_0x11467d)+_0x1ab7cb[0x3]:_0x1b34a7(_0xfe3678,_0x2fb20f,_0x11467d)+_0x1ab7cb[0x4],_0x5ecd24|=0x0,_0x5ecd24=_0xcae23c(_0x5ecd24,_0xa7eaeb[_0xa7aa64]),_0x5ecd24=_0x5ecd24+_0x2dfb0f|0x0,_0x4543ab=_0x2dfb0f,_0x2dfb0f=_0x11467d,_0x11467d=_0xcae23c(_0x2fb20f,0xa),_0x2fb20f=_0xfe3678,_0xfe3678=_0x5ecd24,_0x5ecd24=_0x3716af+_0x544b29[_0x4b8691+_0x4cbb1a[_0xa7aa64]]|0x0,_0x5ecd24+=_0xa7aa64&lt;0x10?_0x1b34a7(_0x3a0ef8,_0x5643ff,_0xe8aedc)+_0x439df4[0x0]:_0xa7aa64&lt;0x20?_0x4956ff(_0x3a0ef8,_0x5643ff,_0xe8aedc)+_0x439df4[0x1]:_0xa7aa64&lt;0x30?_0x1c28cf(_0x3a0ef8,_0x5643ff,_0xe8aedc)+_0x439df4[0x2]:_0xa7aa64&lt;0x40?_0x30ff01(_0x3a0ef8,_0x5643ff,_0xe8aedc)+_0x439df4[0x3]:_0x47834c(_0x3a0ef8,_0x5643ff,_0xe8aedc)+_0x439df4[0x4],_0x5ecd24|=0x0,_0x5ecd24=_0xcae23c(_0x5ecd24,_0x492ac7[_0xa7aa64]),_0x5ecd24=_0x5ecd24+_0x2dd504|0x0,_0x3716af=_0x2dd504,_0x2dd504=_0xe8aedc,_0xe8aedc=_0xcae23c(_0x5643ff,0xa),_0x5643ff=_0x3a0ef8,_0x3a0ef8=_0x5ecd24;_0x5ecd24=_0x2e2a43[0x1]+_0x2fb20f+_0xe8aedc|0x0,_0x2e2a43[0x1]=_0x2e2a43[0x2]+_0x11467d+_0x2dd504|0x0,_0x2e2a43[0x2]=_0x2e2a43[0x3]+_0x2dfb0f+_0x3716af|0x0,_0x2e2a43[0x3]=_0x2e2a43[0x4]+_0x4543ab+_0x3a0ef8|0x0,_0x2e2a43[0x4]=_0x2e2a43[0x0]+_0xfe3678+_0x5643ff|0x0,_0x2e2a43[0x0]=_0x5ecd24;&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x2aa283=this[&#x27;_data&#x27;],_0x3dc03b=_0x2aa283[&#x27;words&#x27;],_0x5c0f43=0x8*this[&#x27;_nDataBytes&#x27;],_0x19e605=0x8*_0x2aa283[&#x27;sigBytes&#x27;];_0x3dc03b[_0x19e605&gt;&gt;&gt;0x5]|=0x80&lt;&lt;0x18-_0x19e605%0x20,_0x3dc03b[0xe+(_0x19e605+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=0xff00ff&amp;(_0x5c0f43&lt;&lt;0x8|_0x5c0f43&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x5c0f43&lt;&lt;0x18|_0x5c0f43&gt;&gt;&gt;0x8),_0x2aa283[&#x27;sigBytes&#x27;]=0x4*(_0x3dc03b[&#x27;length&#x27;]+0x1),this[&#x27;_process&#x27;]();for(var _0x3e6532=this[&#x27;_hash&#x27;],_0x4e127d=_0x3e6532[&#x27;words&#x27;],_0x293470=0x0;_0x293470&lt;0x5;_0x293470++)&#123;var _0xe7716b=_0x4e127d[_0x293470];_0x4e127d[_0x293470]=0xff00ff&amp;(_0xe7716b&lt;&lt;0x8|_0xe7716b&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0xe7716b&lt;&lt;0x18|_0xe7716b&gt;&gt;&gt;0x8);&#125;return _0x3e6532;&#125;,&#x27;clone&#x27;:function()&#123;var _0xc67c87=_0x40c120[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0xc67c87[&#x27;_hash&#x27;]=this[&#x27;_hash&#x27;][&#x27;clone&#x27;](),_0xc67c87;&#125;&#125;);function _0x47834c(_0x394fcc,_0x403949,_0x4b52e3)&#123;return _0x394fcc^_0x403949^_0x4b52e3;&#125;function _0x30ff01(_0x4ec5d1,_0x1ffda8,_0x2dba25)&#123;return _0x4ec5d1&amp;_0x1ffda8|~_0x4ec5d1&amp;_0x2dba25;&#125;function _0x1c28cf(_0x16cf38,_0x439560,_0x3fa31c)&#123;return(_0x16cf38|~_0x439560)^_0x3fa31c;&#125;function _0x4956ff(_0x10da61,_0x42daac,_0x2814a7)&#123;return _0x10da61&amp;_0x2814a7|_0x42daac&amp;~_0x2814a7;&#125;function _0x1b34a7(_0x5e55b6,_0x52c42f,_0x1cb645)&#123;return _0x5e55b6^(_0x52c42f|~_0x1cb645);&#125;function _0xcae23c(_0xf18de8,_0x16ebd1)&#123;return _0xf18de8&lt;&lt;_0x16ebd1|_0xf18de8&gt;&gt;&gt;0x20-_0x16ebd1;&#125;_0x331eab[&#x27;RIPEMD160&#x27;]=_0x40c120[&#x27;_createHelper&#x27;](_0x4578f4),_0x331eab[&#x27;HmacRIPEMD160&#x27;]=_0x40c120[&#x27;_createHmacHelper&#x27;](_0x4578f4);&#125;(Math),_0x361f76[&#x27;RIPEMD160&#x27;];&#125;));&#125;,1132:function(_0x22c790,_0x370bf8,_0x344368)&#123;(function(_0x33f30c,_0x52fee8)&#123;_0x22c790[&#x27;exports&#x27;]=_0x52fee8(_0x344368(&#x27;21bf&#x27;));&#125;(0x0,function(_0x23416a)&#123;return function()&#123;var _0x2f62b8=_0x23416a,_0x5c8e1b=_0x2f62b8[&#x27;lib&#x27;],_0x59277d=_0x5c8e1b[&#x27;WordArray&#x27;],_0x510efe=_0x2f62b8[&#x27;enc&#x27;];_0x510efe[&#x27;Base64&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x333619)&#123;var _0x15e563=_0x333619[&#x27;words&#x27;],_0x38f909=_0x333619[&#x27;sigBytes&#x27;],_0x1f6ceb=this[&#x27;_map&#x27;];_0x333619[&#x27;clamp&#x27;]();for(var _0x1fdac6=[],_0x42f1e3=0x0;_0x42f1e3&lt;_0x38f909;_0x42f1e3+=0x3)for(var _0x234ac1=_0x15e563[_0x42f1e3&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x42f1e3%0x4*0x8&amp;0xff,_0x31bc94=_0x15e563[_0x42f1e3+0x1&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-(_0x42f1e3+0x1)%0x4*0x8&amp;0xff,_0x10ac96=_0x15e563[_0x42f1e3+0x2&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-(_0x42f1e3+0x2)%0x4*0x8&amp;0xff,_0x43b384=_0x234ac1&lt;&lt;0x10|_0x31bc94&lt;&lt;0x8|_0x10ac96,_0x133f57=0x0;_0x133f57&lt;0x4&amp;&amp;_0x42f1e3+0.75*_0x133f57&lt;_0x38f909;_0x133f57++)_0x1fdac6[&#x27;push&#x27;](_0x1f6ceb[&#x27;charAt&#x27;](_0x43b384&gt;&gt;&gt;0x6*(0x3-_0x133f57)&amp;0x3f));var _0x1fe1bb=_0x1f6ceb[&#x27;charAt&#x27;](0x40);if(_0x1fe1bb)while(_0x1fdac6[&#x27;length&#x27;]%0x4)_0x1fdac6[&#x27;push&#x27;](_0x1fe1bb);return _0x1fdac6[&#x27;join&#x27;](&#x27;&#x27;);&#125;,&#x27;parse&#x27;:function(_0x97f123)&#123;var _0x33ed13=_0x97f123[&#x27;length&#x27;],_0x1df8e0=this[&#x27;_map&#x27;],_0x2824b=this[&#x27;_reverseMap&#x27;];if(!_0x2824b)&#123;_0x2824b=this[&#x27;_reverseMap&#x27;]=[];for(var _0x4b24ef=0x0;_0x4b24ef&lt;_0x1df8e0[&#x27;length&#x27;];_0x4b24ef++)_0x2824b[_0x1df8e0[&#x27;charCodeAt&#x27;](_0x4b24ef)]=_0x4b24ef;&#125;var _0x2efd60=_0x1df8e0[&#x27;charAt&#x27;](0x40);if(_0x2efd60)&#123;var _0x208a98=_0x97f123[&#x27;indexOf&#x27;](_0x2efd60);-0x1!==_0x208a98&amp;&amp;(_0x33ed13=_0x208a98);&#125;return _0x437adf(_0x97f123,_0x33ed13,_0x2824b);&#125;,&#x27;_map&#x27;:&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;&#125;;function _0x437adf(_0x106e77,_0x45795b,_0x2e7899)&#123;for(var _0x5d4e4e=[],_0x4bb179=0x0,_0x35a3a1=0x0;_0x35a3a1&lt;_0x45795b;_0x35a3a1++)if(_0x35a3a1%0x4)&#123;var _0x4a3921=_0x2e7899[_0x106e77[&#x27;charCodeAt&#x27;](_0x35a3a1-0x1)]&lt;&lt;_0x35a3a1%0x4*0x2,_0x2d54a7=_0x2e7899[_0x106e77[&#x27;charCodeAt&#x27;](_0x35a3a1)]&gt;&gt;&gt;0x6-_0x35a3a1%0x4*0x2;_0x5d4e4e[_0x4bb179&gt;&gt;&gt;0x2]|=(_0x4a3921|_0x2d54a7)&lt;&lt;0x18-_0x4bb179%0x4*0x8,_0x4bb179++;&#125;return _0x59277d[&#x27;create&#x27;](_0x5d4e4e,_0x4bb179);&#125;&#125;(),_0x23416a[&#x27;enc&#x27;][&#x27;Base64&#x27;];&#125;));&#125;,1382:function(_0xfe3270,_0x37a6ce,_0x371ab5)&#123;(function(_0x55e563,_0x52322c,_0x236324)&#123;_0xfe3270[&#x27;exports&#x27;]=_0x52322c(_0x371ab5(&#x27;21bf&#x27;),_0x371ab5(&#x27;1132&#x27;),_0x371ab5(&#x27;72fe&#x27;),_0x371ab5(&#x27;2b79&#x27;),_0x371ab5(&#x27;38ba&#x27;));&#125;(0x0,function(_0x23e79f)&#123;return function()&#123;var _0x34275c=_0x23e79f,_0x812fb0=_0x34275c[&#x27;lib&#x27;],_0x4f5b23=_0x812fb0[&#x27;StreamCipher&#x27;],_0xd4784a=_0x34275c[&#x27;algo&#x27;],_0x547adb=[],_0x214ba0=[],_0x5ce89d=[],_0x5280ea=_0xd4784a[&#x27;Rabbit&#x27;]=_0x4f5b23[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;for(var _0x28f4c7=this[&#x27;_key&#x27;][&#x27;words&#x27;],_0x1cfa70=this[&#x27;cfg&#x27;][&#x27;iv&#x27;],_0x2bfc47=0x0;_0x2bfc47&lt;0x4;_0x2bfc47++)_0x28f4c7[_0x2bfc47]=0xff00ff&amp;(_0x28f4c7[_0x2bfc47]&lt;&lt;0x8|_0x28f4c7[_0x2bfc47]&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x28f4c7[_0x2bfc47]&lt;&lt;0x18|_0x28f4c7[_0x2bfc47]&gt;&gt;&gt;0x8);var _0x3a3f4a=this[&#x27;_X&#x27;]=[_0x28f4c7[0x0],_0x28f4c7[0x3]&lt;&lt;0x10|_0x28f4c7[0x2]&gt;&gt;&gt;0x10,_0x28f4c7[0x1],_0x28f4c7[0x0]&lt;&lt;0x10|_0x28f4c7[0x3]&gt;&gt;&gt;0x10,_0x28f4c7[0x2],_0x28f4c7[0x1]&lt;&lt;0x10|_0x28f4c7[0x0]&gt;&gt;&gt;0x10,_0x28f4c7[0x3],_0x28f4c7[0x2]&lt;&lt;0x10|_0x28f4c7[0x1]&gt;&gt;&gt;0x10],_0x2f2ac4=this[&#x27;_C&#x27;]=[_0x28f4c7[0x2]&lt;&lt;0x10|_0x28f4c7[0x2]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x28f4c7[0x0]|0xffff&amp;_0x28f4c7[0x1],_0x28f4c7[0x3]&lt;&lt;0x10|_0x28f4c7[0x3]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x28f4c7[0x1]|0xffff&amp;_0x28f4c7[0x2],_0x28f4c7[0x0]&lt;&lt;0x10|_0x28f4c7[0x0]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x28f4c7[0x2]|0xffff&amp;_0x28f4c7[0x3],_0x28f4c7[0x1]&lt;&lt;0x10|_0x28f4c7[0x1]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x28f4c7[0x3]|0xffff&amp;_0x28f4c7[0x0]];this[&#x27;_b&#x27;]=0x0;for(_0x2bfc47=0x0;_0x2bfc47&lt;0x4;_0x2bfc47++)_0x22ee51[&#x27;call&#x27;](this);for(_0x2bfc47=0x0;_0x2bfc47&lt;0x8;_0x2bfc47++)_0x2f2ac4[_0x2bfc47]^=_0x3a3f4a[_0x2bfc47+0x4&amp;0x7];if(_0x1cfa70)&#123;var _0x56883a=_0x1cfa70[&#x27;words&#x27;],_0x28f8f8=_0x56883a[0x0],_0x275a5f=_0x56883a[0x1],_0xc7d441=0xff00ff&amp;(_0x28f8f8&lt;&lt;0x8|_0x28f8f8&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x28f8f8&lt;&lt;0x18|_0x28f8f8&gt;&gt;&gt;0x8),_0x250a69=0xff00ff&amp;(_0x275a5f&lt;&lt;0x8|_0x275a5f&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x275a5f&lt;&lt;0x18|_0x275a5f&gt;&gt;&gt;0x8),_0x4750be=_0xc7d441&gt;&gt;&gt;0x10|0xffff0000&amp;_0x250a69,_0x27db3c=_0x250a69&lt;&lt;0x10|0xffff&amp;_0xc7d441;_0x2f2ac4[0x0]^=_0xc7d441,_0x2f2ac4[0x1]^=_0x4750be,_0x2f2ac4[0x2]^=_0x250a69,_0x2f2ac4[0x3]^=_0x27db3c,_0x2f2ac4[0x4]^=_0xc7d441,_0x2f2ac4[0x5]^=_0x4750be,_0x2f2ac4[0x6]^=_0x250a69,_0x2f2ac4[0x7]^=_0x27db3c;for(_0x2bfc47=0x0;_0x2bfc47&lt;0x4;_0x2bfc47++)_0x22ee51[&#x27;call&#x27;](this);&#125;&#125;,&#x27;_doProcessBlock&#x27;:function(_0x4cb1ad,_0x37871e)&#123;var _0x50a328=this[&#x27;_X&#x27;];_0x22ee51[&#x27;call&#x27;](this),_0x547adb[0x0]=_0x50a328[0x0]^_0x50a328[0x5]&gt;&gt;&gt;0x10^_0x50a328[0x3]&lt;&lt;0x10,_0x547adb[0x1]=_0x50a328[0x2]^_0x50a328[0x7]&gt;&gt;&gt;0x10^_0x50a328[0x5]&lt;&lt;0x10,_0x547adb[0x2]=_0x50a328[0x4]^_0x50a328[0x1]&gt;&gt;&gt;0x10^_0x50a328[0x7]&lt;&lt;0x10,_0x547adb[0x3]=_0x50a328[0x6]^_0x50a328[0x3]&gt;&gt;&gt;0x10^_0x50a328[0x1]&lt;&lt;0x10;for(var _0x17af74=0x0;_0x17af74&lt;0x4;_0x17af74++)_0x547adb[_0x17af74]=0xff00ff&amp;(_0x547adb[_0x17af74]&lt;&lt;0x8|_0x547adb[_0x17af74]&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x547adb[_0x17af74]&lt;&lt;0x18|_0x547adb[_0x17af74]&gt;&gt;&gt;0x8),_0x4cb1ad[_0x37871e+_0x17af74]^=_0x547adb[_0x17af74];&#125;,&#x27;blockSize&#x27;:0x4,&#x27;ivSize&#x27;:0x2&#125;);function _0x22ee51()&#123;for(var _0x17ee36=this[&#x27;_X&#x27;],_0x10dd54=this[&#x27;_C&#x27;],_0x2d7bd6=0x0;_0x2d7bd6&lt;0x8;_0x2d7bd6++)_0x214ba0[_0x2d7bd6]=_0x10dd54[_0x2d7bd6];_0x10dd54[0x0]=_0x10dd54[0x0]+0x4d34d34d+this[&#x27;_b&#x27;]|0x0,_0x10dd54[0x1]=_0x10dd54[0x1]+0xd34d34d3+(_0x10dd54[0x0]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x0]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x2]=_0x10dd54[0x2]+0x34d34d34+(_0x10dd54[0x1]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x1]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x3]=_0x10dd54[0x3]+0x4d34d34d+(_0x10dd54[0x2]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x2]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x4]=_0x10dd54[0x4]+0xd34d34d3+(_0x10dd54[0x3]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x3]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x5]=_0x10dd54[0x5]+0x34d34d34+(_0x10dd54[0x4]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x4]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x6]=_0x10dd54[0x6]+0x4d34d34d+(_0x10dd54[0x5]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x5]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x10dd54[0x7]=_0x10dd54[0x7]+0xd34d34d3+(_0x10dd54[0x6]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x6]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,this[&#x27;_b&#x27;]=_0x10dd54[0x7]&gt;&gt;&gt;0x0&lt;_0x214ba0[0x7]&gt;&gt;&gt;0x0?0x1:0x0;for(_0x2d7bd6=0x0;_0x2d7bd6&lt;0x8;_0x2d7bd6++)&#123;var _0x46d530=_0x17ee36[_0x2d7bd6]+_0x10dd54[_0x2d7bd6],_0x4e3135=0xffff&amp;_0x46d530,_0x3a0cfc=_0x46d530&gt;&gt;&gt;0x10,_0x555553=((_0x4e3135*_0x4e3135&gt;&gt;&gt;0x11)+_0x4e3135*_0x3a0cfc&gt;&gt;&gt;0xf)+_0x3a0cfc*_0x3a0cfc,_0x4f504e=((0xffff0000&amp;_0x46d530)*_0x46d530|0x0)+((0xffff&amp;_0x46d530)*_0x46d530|0x0);_0x5ce89d[_0x2d7bd6]=_0x555553^_0x4f504e;&#125;_0x17ee36[0x0]=_0x5ce89d[0x0]+(_0x5ce89d[0x7]&lt;&lt;0x10|_0x5ce89d[0x7]&gt;&gt;&gt;0x10)+(_0x5ce89d[0x6]&lt;&lt;0x10|_0x5ce89d[0x6]&gt;&gt;&gt;0x10)|0x0,_0x17ee36[0x1]=_0x5ce89d[0x1]+(_0x5ce89d[0x0]&lt;&lt;0x8|_0x5ce89d[0x0]&gt;&gt;&gt;0x18)+_0x5ce89d[0x7]|0x0,_0x17ee36[0x2]=_0x5ce89d[0x2]+(_0x5ce89d[0x1]&lt;&lt;0x10|_0x5ce89d[0x1]&gt;&gt;&gt;0x10)+(_0x5ce89d[0x0]&lt;&lt;0x10|_0x5ce89d[0x0]&gt;&gt;&gt;0x10)|0x0,_0x17ee36[0x3]=_0x5ce89d[0x3]+(_0x5ce89d[0x2]&lt;&lt;0x8|_0x5ce89d[0x2]&gt;&gt;&gt;0x18)+_0x5ce89d[0x1]|0x0,_0x17ee36[0x4]=_0x5ce89d[0x4]+(_0x5ce89d[0x3]&lt;&lt;0x10|_0x5ce89d[0x3]&gt;&gt;&gt;0x10)+(_0x5ce89d[0x2]&lt;&lt;0x10|_0x5ce89d[0x2]&gt;&gt;&gt;0x10)|0x0,_0x17ee36[0x5]=_0x5ce89d[0x5]+(_0x5ce89d[0x4]&lt;&lt;0x8|_0x5ce89d[0x4]&gt;&gt;&gt;0x18)+_0x5ce89d[0x3]|0x0,_0x17ee36[0x6]=_0x5ce89d[0x6]+(_0x5ce89d[0x5]&lt;&lt;0x10|_0x5ce89d[0x5]&gt;&gt;&gt;0x10)+(_0x5ce89d[0x4]&lt;&lt;0x10|_0x5ce89d[0x4]&gt;&gt;&gt;0x10)|0x0,_0x17ee36[0x7]=_0x5ce89d[0x7]+(_0x5ce89d[0x6]&lt;&lt;0x8|_0x5ce89d[0x6]&gt;&gt;&gt;0x18)+_0x5ce89d[0x5]|0x0;&#125;_0x34275c[&#x27;Rabbit&#x27;]=_0x4f5b23[&#x27;_createHelper&#x27;](_0x5280ea);&#125;(),_0x23e79f[&#x27;Rabbit&#x27;];&#125;));&#125;,&#x27;17e1&#x27;:function(_0x3268dc,_0x4d21fb,_0x39e59e)&#123;(function(_0x17fcdb,_0x418a42)&#123;_0x3268dc[&#x27;exports&#x27;]=_0x418a42(_0x39e59e(&#x27;21bf&#x27;));&#125;(0x0,function(_0x3074a2)&#123;return function()&#123;if(&#x27;function&#x27;==typeof ArrayBuffer)&#123;var _0x21b957=_0x3074a2,_0x1fb359=_0x21b957[&#x27;lib&#x27;],_0x54d19c=_0x1fb359[&#x27;WordArray&#x27;],_0x4cf988=_0x54d19c[&#x27;init&#x27;],_0x421eba=_0x54d19c[&#x27;init&#x27;]=function(_0x18949c)&#123;if(_0x18949c instanceof ArrayBuffer&amp;&amp;(_0x18949c=new Uint8Array(_0x18949c)),(_0x18949c instanceof Int8Array||&#x27;undefined&#x27;!==typeof Uint8ClampedArray&amp;&amp;_0x18949c instanceof Uint8ClampedArray||_0x18949c instanceof Int16Array||_0x18949c instanceof Uint16Array||_0x18949c instanceof Int32Array||_0x18949c instanceof Uint32Array||_0x18949c instanceof Float32Array||_0x18949c instanceof Float64Array)&amp;&amp;(_0x18949c=new Uint8Array(_0x18949c[&#x27;buffer&#x27;],_0x18949c[&#x27;byteOffset&#x27;],_0x18949c[&#x27;byteLength&#x27;])),_0x18949c instanceof Uint8Array)&#123;for(var _0x50f5de=_0x18949c[&#x27;byteLength&#x27;],_0x2b4fcf=[],_0x1cae2b=0x0;_0x1cae2b&lt;_0x50f5de;_0x1cae2b++)_0x2b4fcf[_0x1cae2b&gt;&gt;&gt;0x2]|=_0x18949c[_0x1cae2b]&lt;&lt;0x18-_0x1cae2b%0x4*0x8;_0x4cf988[&#x27;call&#x27;](this,_0x2b4fcf,_0x50f5de);&#125;else _0x4cf988[&#x27;apply&#x27;](this,arguments);&#125;;_0x421eba[&#x27;prototype&#x27;]=_0x54d19c;&#125;&#125;(),_0x3074a2[&#x27;lib&#x27;][&#x27;WordArray&#x27;];&#125;));&#125;,&#x27;191b&#x27;:function(_0x3a842d,_0x579ebd,_0x43b264)&#123;(function(_0x498a81,_0x5f2259,_0x569dc4)&#123;_0x3a842d[&#x27;exports&#x27;]=_0x5f2259(_0x43b264(&#x27;21bf&#x27;),_0x43b264(&#x27;94f8&#x27;));&#125;(0x0,function(_0x327fe6)&#123;return function()&#123;var _0x55605d=_0x327fe6,_0x35294f=_0x55605d[&#x27;lib&#x27;],_0x6cb577=_0x35294f[&#x27;WordArray&#x27;],_0x125864=_0x55605d[&#x27;algo&#x27;],_0x4e2279=_0x125864[&#x27;SHA256&#x27;],_0x19d55e=_0x125864[&#x27;SHA224&#x27;]=_0x4e2279[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x6cb577[&#x27;init&#x27;]([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]);&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x30b122=_0x4e2279[&#x27;_doFinalize&#x27;][&#x27;call&#x27;](this);return _0x30b122[&#x27;sigBytes&#x27;]-=0x4,_0x30b122;&#125;&#125;);_0x55605d[&#x27;SHA224&#x27;]=_0x4e2279[&#x27;_createHelper&#x27;](_0x19d55e),_0x55605d[&#x27;HmacSHA224&#x27;]=_0x4e2279[&#x27;_createHmacHelper&#x27;](_0x19d55e);&#125;(),_0x327fe6[&#x27;SHA224&#x27;];&#125;));&#125;,&#x27;21bf&#x27;:function(_0x1ea449,_0x376d84,_0x5d1328)&#123;(function(_0x374b0a,_0x3d0fcf)&#123;_0x1ea449[&#x27;exports&#x27;]=_0x3d0fcf();&#125;(0x0,function()&#123;var _0x2458a9=_0x2458a9||function(_0x5f1119,_0x592896)&#123;var _0x970d98=Object[&#x27;create&#x27;]||function()&#123;function _0x24a196()&#123;&#125;return function(_0x47e06a)&#123;var _0x12d2e9;return _0x24a196[&#x27;prototype&#x27;]=_0x47e06a,_0x12d2e9=new _0x24a196(),_0x24a196[&#x27;prototype&#x27;]=null,_0x12d2e9;&#125;;&#125;(),_0x42035f=&#123;&#125;,_0x139bed=_0x42035f[&#x27;lib&#x27;]=&#123;&#125;,_0x21e0fe=_0x139bed[&#x27;Base&#x27;]=function()&#123;return&#123;&#x27;extend&#x27;:function(_0x3a0ad5)&#123;var _0x30e853=_0x970d98(this);return _0x3a0ad5&amp;&amp;_0x30e853[&#x27;mixIn&#x27;](_0x3a0ad5),_0x30e853[&#x27;hasOwnProperty&#x27;](&#x27;init&#x27;)&amp;&amp;this[&#x27;init&#x27;]!==_0x30e853[&#x27;init&#x27;]||(_0x30e853[&#x27;init&#x27;]=function()&#123;_0x30e853[&#x27;$super&#x27;][&#x27;init&#x27;][&#x27;apply&#x27;](this,arguments);&#125;),_0x30e853[&#x27;init&#x27;][&#x27;prototype&#x27;]=_0x30e853,_0x30e853[&#x27;$super&#x27;]=this,_0x30e853;&#125;,&#x27;create&#x27;:function()&#123;var _0x1cdcfb=this[&#x27;extend&#x27;]();return _0x1cdcfb[&#x27;init&#x27;][&#x27;apply&#x27;](_0x1cdcfb,arguments),_0x1cdcfb;&#125;,&#x27;init&#x27;:function()&#123;&#125;,&#x27;mixIn&#x27;:function(_0x50a7ef)&#123;for(var _0x3ea751 in _0x50a7ef)_0x50a7ef[&#x27;hasOwnProperty&#x27;](_0x3ea751)&amp;&amp;(this[_0x3ea751]=_0x50a7ef[_0x3ea751]);_0x50a7ef[&#x27;hasOwnProperty&#x27;](&#x27;toString&#x27;)&amp;&amp;(this[&#x27;toString&#x27;]=_0x50a7ef[&#x27;toString&#x27;]);&#125;,&#x27;clone&#x27;:function()&#123;return this[&#x27;init&#x27;][&#x27;prototype&#x27;][&#x27;extend&#x27;](this);&#125;&#125;;&#125;(),_0x4c95df=_0x139bed[&#x27;WordArray&#x27;]=_0x21e0fe[&#x27;extend&#x27;](&#123;&#x27;init&#x27;:function(_0x38f8c9,_0x3c3cde)&#123;_0x38f8c9=this[&#x27;words&#x27;]=_0x38f8c9||[],this[&#x27;sigBytes&#x27;]=_0x3c3cde!=_0x592896?_0x3c3cde:0x4*_0x38f8c9[&#x27;length&#x27;];&#125;,&#x27;toString&#x27;:function(_0x466cc7)&#123;return(_0x466cc7||_0x4fb3bf)[&#x27;stringify&#x27;](this);&#125;,&#x27;concat&#x27;:function(_0x16aebe)&#123;var _0x361552=this[&#x27;words&#x27;],_0x3bebb4=_0x16aebe[&#x27;words&#x27;],_0x9d2e2a=this[&#x27;sigBytes&#x27;],_0x122646=_0x16aebe[&#x27;sigBytes&#x27;];if(this[&#x27;clamp&#x27;](),_0x9d2e2a%0x4)for(var _0x4f2b63=0x0;_0x4f2b63&lt;_0x122646;_0x4f2b63++)&#123;var _0x1e3f63=_0x3bebb4[_0x4f2b63&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x4f2b63%0x4*0x8&amp;0xff;_0x361552[_0x9d2e2a+_0x4f2b63&gt;&gt;&gt;0x2]|=_0x1e3f63&lt;&lt;0x18-(_0x9d2e2a+_0x4f2b63)%0x4*0x8;&#125;else for(_0x4f2b63=0x0;_0x4f2b63&lt;_0x122646;_0x4f2b63+=0x4)_0x361552[_0x9d2e2a+_0x4f2b63&gt;&gt;&gt;0x2]=_0x3bebb4[_0x4f2b63&gt;&gt;&gt;0x2];return this[&#x27;sigBytes&#x27;]+=_0x122646,this;&#125;,&#x27;clamp&#x27;:function()&#123;var _0x1699cc=this[&#x27;words&#x27;],_0x262fbe=this[&#x27;sigBytes&#x27;];_0x1699cc[_0x262fbe&gt;&gt;&gt;0x2]&amp;=0xffffffff&lt;&lt;0x20-_0x262fbe%0x4*0x8,_0x1699cc[&#x27;length&#x27;]=_0x5f1119[&#x27;ceil&#x27;](_0x262fbe/0x4);&#125;,&#x27;clone&#x27;:function()&#123;var _0x677697=_0x21e0fe[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x677697[&#x27;words&#x27;]=this[&#x27;words&#x27;][&#x27;slice&#x27;](0x0),_0x677697;&#125;,&#x27;random&#x27;:function(_0x239f1b)&#123;for(var _0x108788,_0x8079d7=[],_0x3bec18=function(_0x4d234e)&#123;_0x4d234e=_0x4d234e;var _0x2dca1f=0x3ade68b1,_0x49ee04=0xffffffff;return function()&#123;_0x2dca1f=0x9069*(0xffff&amp;_0x2dca1f)+(_0x2dca1f&gt;&gt;0x10)&amp;_0x49ee04,_0x4d234e=0x4650*(0xffff&amp;_0x4d234e)+(_0x4d234e&gt;&gt;0x10)&amp;_0x49ee04;var _0x1e24f8=(_0x2dca1f&lt;&lt;0x10)+_0x4d234e&amp;_0x49ee04;return _0x1e24f8/=0x100000000,_0x1e24f8+=0.5,_0x1e24f8*(_0x5f1119[&#x27;random&#x27;]()&gt;0.5?0x1:-0x1);&#125;;&#125;,_0xa4f411=0x0;_0xa4f411&lt;_0x239f1b;_0xa4f411+=0x4)&#123;var _0x1469ac=_0x3bec18(0x100000000*(_0x108788||_0x5f1119[&#x27;random&#x27;]()));_0x108788=0x3ade67b7*_0x1469ac(),_0x8079d7[&#x27;push&#x27;](0x100000000*_0x1469ac()|0x0);&#125;return new _0x4c95df[&#x27;init&#x27;](_0x8079d7,_0x239f1b);&#125;&#125;),_0x3d0c70=_0x42035f[&#x27;enc&#x27;]=&#123;&#125;,_0x4fb3bf=_0x3d0c70[&#x27;Hex&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x1e1ac6)&#123;for(var _0xed1d96=_0x1e1ac6[&#x27;words&#x27;],_0x261fc7=_0x1e1ac6[&#x27;sigBytes&#x27;],_0x25fa39=[],_0x5c53ae=0x0;_0x5c53ae&lt;_0x261fc7;_0x5c53ae++)&#123;var _0x42cb9a=_0xed1d96[_0x5c53ae&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x5c53ae%0x4*0x8&amp;0xff;_0x25fa39[&#x27;push&#x27;]((_0x42cb9a&gt;&gt;&gt;0x4)[&#x27;toString&#x27;](0x10)),_0x25fa39[&#x27;push&#x27;]((0xf&amp;_0x42cb9a)[&#x27;toString&#x27;](0x10));&#125;return _0x25fa39[&#x27;join&#x27;](&#x27;&#x27;);&#125;,&#x27;parse&#x27;:function(_0x3f70e9)&#123;for(var _0x936207=_0x3f70e9[&#x27;length&#x27;],_0xfbc904=[],_0x5089ce=0x0;_0x5089ce&lt;_0x936207;_0x5089ce+=0x2)_0xfbc904[_0x5089ce&gt;&gt;&gt;0x3]|=parseInt(_0x3f70e9[&#x27;substr&#x27;](_0x5089ce,0x2),0x10)&lt;&lt;0x18-_0x5089ce%0x8*0x4;return new _0x4c95df[&#x27;init&#x27;](_0xfbc904,_0x936207/0x2);&#125;&#125;,_0x4c247c=_0x3d0c70[&#x27;Latin1&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x2ffd1c)&#123;for(var _0x40f9f4=_0x2ffd1c[&#x27;words&#x27;],_0x459356=_0x2ffd1c[&#x27;sigBytes&#x27;],_0x2f2d54=[],_0x10579d=0x0;_0x10579d&lt;_0x459356;_0x10579d++)&#123;var _0x92f8b1=_0x40f9f4[_0x10579d&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x10579d%0x4*0x8&amp;0xff;_0x2f2d54[&#x27;push&#x27;](String[&#x27;fromCharCode&#x27;](_0x92f8b1));&#125;return _0x2f2d54[&#x27;join&#x27;](&#x27;&#x27;);&#125;,&#x27;parse&#x27;:function(_0x5cf7f1)&#123;for(var _0x41bd9f=_0x5cf7f1[&#x27;length&#x27;],_0x2d0ca7=[],_0x427403=0x0;_0x427403&lt;_0x41bd9f;_0x427403++)_0x2d0ca7[_0x427403&gt;&gt;&gt;0x2]|=(0xff&amp;_0x5cf7f1[&#x27;charCodeAt&#x27;](_0x427403))&lt;&lt;0x18-_0x427403%0x4*0x8;return new _0x4c95df[&#x27;init&#x27;](_0x2d0ca7,_0x41bd9f);&#125;&#125;,_0x5d2772=_0x3d0c70[&#x27;Utf8&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x31c39d)&#123;try&#123;return decodeURIComponent(escape(_0x4c247c[&#x27;stringify&#x27;](_0x31c39d)));&#125;catch(_0x628581)&#123;throw new Error(&#x27;Malformed\x20UTF-8\x20data&#x27;);&#125;&#125;,&#x27;parse&#x27;:function(_0x3b1921)&#123;return _0x4c247c[&#x27;parse&#x27;](unescape(encodeURIComponent(_0x3b1921)));&#125;&#125;,_0x1f2d5e=_0x139bed[&#x27;BufferedBlockAlgorithm&#x27;]=_0x21e0fe[&#x27;extend&#x27;](&#123;&#x27;reset&#x27;:function()&#123;this[&#x27;_data&#x27;]=new _0x4c95df[&#x27;init&#x27;](),this[&#x27;_nDataBytes&#x27;]=0x0;&#125;,&#x27;_append&#x27;:function(_0x386fa2)&#123;&#x27;string&#x27;==typeof _0x386fa2&amp;&amp;(_0x386fa2=_0x5d2772[&#x27;parse&#x27;](_0x386fa2)),this[&#x27;_data&#x27;][&#x27;concat&#x27;](_0x386fa2),this[&#x27;_nDataBytes&#x27;]+=_0x386fa2[&#x27;sigBytes&#x27;];&#125;,&#x27;_process&#x27;:function(_0x5a85e2)&#123;var _0x24b14e=this[&#x27;_data&#x27;],_0x411856=_0x24b14e[&#x27;words&#x27;],_0xf6d078=_0x24b14e[&#x27;sigBytes&#x27;],_0x4f0cfc=this[&#x27;blockSize&#x27;],_0x18e951=0x4*_0x4f0cfc,_0x4de16e=_0xf6d078/_0x18e951;_0x4de16e=_0x5a85e2?_0x5f1119[&#x27;ceil&#x27;](_0x4de16e):_0x5f1119[&#x27;max&#x27;]((0x0|_0x4de16e)-this[&#x27;_minBufferSize&#x27;],0x0);var _0x229cc1=_0x4de16e*_0x4f0cfc,_0xb08f1=_0x5f1119[&#x27;min&#x27;](0x4*_0x229cc1,_0xf6d078);if(_0x229cc1)&#123;for(var _0x2be887=0x0;_0x2be887&lt;_0x229cc1;_0x2be887+=_0x4f0cfc)this[&#x27;_doProcessBlock&#x27;](_0x411856,_0x2be887);var _0xf15233=_0x411856[&#x27;splice&#x27;](0x0,_0x229cc1);_0x24b14e[&#x27;sigBytes&#x27;]-=_0xb08f1;&#125;return new _0x4c95df[&#x27;init&#x27;](_0xf15233,_0xb08f1);&#125;,&#x27;clone&#x27;:function()&#123;var _0x3adda4=_0x21e0fe[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x3adda4[&#x27;_data&#x27;]=this[&#x27;_data&#x27;][&#x27;clone&#x27;](),_0x3adda4;&#125;,&#x27;_minBufferSize&#x27;:0x0&#125;),_0x2cbd18=(_0x139bed[&#x27;Hasher&#x27;]=_0x1f2d5e[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x21e0fe[&#x27;extend&#x27;](),&#x27;init&#x27;:function(_0x190147)&#123;this[&#x27;cfg&#x27;]=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x190147),this[&#x27;reset&#x27;]();&#125;,&#x27;reset&#x27;:function()&#123;_0x1f2d5e[&#x27;reset&#x27;][&#x27;call&#x27;](this),this[&#x27;_doReset&#x27;]();&#125;,&#x27;update&#x27;:function(_0x3fd071)&#123;return this[&#x27;_append&#x27;](_0x3fd071),this[&#x27;_process&#x27;](),this;&#125;,&#x27;finalize&#x27;:function(_0xcbc8c9)&#123;_0xcbc8c9&amp;&amp;this[&#x27;_append&#x27;](_0xcbc8c9);var _0x5b1b52=this[&#x27;_doFinalize&#x27;]();return _0x5b1b52;&#125;,&#x27;blockSize&#x27;:0x10,&#x27;_createHelper&#x27;:function(_0x46bc23)&#123;return function(_0x343681,_0x3360f2)&#123;return new _0x46bc23[&#x27;init&#x27;](_0x3360f2)[&#x27;finalize&#x27;](_0x343681);&#125;;&#125;,&#x27;_createHmacHelper&#x27;:function(_0x4b8fca)&#123;return function(_0x9a6df9,_0x517c5f)&#123;return new _0x2cbd18[&#x27;HMAC&#x27;][&#x27;init&#x27;](_0x4b8fca,_0x517c5f)[&#x27;finalize&#x27;](_0x9a6df9);&#125;;&#125;&#125;),_0x42035f[&#x27;algo&#x27;]=&#123;&#125;);return _0x42035f;&#125;(Math);return _0x2458a9;&#125;));&#125;,&#x27;27ae&#x27;:function(_0x2bdb8a,_0x349d42,_0x247eec)&#123;(function(_0x4ce9f1)&#123;var _0x3c6e10,_0xf71c54;(function(_0x1d5472,_0x20a839)&#123;_0x2bdb8a[&#x27;exports&#x27;]=_0x20a839(_0x1d5472);&#125;(&#x27;undefined&#x27;!==typeof self?self:&#x27;undefined&#x27;!==typeof window?window:&#x27;undefined&#x27;!==typeof _0x4ce9f1?_0x4ce9f1:this,function(_0x2931cf)&#123;&#x27;use strict&#x27;;_0x2931cf=_0x2931cf||&#123;&#125;;var _0x3fa917=_0x2931cf[&#x27;Base64&#x27;],_0xc3df37=&#x27;2.5.1&#x27;,_0x17926;if(_0x2bdb8a[&#x27;exports&#x27;])try&#123;_0x17926=eval(&#x27;require(\&#x27;buffer\&#x27;)[\&#x27;Buffer\&#x27;];&#x27;);&#125;catch(_0x32f0f2)&#123;_0x17926=void 0x0;&#125;var _0x417579=&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;,_0x4298d9=function(_0x4640e6)&#123;for(var _0x38803b=&#123;&#125;,_0x1c5d9f=0x0,_0x5e1277=_0x4640e6[&#x27;length&#x27;];_0x1c5d9f&lt;_0x5e1277;_0x1c5d9f++)_0x38803b[_0x4640e6[&#x27;charAt&#x27;](_0x1c5d9f)]=_0x1c5d9f;return _0x38803b;&#125;(_0x417579),_0x3139f6=String[&#x27;fromCharCode&#x27;],_0x2eaa23=function(_0x4df29c)&#123;if(_0x4df29c[&#x27;length&#x27;]&lt;0x2)&#123;var _0x560718=_0x4df29c[&#x27;charCodeAt&#x27;](0x0);return _0x560718&lt;0x80?_0x4df29c:_0x560718&lt;0x800?_0x3139f6(0xc0|_0x560718&gt;&gt;&gt;0x6)+_0x3139f6(0x80|0x3f&amp;_0x560718):_0x3139f6(0xe0|_0x560718&gt;&gt;&gt;0xc&amp;0xf)+_0x3139f6(0x80|_0x560718&gt;&gt;&gt;0x6&amp;0x3f)+_0x3139f6(0x80|0x3f&amp;_0x560718);&#125;_0x560718=0x10000+0x400*(_0x4df29c[&#x27;charCodeAt&#x27;](0x0)-0xd800)+(_0x4df29c[&#x27;charCodeAt&#x27;](0x1)-0xdc00);return _0x3139f6(0xf0|_0x560718&gt;&gt;&gt;0x12&amp;0x7)+_0x3139f6(0x80|_0x560718&gt;&gt;&gt;0xc&amp;0x3f)+_0x3139f6(0x80|_0x560718&gt;&gt;&gt;0x6&amp;0x3f)+_0x3139f6(0x80|0x3f&amp;_0x560718);&#125;,_0x1c5ffc=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_0x5d413d=function(_0x5bada1)&#123;return _0x5bada1[&#x27;replace&#x27;](_0x1c5ffc,_0x2eaa23);&#125;,_0x3891cc=function(_0x1f0b19)&#123;var _0x520b1f=[0x0,0x2,0x1][_0x1f0b19[&#x27;length&#x27;]%0x3],_0x5a8abb=_0x1f0b19[&#x27;charCodeAt&#x27;](0x0)&lt;&lt;0x10|(_0x1f0b19[&#x27;length&#x27;]&gt;0x1?_0x1f0b19[&#x27;charCodeAt&#x27;](0x1):0x0)&lt;&lt;0x8|(_0x1f0b19[&#x27;length&#x27;]&gt;0x2?_0x1f0b19[&#x27;charCodeAt&#x27;](0x2):0x0),_0x29494c=[_0x417579[&#x27;charAt&#x27;](_0x5a8abb&gt;&gt;&gt;0x12),_0x417579[&#x27;charAt&#x27;](_0x5a8abb&gt;&gt;&gt;0xc&amp;0x3f),_0x520b1f&gt;=0x2?&#x27;=&#x27;:_0x417579[&#x27;charAt&#x27;](_0x5a8abb&gt;&gt;&gt;0x6&amp;0x3f),_0x520b1f&gt;=0x1?&#x27;=&#x27;:_0x417579[&#x27;charAt&#x27;](0x3f&amp;_0x5a8abb)];return _0x29494c[&#x27;join&#x27;](&#x27;&#x27;);&#125;,_0x243a2c=_0x2931cf[&#x27;btoa&#x27;]?function(_0x17bb1d)&#123;return _0x2931cf[&#x27;btoa&#x27;](_0x17bb1d);&#125;:function(_0x4f379c)&#123;return _0x4f379c[&#x27;replace&#x27;](/[\s\S]&#123;1,3&#125;/g,_0x3891cc);&#125;,_0x3b6a4b=_0x17926?_0x17926[&#x27;from&#x27;]&amp;&amp;Uint8Array&amp;&amp;_0x17926[&#x27;from&#x27;]!==Uint8Array[&#x27;from&#x27;]?function(_0x5ab6f7)&#123;return(_0x5ab6f7[&#x27;constructor&#x27;]===_0x17926[&#x27;constructor&#x27;]?_0x5ab6f7:_0x17926[&#x27;from&#x27;](_0x5ab6f7))[&#x27;toString&#x27;](&#x27;base64&#x27;);&#125;:function(_0x6dece9)&#123;return(_0x6dece9[&#x27;constructor&#x27;]===_0x17926[&#x27;constructor&#x27;]?_0x6dece9:new _0x17926(_0x6dece9))[&#x27;toString&#x27;](&#x27;base64&#x27;);&#125;:function(_0x3d0c02)&#123;return _0x243a2c(_0x5d413d(_0x3d0c02));&#125;,_0x45ae25=function(_0x53d700,_0x4a7a4c)&#123;return _0x4a7a4c?_0x3b6a4b(String(_0x53d700))[&#x27;replace&#x27;](/[+\/]/g,function(_0x4f1724)&#123;return&#x27;+&#x27;==_0x4f1724?&#x27;-&#x27;:&#x27;_&#x27;;&#125;)[&#x27;replace&#x27;](/=/g,&#x27;&#x27;):_0x3b6a4b(String(_0x53d700));&#125;,_0x3a12d2=function(_0xe66ff)&#123;return _0x45ae25(_0xe66ff,!0x0);&#125;,_0x2f4f92=new RegExp([&#x27;[À-ß][-¿]&#x27;,&#x27;[à-ï][-¿]&#123;2&#125;&#x27;,&#x27;[ð-÷][-¿]&#123;3&#125;&#x27;][&#x27;join&#x27;](&#x27;|&#x27;),&#x27;g&#x27;),_0x2127af=function(_0x66c788)&#123;switch(_0x66c788[&#x27;length&#x27;])&#123;case 0x4:var _0x19dbbd=(0x7&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x0))&lt;&lt;0x12|(0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x1))&lt;&lt;0xc|(0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x2))&lt;&lt;0x6|0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x3),_0x5c417e=_0x19dbbd-0x10000;return _0x3139f6(0xd800+(_0x5c417e&gt;&gt;&gt;0xa))+_0x3139f6(0xdc00+(0x3ff&amp;_0x5c417e));case 0x3:return _0x3139f6((0xf&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x0))&lt;&lt;0xc|(0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x1))&lt;&lt;0x6|0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x2));default:return _0x3139f6((0x1f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x0))&lt;&lt;0x6|0x3f&amp;_0x66c788[&#x27;charCodeAt&#x27;](0x1));&#125;&#125;,_0x37c71a=function(_0x3fd6c3)&#123;return _0x3fd6c3[&#x27;replace&#x27;](_0x2f4f92,_0x2127af);&#125;,_0x5dc711=function(_0x5c61cc)&#123;var _0xe9e513=_0x5c61cc[&#x27;length&#x27;],_0x122bf0=_0xe9e513%0x4,_0x5a1765=(_0xe9e513&gt;0x0?_0x4298d9[_0x5c61cc[&#x27;charAt&#x27;](0x0)]&lt;&lt;0x12:0x0)|(_0xe9e513&gt;0x1?_0x4298d9[_0x5c61cc[&#x27;charAt&#x27;](0x1)]&lt;&lt;0xc:0x0)|(_0xe9e513&gt;0x2?_0x4298d9[_0x5c61cc[&#x27;charAt&#x27;](0x2)]&lt;&lt;0x6:0x0)|(_0xe9e513&gt;0x3?_0x4298d9[_0x5c61cc[&#x27;charAt&#x27;](0x3)]:0x0),_0xf6cf4=[_0x3139f6(_0x5a1765&gt;&gt;&gt;0x10),_0x3139f6(_0x5a1765&gt;&gt;&gt;0x8&amp;0xff),_0x3139f6(0xff&amp;_0x5a1765)];return _0xf6cf4[&#x27;length&#x27;]-=[0x0,0x0,0x2,0x1][_0x122bf0],_0xf6cf4[&#x27;join&#x27;](&#x27;&#x27;);&#125;,_0x34c4d2=_0x2931cf[&#x27;atob&#x27;]?function(_0x395d84)&#123;return _0x2931cf[&#x27;atob&#x27;](_0x395d84);&#125;:function(_0x4c9aa6)&#123;return _0x4c9aa6[&#x27;replace&#x27;](/\S&#123;1,4&#125;/g,_0x5dc711);&#125;,_0x4a25fc=function(_0x3f8057)&#123;return _0x34c4d2(String(_0x3f8057)[&#x27;replace&#x27;](/[^A-Za-z0-9\+\/]/g,&#x27;&#x27;));&#125;,_0x2586ba=_0x17926?_0x17926[&#x27;from&#x27;]&amp;&amp;Uint8Array&amp;&amp;_0x17926[&#x27;from&#x27;]!==Uint8Array[&#x27;from&#x27;]?function(_0x336dce)&#123;return(_0x336dce[&#x27;constructor&#x27;]===_0x17926[&#x27;constructor&#x27;]?_0x336dce:_0x17926[&#x27;from&#x27;](_0x336dce,&#x27;base64&#x27;))[&#x27;toString&#x27;]();&#125;:function(_0x29eef9)&#123;return(_0x29eef9[&#x27;constructor&#x27;]===_0x17926[&#x27;constructor&#x27;]?_0x29eef9:new _0x17926(_0x29eef9,&#x27;base64&#x27;))[&#x27;toString&#x27;]();&#125;:function(_0x4cee3c)&#123;return _0x37c71a(_0x34c4d2(_0x4cee3c));&#125;,_0x219a63=function(_0x410f37)&#123;return _0x2586ba(String(_0x410f37)[&#x27;replace&#x27;](/[-_]/g,function(_0x2ab17b)&#123;return&#x27;-&#x27;==_0x2ab17b?&#x27;+&#x27;:&#x27;/&#x27;;&#125;)[&#x27;replace&#x27;](/[^A-Za-z0-9\+\/]/g,&#x27;&#x27;));&#125;,_0x3c9d66=function()&#123;var _0x57d2fc=_0x2931cf[&#x27;Base64&#x27;];return _0x2931cf[&#x27;Base64&#x27;]=_0x3fa917,_0x57d2fc;&#125;;if(_0x2931cf[&#x27;Base64&#x27;]=&#123;&#x27;VERSION&#x27;:_0xc3df37,&#x27;atob&#x27;:_0x4a25fc,&#x27;btoa&#x27;:_0x243a2c,&#x27;fromBase64&#x27;:_0x219a63,&#x27;toBase64&#x27;:_0x45ae25,&#x27;utob&#x27;:_0x5d413d,&#x27;encode&#x27;:_0x45ae25,&#x27;encodeURI&#x27;:_0x3a12d2,&#x27;btou&#x27;:_0x37c71a,&#x27;decode&#x27;:_0x219a63,&#x27;noConflict&#x27;:_0x3c9d66,&#x27;__buffer__&#x27;:_0x17926&#125;,&#x27;function&#x27;===typeof Object[&#x27;defineProperty&#x27;])&#123;var _0x21e418=function(_0x3ddc3c)&#123;return&#123;&#x27;value&#x27;:_0x3ddc3c,&#x27;enumerable&#x27;:!0x1,&#x27;writable&#x27;:!0x0,&#x27;configurable&#x27;:!0x0&#125;;&#125;;_0x2931cf[&#x27;Base64&#x27;][&#x27;extendString&#x27;]=function()&#123;Object[&#x27;defineProperty&#x27;](String[&#x27;prototype&#x27;],&#x27;fromBase64&#x27;,_0x21e418(function()&#123;return _0x219a63(this);&#125;)),Object[&#x27;defineProperty&#x27;](String[&#x27;prototype&#x27;],&#x27;toBase64&#x27;,_0x21e418(function(_0x12dc48)&#123;return _0x45ae25(this,_0x12dc48);&#125;)),Object[&#x27;defineProperty&#x27;](String[&#x27;prototype&#x27;],&#x27;toBase64URI&#x27;,_0x21e418(function()&#123;return _0x45ae25(this,!0x0);&#125;));&#125;;&#125;return _0x2931cf[&#x27;Meteor&#x27;]&amp;&amp;(Base64=_0x2931cf[&#x27;Base64&#x27;]),_0x2bdb8a[&#x27;exports&#x27;]?_0x2bdb8a[&#x27;exports&#x27;][&#x27;Base64&#x27;]=_0x2931cf[&#x27;Base64&#x27;]:(_0x3c6e10=[],_0xf71c54=function()&#123;return _0x2931cf[&#x27;Base64&#x27;];&#125;[&#x27;apply&#x27;](_0x349d42,_0x3c6e10),void 0x0===_0xf71c54||(_0x2bdb8a[&#x27;exports&#x27;]=_0xf71c54)),&#123;&#x27;Base64&#x27;:_0x2931cf[&#x27;Base64&#x27;]&#125;;&#125;));&#125;[&#x27;call&#x27;](this,_0x247eec(&#x27;c8ba&#x27;)));&#125;,&#x27;2a66&#x27;:function(_0x3b6c86,_0x1c3047,_0x1dca98)&#123;(function(_0x1a77f7,_0x47fae4,_0x33b5f0)&#123;_0x3b6c86[&#x27;exports&#x27;]=_0x47fae4(_0x1dca98(&#x27;21bf&#x27;),_0x1dca98(&#x27;38ba&#x27;));&#125;(0x0,function(_0x32ed62)&#123;return _0x32ed62[&#x27;pad&#x27;][&#x27;ZeroPadding&#x27;]=&#123;&#x27;pad&#x27;:function(_0x2e059c,_0x131350)&#123;var _0x1ff0ab=0x4*_0x131350;_0x2e059c[&#x27;clamp&#x27;](),_0x2e059c[&#x27;sigBytes&#x27;]+=_0x1ff0ab-(_0x2e059c[&#x27;sigBytes&#x27;]%_0x1ff0ab||_0x1ff0ab);&#125;,&#x27;unpad&#x27;:function(_0x234488)&#123;var _0x9fff5f=_0x234488[&#x27;words&#x27;],_0x523dfc=_0x234488[&#x27;sigBytes&#x27;]-0x1;while(!(_0x9fff5f[_0x523dfc&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x523dfc%0x4*0x8&amp;0xff))_0x523dfc--;_0x234488[&#x27;sigBytes&#x27;]=_0x523dfc+0x1;&#125;&#125;,_0x32ed62[&#x27;pad&#x27;][&#x27;ZeroPadding&#x27;];&#125;));&#125;,&#x27;2b79&#x27;:function(_0x485b61,_0x37055d,_0x10afae)&#123;(function(_0x4e623b,_0x4c1d8c,_0x32002a)&#123;_0x485b61[&#x27;exports&#x27;]=_0x4c1d8c(_0x10afae(&#x27;21bf&#x27;),_0x10afae(&#x27;df2f&#x27;),_0x10afae(&#x27;5980&#x27;));&#125;(0x0,function(_0x1aefa5)&#123;return function()&#123;var _0x2b60c7=_0x1aefa5,_0x273d15=_0x2b60c7[&#x27;lib&#x27;],_0x3d7a55=_0x273d15[&#x27;Base&#x27;],_0x5400f8=_0x273d15[&#x27;WordArray&#x27;],_0x4a87c4=_0x2b60c7[&#x27;algo&#x27;],_0x11d264=_0x4a87c4[&#x27;MD5&#x27;],_0x3a2900=_0x4a87c4[&#x27;EvpKDF&#x27;]=_0x3d7a55[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x3d7a55[&#x27;extend&#x27;](&#123;&#x27;keySize&#x27;:0x4,&#x27;hasher&#x27;:_0x11d264,&#x27;iterations&#x27;:0x1&#125;),&#x27;init&#x27;:function(_0x616c6)&#123;this[&#x27;cfg&#x27;]=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x616c6);&#125;,&#x27;compute&#x27;:function(_0x8b84b9,_0xa48a42)&#123;var _0x3207bd=this[&#x27;cfg&#x27;],_0x4d3b20=_0x3207bd[&#x27;hasher&#x27;][&#x27;create&#x27;](),_0x585b3e=_0x5400f8[&#x27;create&#x27;](),_0x44179d=_0x585b3e[&#x27;words&#x27;],_0x374f7f=_0x3207bd[&#x27;keySize&#x27;],_0x5fd695=_0x3207bd[&#x27;iterations&#x27;];while(_0x44179d[&#x27;length&#x27;]&lt;_0x374f7f)&#123;_0x454637&amp;&amp;_0x4d3b20[&#x27;update&#x27;](_0x454637);var _0x454637=_0x4d3b20[&#x27;update&#x27;](_0x8b84b9)[&#x27;finalize&#x27;](_0xa48a42);_0x4d3b20[&#x27;reset&#x27;]();for(var _0x1434a8=0x1;_0x1434a8&lt;_0x5fd695;_0x1434a8++)_0x454637=_0x4d3b20[&#x27;finalize&#x27;](_0x454637),_0x4d3b20[&#x27;reset&#x27;]();_0x585b3e[&#x27;concat&#x27;](_0x454637);&#125;return _0x585b3e[&#x27;sigBytes&#x27;]=0x4*_0x374f7f,_0x585b3e;&#125;&#125;);_0x2b60c7[&#x27;EvpKDF&#x27;]=function(_0x41f429,_0x5bddd2,_0x502b19)&#123;return _0x3a2900[&#x27;create&#x27;](_0x502b19)[&#x27;compute&#x27;](_0x41f429,_0x5bddd2);&#125;;&#125;(),_0x1aefa5[&#x27;EvpKDF&#x27;];&#125;));&#125;,3252:function(_0x1808cb,_0x4fd3b2,_0x2d4265)&#123;(function(_0xceab5a,_0x452b7c)&#123;_0x1808cb[&#x27;exports&#x27;]=_0x452b7c(_0x2d4265(&#x27;21bf&#x27;));&#125;(0x0,function(_0x2f739c)&#123;return function(_0x1764a2)&#123;var _0x515091=_0x2f739c,_0x7a2c02=_0x515091[&#x27;lib&#x27;],_0x27d271=_0x7a2c02[&#x27;Base&#x27;],_0x557fb2=_0x7a2c02[&#x27;WordArray&#x27;],_0x5399f5=_0x515091[&#x27;x64&#x27;]=&#123;&#125;;_0x5399f5[&#x27;Word&#x27;]=_0x27d271[&#x27;extend&#x27;](&#123;&#x27;init&#x27;:function(_0x1e2ca7,_0x4155ce)&#123;this[&#x27;high&#x27;]=_0x1e2ca7,this[&#x27;low&#x27;]=_0x4155ce;&#125;&#125;),_0x5399f5[&#x27;WordArray&#x27;]=_0x27d271[&#x27;extend&#x27;](&#123;&#x27;init&#x27;:function(_0x4f920c,_0x2150a8)&#123;_0x4f920c=this[&#x27;words&#x27;]=_0x4f920c||[],this[&#x27;sigBytes&#x27;]=_0x2150a8!=_0x1764a2?_0x2150a8:0x8*_0x4f920c[&#x27;length&#x27;];&#125;,&#x27;toX32&#x27;:function()&#123;for(var _0x445de3=this[&#x27;words&#x27;],_0x594812=_0x445de3[&#x27;length&#x27;],_0x5000db=[],_0x2dd496=0x0;_0x2dd496&lt;_0x594812;_0x2dd496++)&#123;var _0x51f9c0=_0x445de3[_0x2dd496];_0x5000db[&#x27;push&#x27;](_0x51f9c0[&#x27;high&#x27;]),_0x5000db[&#x27;push&#x27;](_0x51f9c0[&#x27;low&#x27;]);&#125;return _0x557fb2[&#x27;create&#x27;](_0x5000db,this[&#x27;sigBytes&#x27;]);&#125;,&#x27;clone&#x27;:function()&#123;for(var _0x3c220e=_0x27d271[&#x27;clone&#x27;][&#x27;call&#x27;](this),_0x5077a7=_0x3c220e[&#x27;words&#x27;]=this[&#x27;words&#x27;][&#x27;slice&#x27;](0x0),_0x2ec29a=_0x5077a7[&#x27;length&#x27;],_0x4932e6=0x0;_0x4932e6&lt;_0x2ec29a;_0x4932e6++)_0x5077a7[_0x4932e6]=_0x5077a7[_0x4932e6][&#x27;clone&#x27;]();return _0x3c220e;&#125;&#125;);&#125;(),_0x2f739c;&#125;));&#125;,3452:function(_0x30ba7f,_0x547a23,_0x3a1308)&#123;(function(_0xbb0a85,_0xe15a10,_0x39e9de)&#123;_0x30ba7f[&#x27;exports&#x27;]=_0xe15a10(_0x3a1308(&#x27;21bf&#x27;),_0x3a1308(&#x27;3252&#x27;),_0x3a1308(&#x27;17e1&#x27;),_0x3a1308(&#x27;a8ce&#x27;),_0x3a1308(&#x27;1132&#x27;),_0x3a1308(&#x27;72fe&#x27;),_0x3a1308(&#x27;df2f&#x27;),_0x3a1308(&#x27;94f8&#x27;),_0x3a1308(&#x27;191b&#x27;),_0x3a1308(&#x27;d6e6&#x27;),_0x3a1308(&#x27;b86b&#x27;),_0x3a1308(&#x27;e61b&#x27;),_0x3a1308(&#x27;10b7&#x27;),_0x3a1308(&#x27;5980&#x27;),_0x3a1308(&#x27;7bbc&#x27;),_0x3a1308(&#x27;2b79&#x27;),_0x3a1308(&#x27;38ba&#x27;),_0x3a1308(&#x27;00bb&#x27;),_0x3a1308(&#x27;f4ea&#x27;),_0x3a1308(&#x27;aaef&#x27;),_0x3a1308(&#x27;4ba9&#x27;),_0x3a1308(&#x27;81bf&#x27;),_0x3a1308(&#x27;a817&#x27;),_0x3a1308(&#x27;a11b&#x27;),_0x3a1308(&#x27;8cef&#x27;),_0x3a1308(&#x27;2a66&#x27;),_0x3a1308(&#x27;b86c&#x27;),_0x3a1308(&#x27;6d08&#x27;),_0x3a1308(&#x27;c198&#x27;),_0x3a1308(&#x27;a40e&#x27;),_0x3a1308(&#x27;c3b6&#x27;),_0x3a1308(&#x27;1382&#x27;),_0x3a1308(&#x27;3d5a&#x27;));&#125;(0x0,function(_0x29ea8f)&#123;return _0x29ea8f;&#125;));&#125;,3846:function(_0x121ec1,_0x157520,_0x19c084)&#123;_0x19c084(&#x27;9e1e&#x27;)&amp;&amp;&#x27;g&#x27;!=/./g[&#x27;flags&#x27;]&amp;&amp;_0x19c084(&#x27;86cc&#x27;)[&#x27;f&#x27;](RegExp[&#x27;prototype&#x27;],&#x27;flags&#x27;,&#123;&#x27;configurable&#x27;:!0x0,&#x27;get&#x27;:_0x19c084(&#x27;0bfb&#x27;)&#125;);&#125;,&#x27;38ba&#x27;:function(_0x2cc469,_0x4de3aa,_0x5ebfa7)&#123;(function(_0x499e88,_0xea2bea,_0x3ec46b)&#123;_0x2cc469[&#x27;exports&#x27;]=_0xea2bea(_0x5ebfa7(&#x27;21bf&#x27;),_0x5ebfa7(&#x27;2b79&#x27;));&#125;(0x0,function(_0x14f3da)&#123;_0x14f3da[&#x27;lib&#x27;][&#x27;Cipher&#x27;]||function(_0xc2faac)&#123;var _0x438a58=_0x14f3da,_0xa5f483=_0x438a58[&#x27;lib&#x27;],_0xf87cb5=_0xa5f483[&#x27;Base&#x27;],_0x157bc3=_0xa5f483[&#x27;WordArray&#x27;],_0x472516=_0xa5f483[&#x27;BufferedBlockAlgorithm&#x27;],_0x2258b0=_0x438a58[&#x27;enc&#x27;],_0x54111c=(_0x2258b0[&#x27;Utf8&#x27;],_0x2258b0[&#x27;Base64&#x27;]),_0x33471c=_0x438a58[&#x27;algo&#x27;],_0x37d0fd=_0x33471c[&#x27;EvpKDF&#x27;],_0x5c6020=_0xa5f483[&#x27;Cipher&#x27;]=_0x472516[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0xf87cb5[&#x27;extend&#x27;](),&#x27;createEncryptor&#x27;:function(_0xd1a62f,_0x4ed55b)&#123;return this[&#x27;create&#x27;](this[&#x27;_ENC_XFORM_MODE&#x27;],_0xd1a62f,_0x4ed55b);&#125;,&#x27;createDecryptor&#x27;:function(_0x134a91,_0x5687c4)&#123;return this[&#x27;create&#x27;](this[&#x27;_DEC_XFORM_MODE&#x27;],_0x134a91,_0x5687c4);&#125;,&#x27;init&#x27;:function(_0xc0933f,_0x5b215b,_0x5d5bd0)&#123;this[&#x27;cfg&#x27;]=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x5d5bd0),this[&#x27;_xformMode&#x27;]=_0xc0933f,this[&#x27;_key&#x27;]=_0x5b215b,this[&#x27;reset&#x27;]();&#125;,&#x27;reset&#x27;:function()&#123;_0x472516[&#x27;reset&#x27;][&#x27;call&#x27;](this),this[&#x27;_doReset&#x27;]();&#125;,&#x27;process&#x27;:function(_0x10342f)&#123;return this[&#x27;_append&#x27;](_0x10342f),this[&#x27;_process&#x27;]();&#125;,&#x27;finalize&#x27;:function(_0x317c08)&#123;_0x317c08&amp;&amp;this[&#x27;_append&#x27;](_0x317c08);var _0x31e4b9=this[&#x27;_doFinalize&#x27;]();return _0x31e4b9;&#125;,&#x27;keySize&#x27;:0x4,&#x27;ivSize&#x27;:0x4,&#x27;_ENC_XFORM_MODE&#x27;:0x1,&#x27;_DEC_XFORM_MODE&#x27;:0x2,&#x27;_createHelper&#x27;:function()&#123;function _0x4d32df(_0x2f02fa)&#123;return&#x27;string&#x27;==typeof _0x2f02fa?_0x51f071:_0x707b4a;&#125;return function(_0x39584c)&#123;return&#123;&#x27;encrypt&#x27;:function(_0x58ed47,_0x5099c5,_0x2ad646)&#123;return _0x4d32df(_0x5099c5)[&#x27;encrypt&#x27;](_0x39584c,_0x58ed47,_0x5099c5,_0x2ad646);&#125;,&#x27;decrypt&#x27;:function(_0x51675c,_0x5bf815,_0x7a5135)&#123;return _0x4d32df(_0x5bf815)[&#x27;decrypt&#x27;](_0x39584c,_0x51675c,_0x5bf815,_0x7a5135);&#125;&#125;;&#125;;&#125;()&#125;),_0x56611e=(_0xa5f483[&#x27;StreamCipher&#x27;]=_0x5c6020[&#x27;extend&#x27;](&#123;&#x27;_doFinalize&#x27;:function()&#123;var _0xd52196=this[&#x27;_process&#x27;](!0x0);return _0xd52196;&#125;,&#x27;blockSize&#x27;:0x1&#125;),_0x438a58[&#x27;mode&#x27;]=&#123;&#125;),_0x2e52e6=_0xa5f483[&#x27;BlockCipherMode&#x27;]=_0xf87cb5[&#x27;extend&#x27;](&#123;&#x27;createEncryptor&#x27;:function(_0x20f0f6,_0x457a24)&#123;return this[&#x27;Encryptor&#x27;][&#x27;create&#x27;](_0x20f0f6,_0x457a24);&#125;,&#x27;createDecryptor&#x27;:function(_0x36fac0,_0x599c8d)&#123;return this[&#x27;Decryptor&#x27;][&#x27;create&#x27;](_0x36fac0,_0x599c8d);&#125;,&#x27;init&#x27;:function(_0x3baa66,_0x22065e)&#123;this[&#x27;_cipher&#x27;]=_0x3baa66,this[&#x27;_iv&#x27;]=_0x22065e;&#125;&#125;),_0x2bb128=_0x56611e[&#x27;CBC&#x27;]=function()&#123;var _0x19e7c7=_0x2e52e6[&#x27;extend&#x27;]();function _0x28ffe2(_0x3c744e,_0x57dae3,_0x432d8e)&#123;var _0x243d9e=this[&#x27;_iv&#x27;];if(_0x243d9e)&#123;var _0x5642a0=_0x243d9e;this[&#x27;_iv&#x27;]=_0xc2faac;&#125;else _0x5642a0=this[&#x27;_prevBlock&#x27;];for(var _0x2dd4f9=0x0;_0x2dd4f9&lt;_0x432d8e;_0x2dd4f9++)_0x3c744e[_0x57dae3+_0x2dd4f9]^=_0x5642a0[_0x2dd4f9];&#125;return _0x19e7c7[&#x27;Encryptor&#x27;]=_0x19e7c7[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x1a887a,_0x3c417a)&#123;var _0x52c8b3=this[&#x27;_cipher&#x27;],_0x2ecc44=_0x52c8b3[&#x27;blockSize&#x27;];_0x28ffe2[&#x27;call&#x27;](this,_0x1a887a,_0x3c417a,_0x2ecc44),_0x52c8b3[&#x27;encryptBlock&#x27;](_0x1a887a,_0x3c417a),this[&#x27;_prevBlock&#x27;]=_0x1a887a[&#x27;slice&#x27;](_0x3c417a,_0x3c417a+_0x2ecc44);&#125;&#125;),_0x19e7c7[&#x27;Decryptor&#x27;]=_0x19e7c7[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x5b4c30,_0x55577b)&#123;var _0x34d718=this[&#x27;_cipher&#x27;],_0x57551e=_0x34d718[&#x27;blockSize&#x27;],_0x28cdea=_0x5b4c30[&#x27;slice&#x27;](_0x55577b,_0x55577b+_0x57551e);_0x34d718[&#x27;decryptBlock&#x27;](_0x5b4c30,_0x55577b),_0x28ffe2[&#x27;call&#x27;](this,_0x5b4c30,_0x55577b,_0x57551e),this[&#x27;_prevBlock&#x27;]=_0x28cdea;&#125;&#125;),_0x19e7c7;&#125;(),_0x18417e=_0x438a58[&#x27;pad&#x27;]=&#123;&#125;,_0x2810fd=_0x18417e[&#x27;Pkcs7&#x27;]=&#123;&#x27;pad&#x27;:function(_0x368fb0,_0x4c4a69)&#123;for(var _0x1fd049=0x4*_0x4c4a69,_0x261fab=_0x1fd049-_0x368fb0[&#x27;sigBytes&#x27;]%_0x1fd049,_0x5b38e7=_0x261fab&lt;&lt;0x18|_0x261fab&lt;&lt;0x10|_0x261fab&lt;&lt;0x8|_0x261fab,_0x2d3607=[],_0x358c94=0x0;_0x358c94&lt;_0x261fab;_0x358c94+=0x4)_0x2d3607[&#x27;push&#x27;](_0x5b38e7);var _0x5d9a65=_0x157bc3[&#x27;create&#x27;](_0x2d3607,_0x261fab);_0x368fb0[&#x27;concat&#x27;](_0x5d9a65);&#125;,&#x27;unpad&#x27;:function(_0x4070a0)&#123;var _0x3113d3=0xff&amp;_0x4070a0[&#x27;words&#x27;][_0x4070a0[&#x27;sigBytes&#x27;]-0x1&gt;&gt;&gt;0x2];_0x4070a0[&#x27;sigBytes&#x27;]-=_0x3113d3;&#125;&#125;,_0x31bf2d=(_0xa5f483[&#x27;BlockCipher&#x27;]=_0x5c6020[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x5c6020[&#x27;cfg&#x27;][&#x27;extend&#x27;](&#123;&#x27;mode&#x27;:_0x2bb128,&#x27;padding&#x27;:_0x2810fd&#125;),&#x27;reset&#x27;:function()&#123;_0x5c6020[&#x27;reset&#x27;][&#x27;call&#x27;](this);var _0x5d9775=this[&#x27;cfg&#x27;],_0xce5523=_0x5d9775[&#x27;iv&#x27;],_0x283619=_0x5d9775[&#x27;mode&#x27;];if(this[&#x27;_xformMode&#x27;]==this[&#x27;_ENC_XFORM_MODE&#x27;])var _0x1d78c0=_0x283619[&#x27;createEncryptor&#x27;];else&#123;_0x1d78c0=_0x283619[&#x27;createDecryptor&#x27;];this[&#x27;_minBufferSize&#x27;]=0x1;&#125;this[&#x27;_mode&#x27;]&amp;&amp;this[&#x27;_mode&#x27;][&#x27;__creator&#x27;]==_0x1d78c0?this[&#x27;_mode&#x27;][&#x27;init&#x27;](this,_0xce5523&amp;&amp;_0xce5523[&#x27;words&#x27;]):(this[&#x27;_mode&#x27;]=_0x1d78c0[&#x27;call&#x27;](_0x283619,this,_0xce5523&amp;&amp;_0xce5523[&#x27;words&#x27;]),this[&#x27;_mode&#x27;][&#x27;__creator&#x27;]=_0x1d78c0);&#125;,&#x27;_doProcessBlock&#x27;:function(_0x533320,_0x111868)&#123;this[&#x27;_mode&#x27;][&#x27;processBlock&#x27;](_0x533320,_0x111868);&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x47043e=this[&#x27;cfg&#x27;][&#x27;padding&#x27;];if(this[&#x27;_xformMode&#x27;]==this[&#x27;_ENC_XFORM_MODE&#x27;])&#123;_0x47043e[&#x27;pad&#x27;](this[&#x27;_data&#x27;],this[&#x27;blockSize&#x27;]);var _0x326a91=this[&#x27;_process&#x27;](!0x0);&#125;else&#123;_0x326a91=this[&#x27;_process&#x27;](!0x0);_0x47043e[&#x27;unpad&#x27;](_0x326a91);&#125;return _0x326a91;&#125;,&#x27;blockSize&#x27;:0x4&#125;),_0xa5f483[&#x27;CipherParams&#x27;]=_0xf87cb5[&#x27;extend&#x27;](&#123;&#x27;init&#x27;:function(_0x2fcf08)&#123;this[&#x27;mixIn&#x27;](_0x2fcf08);&#125;,&#x27;toString&#x27;:function(_0x523af5)&#123;return(_0x523af5||this[&#x27;formatter&#x27;])[&#x27;stringify&#x27;](this);&#125;&#125;)),_0x204dd8=_0x438a58[&#x27;format&#x27;]=&#123;&#125;,_0x25a670=_0x204dd8[&#x27;OpenSSL&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x376867)&#123;var _0x5c22bb=_0x376867[&#x27;ciphertext&#x27;],_0x33f188=_0x376867[&#x27;salt&#x27;];if(_0x33f188)var _0x2355b7=_0x157bc3[&#x27;create&#x27;]([0x53616c74,0x65645f5f])[&#x27;concat&#x27;](_0x33f188)[&#x27;concat&#x27;](_0x5c22bb);else _0x2355b7=_0x5c22bb;return _0x2355b7[&#x27;toString&#x27;](_0x54111c);&#125;,&#x27;parse&#x27;:function(_0x4357ff)&#123;var _0x1ac2c2=_0x54111c[&#x27;parse&#x27;](_0x4357ff),_0x30e1e1=_0x1ac2c2[&#x27;words&#x27;];if(0x53616c74==_0x30e1e1[0x0]&amp;&amp;0x65645f5f==_0x30e1e1[0x1])&#123;var _0x4df7cc=_0x157bc3[&#x27;create&#x27;](_0x30e1e1[&#x27;slice&#x27;](0x2,0x4));_0x30e1e1[&#x27;splice&#x27;](0x0,0x4),_0x1ac2c2[&#x27;sigBytes&#x27;]-=0x10;&#125;return _0x31bf2d[&#x27;create&#x27;](&#123;&#x27;ciphertext&#x27;:_0x1ac2c2,&#x27;salt&#x27;:_0x4df7cc&#125;);&#125;&#125;,_0x707b4a=_0xa5f483[&#x27;SerializableCipher&#x27;]=_0xf87cb5[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0xf87cb5[&#x27;extend&#x27;](&#123;&#x27;format&#x27;:_0x25a670&#125;),&#x27;encrypt&#x27;:function(_0x5974aa,_0x3854a6,_0x5044c7,_0x3be07f)&#123;_0x3be07f=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x3be07f);var _0x4a8d07=_0x5974aa[&#x27;createEncryptor&#x27;](_0x5044c7,_0x3be07f),_0x19dd62=_0x4a8d07[&#x27;finalize&#x27;](_0x3854a6),_0x546f94=_0x4a8d07[&#x27;cfg&#x27;];return _0x31bf2d[&#x27;create&#x27;](&#123;&#x27;ciphertext&#x27;:_0x19dd62,&#x27;key&#x27;:_0x5044c7,&#x27;iv&#x27;:_0x546f94[&#x27;iv&#x27;],&#x27;algorithm&#x27;:_0x5974aa,&#x27;mode&#x27;:_0x546f94[&#x27;mode&#x27;],&#x27;padding&#x27;:_0x546f94[&#x27;padding&#x27;],&#x27;blockSize&#x27;:_0x5974aa[&#x27;blockSize&#x27;],&#x27;formatter&#x27;:_0x3be07f[&#x27;format&#x27;]&#125;);&#125;,&#x27;decrypt&#x27;:function(_0x592bb0,_0x54017e,_0x3bffe1,_0x3ba76c)&#123;_0x3ba76c=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x3ba76c),_0x54017e=this[&#x27;_parse&#x27;](_0x54017e,_0x3ba76c[&#x27;format&#x27;]);var _0x3645cc=_0x592bb0[&#x27;createDecryptor&#x27;](_0x3bffe1,_0x3ba76c)[&#x27;finalize&#x27;](_0x54017e[&#x27;ciphertext&#x27;]);return _0x3645cc;&#125;,&#x27;_parse&#x27;:function(_0x2f58c6,_0x533d86)&#123;return&#x27;string&#x27;==typeof _0x2f58c6?_0x533d86[&#x27;parse&#x27;](_0x2f58c6,this):_0x2f58c6;&#125;&#125;),_0x21b32c=_0x438a58[&#x27;kdf&#x27;]=&#123;&#125;,_0x27f61b=_0x21b32c[&#x27;OpenSSL&#x27;]=&#123;&#x27;execute&#x27;:function(_0x1e511e,_0x25630d,_0x2350e0,_0x5112c3)&#123;_0x5112c3||(_0x5112c3=_0x157bc3[&#x27;random&#x27;](0x8));var _0x230c22=_0x37d0fd[&#x27;create&#x27;](&#123;&#x27;keySize&#x27;:_0x25630d+_0x2350e0&#125;)[&#x27;compute&#x27;](_0x1e511e,_0x5112c3),_0x531ea7=_0x157bc3[&#x27;create&#x27;](_0x230c22[&#x27;words&#x27;][&#x27;slice&#x27;](_0x25630d),0x4*_0x2350e0);return _0x230c22[&#x27;sigBytes&#x27;]=0x4*_0x25630d,_0x31bf2d[&#x27;create&#x27;](&#123;&#x27;key&#x27;:_0x230c22,&#x27;iv&#x27;:_0x531ea7,&#x27;salt&#x27;:_0x5112c3&#125;);&#125;&#125;,_0x51f071=_0xa5f483[&#x27;PasswordBasedCipher&#x27;]=_0x707b4a[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x707b4a[&#x27;cfg&#x27;][&#x27;extend&#x27;](&#123;&#x27;kdf&#x27;:_0x27f61b&#125;),&#x27;encrypt&#x27;:function(_0x21e3eb,_0x539633,_0x3c4b61,_0x2bd3f4)&#123;_0x2bd3f4=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x2bd3f4);var _0x4f14c3=_0x2bd3f4[&#x27;kdf&#x27;][&#x27;execute&#x27;](_0x3c4b61,_0x21e3eb[&#x27;keySize&#x27;],_0x21e3eb[&#x27;ivSize&#x27;]);_0x2bd3f4[&#x27;iv&#x27;]=_0x4f14c3[&#x27;iv&#x27;];var _0x5e6b77=_0x707b4a[&#x27;encrypt&#x27;][&#x27;call&#x27;](this,_0x21e3eb,_0x539633,_0x4f14c3[&#x27;key&#x27;],_0x2bd3f4);return _0x5e6b77[&#x27;mixIn&#x27;](_0x4f14c3),_0x5e6b77;&#125;,&#x27;decrypt&#x27;:function(_0x5e99d6,_0x4ce269,_0x1e8a3b,_0x48cddb)&#123;_0x48cddb=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x48cddb),_0x4ce269=this[&#x27;_parse&#x27;](_0x4ce269,_0x48cddb[&#x27;format&#x27;]);var _0x40b550=_0x48cddb[&#x27;kdf&#x27;][&#x27;execute&#x27;](_0x1e8a3b,_0x5e99d6[&#x27;keySize&#x27;],_0x5e99d6[&#x27;ivSize&#x27;],_0x4ce269[&#x27;salt&#x27;]);_0x48cddb[&#x27;iv&#x27;]=_0x40b550[&#x27;iv&#x27;];var _0x47b138=_0x707b4a[&#x27;decrypt&#x27;][&#x27;call&#x27;](this,_0x5e99d6,_0x4ce269,_0x40b550[&#x27;key&#x27;],_0x48cddb);return _0x47b138;&#125;&#125;);&#125;();&#125;));&#125;,&#x27;3d5a&#x27;:function(_0x4bb965,_0x300c84,_0x4ad8f9)&#123;(function(_0x1eb710,_0x28193d,_0x2ac460)&#123;_0x4bb965[&#x27;exports&#x27;]=_0x28193d(_0x4ad8f9(&#x27;21bf&#x27;),_0x4ad8f9(&#x27;1132&#x27;),_0x4ad8f9(&#x27;72fe&#x27;),_0x4ad8f9(&#x27;2b79&#x27;),_0x4ad8f9(&#x27;38ba&#x27;));&#125;(0x0,function(_0xa10a68)&#123;return function()&#123;var _0x43b0bd=_0xa10a68,_0x3f59f6=_0x43b0bd[&#x27;lib&#x27;],_0x29a5ce=_0x3f59f6[&#x27;StreamCipher&#x27;],_0x318c0b=_0x43b0bd[&#x27;algo&#x27;],_0x5e48e1=[],_0x5d9967=[],_0x3e16d5=[],_0x8cdeae=_0x318c0b[&#x27;RabbitLegacy&#x27;]=_0x29a5ce[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;var _0x3c3ad3=this[&#x27;_key&#x27;][&#x27;words&#x27;],_0x375a8b=this[&#x27;cfg&#x27;][&#x27;iv&#x27;],_0x461a88=this[&#x27;_X&#x27;]=[_0x3c3ad3[0x0],_0x3c3ad3[0x3]&lt;&lt;0x10|_0x3c3ad3[0x2]&gt;&gt;&gt;0x10,_0x3c3ad3[0x1],_0x3c3ad3[0x0]&lt;&lt;0x10|_0x3c3ad3[0x3]&gt;&gt;&gt;0x10,_0x3c3ad3[0x2],_0x3c3ad3[0x1]&lt;&lt;0x10|_0x3c3ad3[0x0]&gt;&gt;&gt;0x10,_0x3c3ad3[0x3],_0x3c3ad3[0x2]&lt;&lt;0x10|_0x3c3ad3[0x1]&gt;&gt;&gt;0x10],_0xf73bb7=this[&#x27;_C&#x27;]=[_0x3c3ad3[0x2]&lt;&lt;0x10|_0x3c3ad3[0x2]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x3c3ad3[0x0]|0xffff&amp;_0x3c3ad3[0x1],_0x3c3ad3[0x3]&lt;&lt;0x10|_0x3c3ad3[0x3]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x3c3ad3[0x1]|0xffff&amp;_0x3c3ad3[0x2],_0x3c3ad3[0x0]&lt;&lt;0x10|_0x3c3ad3[0x0]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x3c3ad3[0x2]|0xffff&amp;_0x3c3ad3[0x3],_0x3c3ad3[0x1]&lt;&lt;0x10|_0x3c3ad3[0x1]&gt;&gt;&gt;0x10,0xffff0000&amp;_0x3c3ad3[0x3]|0xffff&amp;_0x3c3ad3[0x0]];this[&#x27;_b&#x27;]=0x0;for(var _0x1f9432=0x0;_0x1f9432&lt;0x4;_0x1f9432++)_0x397a2b[&#x27;call&#x27;](this);for(_0x1f9432=0x0;_0x1f9432&lt;0x8;_0x1f9432++)_0xf73bb7[_0x1f9432]^=_0x461a88[_0x1f9432+0x4&amp;0x7];if(_0x375a8b)&#123;var _0x31a167=_0x375a8b[&#x27;words&#x27;],_0x3f4a73=_0x31a167[0x0],_0x4afe44=_0x31a167[0x1],_0x15adab=0xff00ff&amp;(_0x3f4a73&lt;&lt;0x8|_0x3f4a73&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x3f4a73&lt;&lt;0x18|_0x3f4a73&gt;&gt;&gt;0x8),_0x9d5207=0xff00ff&amp;(_0x4afe44&lt;&lt;0x8|_0x4afe44&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x4afe44&lt;&lt;0x18|_0x4afe44&gt;&gt;&gt;0x8),_0x2c8738=_0x15adab&gt;&gt;&gt;0x10|0xffff0000&amp;_0x9d5207,_0x1f0d23=_0x9d5207&lt;&lt;0x10|0xffff&amp;_0x15adab;_0xf73bb7[0x0]^=_0x15adab,_0xf73bb7[0x1]^=_0x2c8738,_0xf73bb7[0x2]^=_0x9d5207,_0xf73bb7[0x3]^=_0x1f0d23,_0xf73bb7[0x4]^=_0x15adab,_0xf73bb7[0x5]^=_0x2c8738,_0xf73bb7[0x6]^=_0x9d5207,_0xf73bb7[0x7]^=_0x1f0d23;for(_0x1f9432=0x0;_0x1f9432&lt;0x4;_0x1f9432++)_0x397a2b[&#x27;call&#x27;](this);&#125;&#125;,&#x27;_doProcessBlock&#x27;:function(_0x10a76d,_0x3f4755)&#123;var _0x29fb04=this[&#x27;_X&#x27;];_0x397a2b[&#x27;call&#x27;](this),_0x5e48e1[0x0]=_0x29fb04[0x0]^_0x29fb04[0x5]&gt;&gt;&gt;0x10^_0x29fb04[0x3]&lt;&lt;0x10,_0x5e48e1[0x1]=_0x29fb04[0x2]^_0x29fb04[0x7]&gt;&gt;&gt;0x10^_0x29fb04[0x5]&lt;&lt;0x10,_0x5e48e1[0x2]=_0x29fb04[0x4]^_0x29fb04[0x1]&gt;&gt;&gt;0x10^_0x29fb04[0x7]&lt;&lt;0x10,_0x5e48e1[0x3]=_0x29fb04[0x6]^_0x29fb04[0x3]&gt;&gt;&gt;0x10^_0x29fb04[0x1]&lt;&lt;0x10;for(var _0x353444=0x0;_0x353444&lt;0x4;_0x353444++)_0x5e48e1[_0x353444]=0xff00ff&amp;(_0x5e48e1[_0x353444]&lt;&lt;0x8|_0x5e48e1[_0x353444]&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x5e48e1[_0x353444]&lt;&lt;0x18|_0x5e48e1[_0x353444]&gt;&gt;&gt;0x8),_0x10a76d[_0x3f4755+_0x353444]^=_0x5e48e1[_0x353444];&#125;,&#x27;blockSize&#x27;:0x4,&#x27;ivSize&#x27;:0x2&#125;);function _0x397a2b()&#123;for(var _0x548f17=this[&#x27;_X&#x27;],_0x4c683f=this[&#x27;_C&#x27;],_0x14f318=0x0;_0x14f318&lt;0x8;_0x14f318++)_0x5d9967[_0x14f318]=_0x4c683f[_0x14f318];_0x4c683f[0x0]=_0x4c683f[0x0]+0x4d34d34d+this[&#x27;_b&#x27;]|0x0,_0x4c683f[0x1]=_0x4c683f[0x1]+0xd34d34d3+(_0x4c683f[0x0]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x0]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x2]=_0x4c683f[0x2]+0x34d34d34+(_0x4c683f[0x1]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x1]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x3]=_0x4c683f[0x3]+0x4d34d34d+(_0x4c683f[0x2]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x2]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x4]=_0x4c683f[0x4]+0xd34d34d3+(_0x4c683f[0x3]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x3]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x5]=_0x4c683f[0x5]+0x34d34d34+(_0x4c683f[0x4]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x4]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x6]=_0x4c683f[0x6]+0x4d34d34d+(_0x4c683f[0x5]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x5]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x4c683f[0x7]=_0x4c683f[0x7]+0xd34d34d3+(_0x4c683f[0x6]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x6]&gt;&gt;&gt;0x0?0x1:0x0)|0x0,this[&#x27;_b&#x27;]=_0x4c683f[0x7]&gt;&gt;&gt;0x0&lt;_0x5d9967[0x7]&gt;&gt;&gt;0x0?0x1:0x0;for(_0x14f318=0x0;_0x14f318&lt;0x8;_0x14f318++)&#123;var _0x510ef1=_0x548f17[_0x14f318]+_0x4c683f[_0x14f318],_0x5c2d86=0xffff&amp;_0x510ef1,_0x4f854c=_0x510ef1&gt;&gt;&gt;0x10,_0x3c0f47=((_0x5c2d86*_0x5c2d86&gt;&gt;&gt;0x11)+_0x5c2d86*_0x4f854c&gt;&gt;&gt;0xf)+_0x4f854c*_0x4f854c,_0x581b0e=((0xffff0000&amp;_0x510ef1)*_0x510ef1|0x0)+((0xffff&amp;_0x510ef1)*_0x510ef1|0x0);_0x3e16d5[_0x14f318]=_0x3c0f47^_0x581b0e;&#125;_0x548f17[0x0]=_0x3e16d5[0x0]+(_0x3e16d5[0x7]&lt;&lt;0x10|_0x3e16d5[0x7]&gt;&gt;&gt;0x10)+(_0x3e16d5[0x6]&lt;&lt;0x10|_0x3e16d5[0x6]&gt;&gt;&gt;0x10)|0x0,_0x548f17[0x1]=_0x3e16d5[0x1]+(_0x3e16d5[0x0]&lt;&lt;0x8|_0x3e16d5[0x0]&gt;&gt;&gt;0x18)+_0x3e16d5[0x7]|0x0,_0x548f17[0x2]=_0x3e16d5[0x2]+(_0x3e16d5[0x1]&lt;&lt;0x10|_0x3e16d5[0x1]&gt;&gt;&gt;0x10)+(_0x3e16d5[0x0]&lt;&lt;0x10|_0x3e16d5[0x0]&gt;&gt;&gt;0x10)|0x0,_0x548f17[0x3]=_0x3e16d5[0x3]+(_0x3e16d5[0x2]&lt;&lt;0x8|_0x3e16d5[0x2]&gt;&gt;&gt;0x18)+_0x3e16d5[0x1]|0x0,_0x548f17[0x4]=_0x3e16d5[0x4]+(_0x3e16d5[0x3]&lt;&lt;0x10|_0x3e16d5[0x3]&gt;&gt;&gt;0x10)+(_0x3e16d5[0x2]&lt;&lt;0x10|_0x3e16d5[0x2]&gt;&gt;&gt;0x10)|0x0,_0x548f17[0x5]=_0x3e16d5[0x5]+(_0x3e16d5[0x4]&lt;&lt;0x8|_0x3e16d5[0x4]&gt;&gt;&gt;0x18)+_0x3e16d5[0x3]|0x0,_0x548f17[0x6]=_0x3e16d5[0x6]+(_0x3e16d5[0x5]&lt;&lt;0x10|_0x3e16d5[0x5]&gt;&gt;&gt;0x10)+(_0x3e16d5[0x4]&lt;&lt;0x10|_0x3e16d5[0x4]&gt;&gt;&gt;0x10)|0x0,_0x548f17[0x7]=_0x3e16d5[0x7]+(_0x3e16d5[0x6]&lt;&lt;0x8|_0x3e16d5[0x6]&gt;&gt;&gt;0x18)+_0x3e16d5[0x5]|0x0;&#125;_0x43b0bd[&#x27;RabbitLegacy&#x27;]=_0x29a5ce[&#x27;_createHelper&#x27;](_0x8cdeae);&#125;(),_0xa10a68[&#x27;RabbitLegacy&#x27;];&#125;));&#125;,&#x27;3e22&#x27;:function(_0x324930,_0x39029a,_0x51eef7)&#123;&#x27;use strict&#x27;;_0x51eef7(&#x27;6b54&#x27;);var _0x11a046=&#x27;ef34#teuq0btua#(-57w1q5o5--j@98xygimlyfxs*-!i-0-mb&#x27;,_0x165112=_0x51eef7(&#x27;27ae&#x27;)[&#x27;Base64&#x27;];function _0x2fa8f6(_0x177944)&#123;var _0x2c4f17=_0x11a046+_0x177944[&#x27;toString&#x27;]();return _0x165112[&#x27;encode&#x27;](_0x2c4f17);&#125;_0x39029a[&#x27;a&#x27;]=_0x2fa8f6;&#125;,&#x27;4ba9&#x27;:function(_0x193fef,_0x86337a,_0x5e63de)&#123;(function(_0x198656,_0x1a8ff8,_0x10c365)&#123;_0x193fef[&#x27;exports&#x27;]=_0x1a8ff8(_0x5e63de(&#x27;21bf&#x27;),_0x5e63de(&#x27;38ba&#x27;));&#125;(0x0,function(_0x316059)&#123;return _0x316059[&#x27;mode&#x27;][&#x27;OFB&#x27;]=function()&#123;var _0x50fc21=_0x316059[&#x27;lib&#x27;][&#x27;BlockCipherMode&#x27;][&#x27;extend&#x27;](),_0x36ef3c=_0x50fc21[&#x27;Encryptor&#x27;]=_0x50fc21[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x4879a6,_0x39cc7a)&#123;var _0x3a3256=this[&#x27;_cipher&#x27;],_0x1e82d6=_0x3a3256[&#x27;blockSize&#x27;],_0x18b1f5=this[&#x27;_iv&#x27;],_0x1ea34c=this[&#x27;_keystream&#x27;];_0x18b1f5&amp;&amp;(_0x1ea34c=this[&#x27;_keystream&#x27;]=_0x18b1f5[&#x27;slice&#x27;](0x0),this[&#x27;_iv&#x27;]=void 0x0),_0x3a3256[&#x27;encryptBlock&#x27;](_0x1ea34c,0x0);for(var _0x2ad02f=0x0;_0x2ad02f&lt;_0x1e82d6;_0x2ad02f++)_0x4879a6[_0x39cc7a+_0x2ad02f]^=_0x1ea34c[_0x2ad02f];&#125;&#125;);return _0x50fc21[&#x27;Decryptor&#x27;]=_0x36ef3c,_0x50fc21;&#125;(),_0x316059[&#x27;mode&#x27;][&#x27;OFB&#x27;];&#125;));&#125;,5980:function(_0xf7ab1b,_0x1f5734,_0x21287f)&#123;(function(_0x6566f3,_0x1bd589)&#123;_0xf7ab1b[&#x27;exports&#x27;]=_0x1bd589(_0x21287f(&#x27;21bf&#x27;));&#125;(0x0,function(_0x5d732a)&#123;(function()&#123;var _0x5adf7e=_0x5d732a,_0x470629=_0x5adf7e[&#x27;lib&#x27;],_0x5e7152=_0x470629[&#x27;Base&#x27;],_0x26fe35=_0x5adf7e[&#x27;enc&#x27;],_0x2c556a=_0x26fe35[&#x27;Utf8&#x27;],_0x1721f2=_0x5adf7e[&#x27;algo&#x27;];_0x1721f2[&#x27;HMAC&#x27;]=_0x5e7152[&#x27;extend&#x27;](&#123;&#x27;init&#x27;:function(_0x4e81c8,_0x1ed0b7)&#123;_0x4e81c8=this[&#x27;_hasher&#x27;]=new _0x4e81c8[&#x27;init&#x27;](),&#x27;string&#x27;==typeof _0x1ed0b7&amp;&amp;(_0x1ed0b7=_0x2c556a[&#x27;parse&#x27;](_0x1ed0b7));var _0x24ef79=_0x4e81c8[&#x27;blockSize&#x27;],_0x480c11=0x4*_0x24ef79;_0x1ed0b7[&#x27;sigBytes&#x27;]&gt;_0x480c11&amp;&amp;(_0x1ed0b7=_0x4e81c8[&#x27;finalize&#x27;](_0x1ed0b7)),_0x1ed0b7[&#x27;clamp&#x27;]();for(var _0xf79133=this[&#x27;_oKey&#x27;]=_0x1ed0b7[&#x27;clone&#x27;](),_0x1cac7d=this[&#x27;_iKey&#x27;]=_0x1ed0b7[&#x27;clone&#x27;](),_0x575766=_0xf79133[&#x27;words&#x27;],_0x34e727=_0x1cac7d[&#x27;words&#x27;],_0x1cd350=0x0;_0x1cd350&lt;_0x24ef79;_0x1cd350++)_0x575766[_0x1cd350]^=0x5c5c5c5c,_0x34e727[_0x1cd350]^=0x36363636;_0xf79133[&#x27;sigBytes&#x27;]=_0x1cac7d[&#x27;sigBytes&#x27;]=_0x480c11,this[&#x27;reset&#x27;]();&#125;,&#x27;reset&#x27;:function()&#123;var _0x1afcf8=this[&#x27;_hasher&#x27;];_0x1afcf8[&#x27;reset&#x27;](),_0x1afcf8[&#x27;update&#x27;](this[&#x27;_iKey&#x27;]);&#125;,&#x27;update&#x27;:function(_0x2c6f62)&#123;return this[&#x27;_hasher&#x27;][&#x27;update&#x27;](_0x2c6f62),this;&#125;,&#x27;finalize&#x27;:function(_0x2c08da)&#123;var _0x24cc1e=this[&#x27;_hasher&#x27;],_0x5c3552=_0x24cc1e[&#x27;finalize&#x27;](_0x2c08da);_0x24cc1e[&#x27;reset&#x27;]();var _0x5909d7=_0x24cc1e[&#x27;finalize&#x27;](this[&#x27;_oKey&#x27;][&#x27;clone&#x27;]()[&#x27;concat&#x27;](_0x5c3552));return _0x5909d7;&#125;&#125;);&#125;());&#125;));&#125;,&#x27;6b54&#x27;:function(_0x49ed71,_0x175c1e,_0xffba69)&#123;&#x27;use strict&#x27;;_0xffba69(&#x27;3846&#x27;);var _0x160347=_0xffba69(&#x27;cb7c&#x27;),_0x9163df=_0xffba69(&#x27;0bfb&#x27;),_0x22c02c=_0xffba69(&#x27;9e1e&#x27;),_0x469ab6=&#x27;toString&#x27;,_0x2e6ceb=/./[_0x469ab6],_0x17e901=function(_0x202527)&#123;_0xffba69(&#x27;2aba&#x27;)(RegExp[&#x27;prototype&#x27;],_0x469ab6,_0x202527,!0x0);&#125;;_0xffba69(&#x27;79e5&#x27;)(function()&#123;return&#x27;/a/b&#x27;!=_0x2e6ceb[&#x27;call&#x27;](&#123;&#x27;source&#x27;:&#x27;a&#x27;,&#x27;flags&#x27;:&#x27;b&#x27;&#125;);&#125;)?_0x17e901(function()&#123;var _0x1ec3f6=_0x160347(this);return&#x27;/&#x27;[&#x27;concat&#x27;](_0x1ec3f6[&#x27;source&#x27;],&#x27;/&#x27;,&#x27;flags&#x27;in _0x1ec3f6?_0x1ec3f6[&#x27;flags&#x27;]:!_0x22c02c&amp;&amp;_0x1ec3f6 instanceof RegExp?_0x9163df[&#x27;call&#x27;](_0x1ec3f6):void 0x0);&#125;):_0x2e6ceb[&#x27;name&#x27;]!=_0x469ab6&amp;&amp;_0x17e901(function()&#123;return _0x2e6ceb[&#x27;call&#x27;](this);&#125;);&#125;,&#x27;6d08&#x27;:function(_0x4d6940,_0x4b3ddc,_0x2dfda3)&#123;(function(_0x3a7027,_0x3f7cf4,_0x2ec188)&#123;_0x4d6940[&#x27;exports&#x27;]=_0x3f7cf4(_0x2dfda3(&#x27;21bf&#x27;),_0x2dfda3(&#x27;38ba&#x27;));&#125;(0x0,function(_0x5ecad4)&#123;return function(_0x50d4c6)&#123;var _0x1d295d=_0x5ecad4,_0xc98f78=_0x1d295d[&#x27;lib&#x27;],_0x17a579=_0xc98f78[&#x27;CipherParams&#x27;],_0x1546d5=_0x1d295d[&#x27;enc&#x27;],_0x3d518e=_0x1546d5[&#x27;Hex&#x27;],_0x691771=_0x1d295d[&#x27;format&#x27;];_0x691771[&#x27;Hex&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x17b9f5)&#123;return _0x17b9f5[&#x27;ciphertext&#x27;][&#x27;toString&#x27;](_0x3d518e);&#125;,&#x27;parse&#x27;:function(_0x58c9ad)&#123;var _0x33d96a=_0x3d518e[&#x27;parse&#x27;](_0x58c9ad);return _0x17a579[&#x27;create&#x27;](&#123;&#x27;ciphertext&#x27;:_0x33d96a&#125;);&#125;&#125;;&#125;(),_0x5ecad4[&#x27;format&#x27;][&#x27;Hex&#x27;];&#125;));&#125;,&#x27;72fe&#x27;:function(_0x3afed0,_0xe2cc1a,_0x390997)&#123;(function(_0x776bc1,_0x128715)&#123;_0x3afed0[&#x27;exports&#x27;]=_0x128715(_0x390997(&#x27;21bf&#x27;));&#125;(0x0,function(_0x2c8084)&#123;return function(_0x40a714)&#123;var _0x49d531=_0x2c8084,_0x2a1a20=_0x49d531[&#x27;lib&#x27;],_0x4ddf62=_0x2a1a20[&#x27;WordArray&#x27;],_0x3cef6b=_0x2a1a20[&#x27;Hasher&#x27;],_0x4ad2cd=_0x49d531[&#x27;algo&#x27;],_0x990e30=[];(function()&#123;for(var _0x49568e=0x0;_0x49568e&lt;0x40;_0x49568e++)_0x990e30[_0x49568e]=0x100000000*_0x40a714[&#x27;abs&#x27;](_0x40a714[&#x27;sin&#x27;](_0x49568e+0x1))|0x0;&#125;());var _0x130439=_0x4ad2cd[&#x27;MD5&#x27;]=_0x3cef6b[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x4ddf62[&#x27;init&#x27;]([0x67452301,0xefcdab89,0x98badcfe,0x10325476]);&#125;,&#x27;_doProcessBlock&#x27;:function(_0x453608,_0x30855b)&#123;for(var _0x3bd890=0x0;_0x3bd890&lt;0x10;_0x3bd890++)&#123;var _0x215b23=_0x30855b+_0x3bd890,_0x58a4e8=_0x453608[_0x215b23];_0x453608[_0x215b23]=0xff00ff&amp;(_0x58a4e8&lt;&lt;0x8|_0x58a4e8&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x58a4e8&lt;&lt;0x18|_0x58a4e8&gt;&gt;&gt;0x8);&#125;var _0x5cbf84=this[&#x27;_hash&#x27;][&#x27;words&#x27;],_0x5b9380=_0x453608[_0x30855b+0x0],_0x3b1557=_0x453608[_0x30855b+0x1],_0x3c0002=_0x453608[_0x30855b+0x2],_0x2a675f=_0x453608[_0x30855b+0x3],_0x2a0c66=_0x453608[_0x30855b+0x4],_0x121d18=_0x453608[_0x30855b+0x5],_0x48d437=_0x453608[_0x30855b+0x6],_0x22fe22=_0x453608[_0x30855b+0x7],_0x540a35=_0x453608[_0x30855b+0x8],_0x33b7c1=_0x453608[_0x30855b+0x9],_0x40a52=_0x453608[_0x30855b+0xa],_0x3217ef=_0x453608[_0x30855b+0xb],_0x19accb=_0x453608[_0x30855b+0xc],_0x4fcc8e=_0x453608[_0x30855b+0xd],_0x2c6d5f=_0x453608[_0x30855b+0xe],_0x5ad202=_0x453608[_0x30855b+0xf],_0x491cd6=_0x5cbf84[0x0],_0x4ac229=_0x5cbf84[0x1],_0x127f64=_0x5cbf84[0x2],_0x35d089=_0x5cbf84[0x3];_0x491cd6=_0x3070c6(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x5b9380,0x7,_0x990e30[0x0]),_0x35d089=_0x3070c6(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x3b1557,0xc,_0x990e30[0x1]),_0x127f64=_0x3070c6(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x3c0002,0x11,_0x990e30[0x2]),_0x4ac229=_0x3070c6(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x2a675f,0x16,_0x990e30[0x3]),_0x491cd6=_0x3070c6(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x2a0c66,0x7,_0x990e30[0x4]),_0x35d089=_0x3070c6(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x121d18,0xc,_0x990e30[0x5]),_0x127f64=_0x3070c6(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x48d437,0x11,_0x990e30[0x6]),_0x4ac229=_0x3070c6(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x22fe22,0x16,_0x990e30[0x7]),_0x491cd6=_0x3070c6(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x540a35,0x7,_0x990e30[0x8]),_0x35d089=_0x3070c6(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x33b7c1,0xc,_0x990e30[0x9]),_0x127f64=_0x3070c6(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x40a52,0x11,_0x990e30[0xa]),_0x4ac229=_0x3070c6(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x3217ef,0x16,_0x990e30[0xb]),_0x491cd6=_0x3070c6(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x19accb,0x7,_0x990e30[0xc]),_0x35d089=_0x3070c6(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x4fcc8e,0xc,_0x990e30[0xd]),_0x127f64=_0x3070c6(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x2c6d5f,0x11,_0x990e30[0xe]),_0x4ac229=_0x3070c6(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x5ad202,0x16,_0x990e30[0xf]),_0x491cd6=_0x5579fb(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x3b1557,0x5,_0x990e30[0x10]),_0x35d089=_0x5579fb(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x48d437,0x9,_0x990e30[0x11]),_0x127f64=_0x5579fb(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x3217ef,0xe,_0x990e30[0x12]),_0x4ac229=_0x5579fb(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x5b9380,0x14,_0x990e30[0x13]),_0x491cd6=_0x5579fb(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x121d18,0x5,_0x990e30[0x14]),_0x35d089=_0x5579fb(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x40a52,0x9,_0x990e30[0x15]),_0x127f64=_0x5579fb(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x5ad202,0xe,_0x990e30[0x16]),_0x4ac229=_0x5579fb(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x2a0c66,0x14,_0x990e30[0x17]),_0x491cd6=_0x5579fb(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x33b7c1,0x5,_0x990e30[0x18]),_0x35d089=_0x5579fb(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x2c6d5f,0x9,_0x990e30[0x19]),_0x127f64=_0x5579fb(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x2a675f,0xe,_0x990e30[0x1a]),_0x4ac229=_0x5579fb(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x540a35,0x14,_0x990e30[0x1b]),_0x491cd6=_0x5579fb(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x4fcc8e,0x5,_0x990e30[0x1c]),_0x35d089=_0x5579fb(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x3c0002,0x9,_0x990e30[0x1d]),_0x127f64=_0x5579fb(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x22fe22,0xe,_0x990e30[0x1e]),_0x4ac229=_0x5579fb(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x19accb,0x14,_0x990e30[0x1f]),_0x491cd6=_0x36c839(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x121d18,0x4,_0x990e30[0x20]),_0x35d089=_0x36c839(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x540a35,0xb,_0x990e30[0x21]),_0x127f64=_0x36c839(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x3217ef,0x10,_0x990e30[0x22]),_0x4ac229=_0x36c839(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x2c6d5f,0x17,_0x990e30[0x23]),_0x491cd6=_0x36c839(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x3b1557,0x4,_0x990e30[0x24]),_0x35d089=_0x36c839(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x2a0c66,0xb,_0x990e30[0x25]),_0x127f64=_0x36c839(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x22fe22,0x10,_0x990e30[0x26]),_0x4ac229=_0x36c839(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x40a52,0x17,_0x990e30[0x27]),_0x491cd6=_0x36c839(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x4fcc8e,0x4,_0x990e30[0x28]),_0x35d089=_0x36c839(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x5b9380,0xb,_0x990e30[0x29]),_0x127f64=_0x36c839(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x2a675f,0x10,_0x990e30[0x2a]),_0x4ac229=_0x36c839(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x48d437,0x17,_0x990e30[0x2b]),_0x491cd6=_0x36c839(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x33b7c1,0x4,_0x990e30[0x2c]),_0x35d089=_0x36c839(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x19accb,0xb,_0x990e30[0x2d]),_0x127f64=_0x36c839(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x5ad202,0x10,_0x990e30[0x2e]),_0x4ac229=_0x36c839(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x3c0002,0x17,_0x990e30[0x2f]),_0x491cd6=_0x583cc5(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x5b9380,0x6,_0x990e30[0x30]),_0x35d089=_0x583cc5(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x22fe22,0xa,_0x990e30[0x31]),_0x127f64=_0x583cc5(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x2c6d5f,0xf,_0x990e30[0x32]),_0x4ac229=_0x583cc5(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x121d18,0x15,_0x990e30[0x33]),_0x491cd6=_0x583cc5(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x19accb,0x6,_0x990e30[0x34]),_0x35d089=_0x583cc5(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x2a675f,0xa,_0x990e30[0x35]),_0x127f64=_0x583cc5(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x40a52,0xf,_0x990e30[0x36]),_0x4ac229=_0x583cc5(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x3b1557,0x15,_0x990e30[0x37]),_0x491cd6=_0x583cc5(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x540a35,0x6,_0x990e30[0x38]),_0x35d089=_0x583cc5(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x5ad202,0xa,_0x990e30[0x39]),_0x127f64=_0x583cc5(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x48d437,0xf,_0x990e30[0x3a]),_0x4ac229=_0x583cc5(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x4fcc8e,0x15,_0x990e30[0x3b]),_0x491cd6=_0x583cc5(_0x491cd6,_0x4ac229,_0x127f64,_0x35d089,_0x2a0c66,0x6,_0x990e30[0x3c]),_0x35d089=_0x583cc5(_0x35d089,_0x491cd6,_0x4ac229,_0x127f64,_0x3217ef,0xa,_0x990e30[0x3d]),_0x127f64=_0x583cc5(_0x127f64,_0x35d089,_0x491cd6,_0x4ac229,_0x3c0002,0xf,_0x990e30[0x3e]),_0x4ac229=_0x583cc5(_0x4ac229,_0x127f64,_0x35d089,_0x491cd6,_0x33b7c1,0x15,_0x990e30[0x3f]),_0x5cbf84[0x0]=_0x5cbf84[0x0]+_0x491cd6|0x0,_0x5cbf84[0x1]=_0x5cbf84[0x1]+_0x4ac229|0x0,_0x5cbf84[0x2]=_0x5cbf84[0x2]+_0x127f64|0x0,_0x5cbf84[0x3]=_0x5cbf84[0x3]+_0x35d089|0x0;&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x16b698=this[&#x27;_data&#x27;],_0x517da2=_0x16b698[&#x27;words&#x27;],_0x516958=0x8*this[&#x27;_nDataBytes&#x27;],_0x368fd2=0x8*_0x16b698[&#x27;sigBytes&#x27;];_0x517da2[_0x368fd2&gt;&gt;&gt;0x5]|=0x80&lt;&lt;0x18-_0x368fd2%0x20;var _0x2d9713=_0x40a714[&#x27;floor&#x27;](_0x516958/0x100000000),_0x4f1cd0=_0x516958;_0x517da2[0xf+(_0x368fd2+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=0xff00ff&amp;(_0x2d9713&lt;&lt;0x8|_0x2d9713&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x2d9713&lt;&lt;0x18|_0x2d9713&gt;&gt;&gt;0x8),_0x517da2[0xe+(_0x368fd2+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=0xff00ff&amp;(_0x4f1cd0&lt;&lt;0x8|_0x4f1cd0&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x4f1cd0&lt;&lt;0x18|_0x4f1cd0&gt;&gt;&gt;0x8),_0x16b698[&#x27;sigBytes&#x27;]=0x4*(_0x517da2[&#x27;length&#x27;]+0x1),this[&#x27;_process&#x27;]();for(var _0xb226bb=this[&#x27;_hash&#x27;],_0x2e2e08=_0xb226bb[&#x27;words&#x27;],_0x2b9612=0x0;_0x2b9612&lt;0x4;_0x2b9612++)&#123;var _0x12cfb0=_0x2e2e08[_0x2b9612];_0x2e2e08[_0x2b9612]=0xff00ff&amp;(_0x12cfb0&lt;&lt;0x8|_0x12cfb0&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x12cfb0&lt;&lt;0x18|_0x12cfb0&gt;&gt;&gt;0x8);&#125;return _0xb226bb;&#125;,&#x27;clone&#x27;:function()&#123;var _0x1abf01=_0x3cef6b[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x1abf01[&#x27;_hash&#x27;]=this[&#x27;_hash&#x27;][&#x27;clone&#x27;](),_0x1abf01;&#125;&#125;);function _0x3070c6(_0x656043,_0x27a61a,_0x484280,_0x4c0add,_0x4ab2ed,_0x1e2e46,_0x63ee4d)&#123;var _0x188d90=_0x656043+(_0x27a61a&amp;_0x484280|~_0x27a61a&amp;_0x4c0add)+_0x4ab2ed+_0x63ee4d;return(_0x188d90&lt;&lt;_0x1e2e46|_0x188d90&gt;&gt;&gt;0x20-_0x1e2e46)+_0x27a61a;&#125;function _0x5579fb(_0xeeed99,_0x384631,_0x1ed2ac,_0x423424,_0x31751c,_0x240902,_0x222707)&#123;var _0x417dd5=_0xeeed99+(_0x384631&amp;_0x423424|_0x1ed2ac&amp;~_0x423424)+_0x31751c+_0x222707;return(_0x417dd5&lt;&lt;_0x240902|_0x417dd5&gt;&gt;&gt;0x20-_0x240902)+_0x384631;&#125;function _0x36c839(_0x3bf8e8,_0x2a506e,_0x2c1626,_0x432468,_0x5d1010,_0x12caf8,_0x59c109)&#123;var _0x12723e=_0x3bf8e8+(_0x2a506e^_0x2c1626^_0x432468)+_0x5d1010+_0x59c109;return(_0x12723e&lt;&lt;_0x12caf8|_0x12723e&gt;&gt;&gt;0x20-_0x12caf8)+_0x2a506e;&#125;function _0x583cc5(_0xbfa10,_0x580c94,_0x393998,_0x4d71ba,_0x1bb156,_0x511e73,_0xf1759)&#123;var _0x2dcb80=_0xbfa10+(_0x393998^(_0x580c94|~_0x4d71ba))+_0x1bb156+_0xf1759;return(_0x2dcb80&lt;&lt;_0x511e73|_0x2dcb80&gt;&gt;&gt;0x20-_0x511e73)+_0x580c94;&#125;_0x49d531[&#x27;MD5&#x27;]=_0x3cef6b[&#x27;_createHelper&#x27;](_0x130439),_0x49d531[&#x27;HmacMD5&#x27;]=_0x3cef6b[&#x27;_createHmacHelper&#x27;](_0x130439);&#125;(Math),_0x2c8084[&#x27;MD5&#x27;];&#125;));&#125;,&#x27;7bbc&#x27;:function(_0x29d408,_0x3a781a,_0x31a39d)&#123;(function(_0x2c4850,_0x47838a,_0x3dea55)&#123;_0x29d408[&#x27;exports&#x27;]=_0x47838a(_0x31a39d(&#x27;21bf&#x27;),_0x31a39d(&#x27;df2f&#x27;),_0x31a39d(&#x27;5980&#x27;));&#125;(0x0,function(_0x46d5d1)&#123;return function()&#123;var _0x4e8d72=_0x46d5d1,_0x376025=_0x4e8d72[&#x27;lib&#x27;],_0x5a95a8=_0x376025[&#x27;Base&#x27;],_0x3c4e41=_0x376025[&#x27;WordArray&#x27;],_0x4e33b0=_0x4e8d72[&#x27;algo&#x27;],_0x2cffec=_0x4e33b0[&#x27;SHA1&#x27;],_0x31a239=_0x4e33b0[&#x27;HMAC&#x27;],_0x25b85a=_0x4e33b0[&#x27;PBKDF2&#x27;]=_0x5a95a8[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x5a95a8[&#x27;extend&#x27;](&#123;&#x27;keySize&#x27;:0x4,&#x27;hasher&#x27;:_0x2cffec,&#x27;iterations&#x27;:0x1&#125;),&#x27;init&#x27;:function(_0x3075e2)&#123;this[&#x27;cfg&#x27;]=this[&#x27;cfg&#x27;][&#x27;extend&#x27;](_0x3075e2);&#125;,&#x27;compute&#x27;:function(_0x581787,_0x1d3396)&#123;var _0xdb0d2e=this[&#x27;cfg&#x27;],_0x3b96c8=_0x31a239[&#x27;create&#x27;](_0xdb0d2e[&#x27;hasher&#x27;],_0x581787),_0x971435=_0x3c4e41[&#x27;create&#x27;](),_0x5b2255=_0x3c4e41[&#x27;create&#x27;]([0x1]),_0x272e38=_0x971435[&#x27;words&#x27;],_0x299a4b=_0x5b2255[&#x27;words&#x27;],_0x39ff4=_0xdb0d2e[&#x27;keySize&#x27;],_0x3038e4=_0xdb0d2e[&#x27;iterations&#x27;];while(_0x272e38[&#x27;length&#x27;]&lt;_0x39ff4)&#123;var _0x18b6e4=_0x3b96c8[&#x27;update&#x27;](_0x1d3396)[&#x27;finalize&#x27;](_0x5b2255);_0x3b96c8[&#x27;reset&#x27;]();for(var _0x1bc1c5=_0x18b6e4[&#x27;words&#x27;],_0x22f788=_0x1bc1c5[&#x27;length&#x27;],_0xb47833=_0x18b6e4,_0x522156=0x1;_0x522156&lt;_0x3038e4;_0x522156++)&#123;_0xb47833=_0x3b96c8[&#x27;finalize&#x27;](_0xb47833),_0x3b96c8[&#x27;reset&#x27;]();for(var _0x44395a=_0xb47833[&#x27;words&#x27;],_0x5e9288=0x0;_0x5e9288&lt;_0x22f788;_0x5e9288++)_0x1bc1c5[_0x5e9288]^=_0x44395a[_0x5e9288];&#125;_0x971435[&#x27;concat&#x27;](_0x18b6e4),_0x299a4b[0x0]++;&#125;return _0x971435[&#x27;sigBytes&#x27;]=0x4*_0x39ff4,_0x971435;&#125;&#125;);_0x4e8d72[&#x27;PBKDF2&#x27;]=function(_0x2beb95,_0x19d7da,_0x2e1d67)&#123;return _0x25b85a[&#x27;create&#x27;](_0x2e1d67)[&#x27;compute&#x27;](_0x2beb95,_0x19d7da);&#125;;&#125;(),_0x46d5d1[&#x27;PBKDF2&#x27;];&#125;));&#125;,&#x27;7d92&#x27;:function(_0x1e1673,_0x29aaea,_0x34777a)&#123;&#x27;use strict&#x27;;_0x34777a(&#x27;6b54&#x27;);var _0x189cbb=_0x34777a(&#x27;3452&#x27;),_0x358b1f=_0x34777a(&#x27;27ae&#x27;)[&#x27;Base64&#x27;];function _0x456254()&#123;for(var _0x5da681=Math[&#x27;round&#x27;](new Date()[&#x27;getTime&#x27;]()/0x3e8)[&#x27;toString&#x27;](),_0x2a83dd=arguments[&#x27;length&#x27;],_0x31a891=new Array(_0x2a83dd),_0x596a02=0x0;_0x596a02&lt;_0x2a83dd;_0x596a02++)_0x31a891[_0x596a02]=arguments[_0x596a02];_0x31a891[&#x27;push&#x27;](_0x5da681);var _0xf7c3c7=_0x189cbb[&#x27;SHA1&#x27;](_0x31a891[&#x27;join&#x27;](&#x27;,&#x27;))[&#x27;toString&#x27;](_0x189cbb[&#x27;enc&#x27;][&#x27;Hex&#x27;]),_0x3c8435=[_0xf7c3c7,_0x5da681][&#x27;join&#x27;](&#x27;,&#x27;),_0x104b5b=_0x358b1f[&#x27;encode&#x27;](_0x3c8435);return _0x104b5b;&#125;_0x29aaea[&#x27;a&#x27;]=_0x456254;&#125;,&#x27;81bf&#x27;:function(_0x2e34f4,_0x5ac408,_0x383034)&#123;(function(_0x14b5ca,_0x24012e,_0x4cf641)&#123;_0x2e34f4[&#x27;exports&#x27;]=_0x24012e(_0x383034(&#x27;21bf&#x27;),_0x383034(&#x27;38ba&#x27;));&#125;(0x0,function(_0x4112fc)&#123;return _0x4112fc[&#x27;mode&#x27;][&#x27;ECB&#x27;]=function()&#123;var _0x48c751=_0x4112fc[&#x27;lib&#x27;][&#x27;BlockCipherMode&#x27;][&#x27;extend&#x27;]();return _0x48c751[&#x27;Encryptor&#x27;]=_0x48c751[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x578df0,_0x4a649d)&#123;this[&#x27;_cipher&#x27;][&#x27;encryptBlock&#x27;](_0x578df0,_0x4a649d);&#125;&#125;),_0x48c751[&#x27;Decryptor&#x27;]=_0x48c751[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x3dc393,_0x3603e)&#123;this[&#x27;_cipher&#x27;][&#x27;decryptBlock&#x27;](_0x3dc393,_0x3603e);&#125;&#125;),_0x48c751;&#125;(),_0x4112fc[&#x27;mode&#x27;][&#x27;ECB&#x27;];&#125;));&#125;,&#x27;8cef&#x27;:function(_0x272b19,_0x249db7,_0x41f973)&#123;(function(_0x2ef002,_0x1a21c3,_0x1c3eab)&#123;_0x272b19[&#x27;exports&#x27;]=_0x1a21c3(_0x41f973(&#x27;21bf&#x27;),_0x41f973(&#x27;38ba&#x27;));&#125;(0x0,function(_0x95f729)&#123;return _0x95f729[&#x27;pad&#x27;][&#x27;Iso97971&#x27;]=&#123;&#x27;pad&#x27;:function(_0x208e17,_0x3b4c8e)&#123;_0x208e17[&#x27;concat&#x27;](_0x95f729[&#x27;lib&#x27;][&#x27;WordArray&#x27;][&#x27;create&#x27;]([0x80000000],0x1)),_0x95f729[&#x27;pad&#x27;][&#x27;ZeroPadding&#x27;][&#x27;pad&#x27;](_0x208e17,_0x3b4c8e);&#125;,&#x27;unpad&#x27;:function(_0x441676)&#123;_0x95f729[&#x27;pad&#x27;][&#x27;ZeroPadding&#x27;][&#x27;unpad&#x27;](_0x441676),_0x441676[&#x27;sigBytes&#x27;]--;&#125;&#125;,_0x95f729[&#x27;pad&#x27;][&#x27;Iso97971&#x27;];&#125;));&#125;,&#x27;94f8&#x27;:function(_0x5c4483,_0x3bf638,_0x468d6a)&#123;(function(_0x391b74,_0x31c16e)&#123;_0x5c4483[&#x27;exports&#x27;]=_0x31c16e(_0x468d6a(&#x27;21bf&#x27;));&#125;(0x0,function(_0x4cbd81)&#123;return function(_0x2458d9)&#123;var _0x42234e=_0x4cbd81,_0x304cf3=_0x42234e[&#x27;lib&#x27;],_0x1c8a8e=_0x304cf3[&#x27;WordArray&#x27;],_0x1147c5=_0x304cf3[&#x27;Hasher&#x27;],_0x566118=_0x42234e[&#x27;algo&#x27;],_0x29f01f=[],_0x30e251=[];(function()&#123;function _0x24a71f(_0x513b54)&#123;for(var _0x5602ed=_0x2458d9[&#x27;sqrt&#x27;](_0x513b54),_0x392b4f=0x2;_0x392b4f&lt;=_0x5602ed;_0x392b4f++)if(!(_0x513b54%_0x392b4f))return!0x1;return!0x0;&#125;function _0x147268(_0x520f79)&#123;return 0x100000000*(_0x520f79-(0x0|_0x520f79))|0x0;&#125;var _0x5d587d=0x2,_0x43c519=0x0;while(_0x43c519&lt;0x40)_0x24a71f(_0x5d587d)&amp;&amp;(_0x43c519&lt;0x8&amp;&amp;(_0x29f01f[_0x43c519]=_0x147268(_0x2458d9[&#x27;pow&#x27;](_0x5d587d,0.5))),_0x30e251[_0x43c519]=_0x147268(_0x2458d9[&#x27;pow&#x27;](_0x5d587d,0x1/0x3)),_0x43c519++),_0x5d587d++;&#125;());var _0x43664e=[],_0x159518=_0x566118[&#x27;SHA256&#x27;]=_0x1147c5[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x1c8a8e[&#x27;init&#x27;](_0x29f01f[&#x27;slice&#x27;](0x0));&#125;,&#x27;_doProcessBlock&#x27;:function(_0x21654b,_0x3a0c1c)&#123;for(var _0x5c0bf7=this[&#x27;_hash&#x27;][&#x27;words&#x27;],_0x56950d=_0x5c0bf7[0x0],_0x128932=_0x5c0bf7[0x1],_0x4e3fe6=_0x5c0bf7[0x2],_0xead20d=_0x5c0bf7[0x3],_0x481147=_0x5c0bf7[0x4],_0x2541de=_0x5c0bf7[0x5],_0xb8323d=_0x5c0bf7[0x6],_0xe66e10=_0x5c0bf7[0x7],_0x3acb59=0x0;_0x3acb59&lt;0x40;_0x3acb59++)&#123;if(_0x3acb59&lt;0x10)_0x43664e[_0x3acb59]=0x0|_0x21654b[_0x3a0c1c+_0x3acb59];else&#123;var _0x2128b3=_0x43664e[_0x3acb59-0xf],_0x5f143c=(_0x2128b3&lt;&lt;0x19|_0x2128b3&gt;&gt;&gt;0x7)^(_0x2128b3&lt;&lt;0xe|_0x2128b3&gt;&gt;&gt;0x12)^_0x2128b3&gt;&gt;&gt;0x3,_0x24773a=_0x43664e[_0x3acb59-0x2],_0x4ca0e6=(_0x24773a&lt;&lt;0xf|_0x24773a&gt;&gt;&gt;0x11)^(_0x24773a&lt;&lt;0xd|_0x24773a&gt;&gt;&gt;0x13)^_0x24773a&gt;&gt;&gt;0xa;_0x43664e[_0x3acb59]=_0x5f143c+_0x43664e[_0x3acb59-0x7]+_0x4ca0e6+_0x43664e[_0x3acb59-0x10];&#125;var _0xba2c0a=_0x481147&amp;_0x2541de^~_0x481147&amp;_0xb8323d,_0x37dda9=_0x56950d&amp;_0x128932^_0x56950d&amp;_0x4e3fe6^_0x128932&amp;_0x4e3fe6,_0x3d9a39=(_0x56950d&lt;&lt;0x1e|_0x56950d&gt;&gt;&gt;0x2)^(_0x56950d&lt;&lt;0x13|_0x56950d&gt;&gt;&gt;0xd)^(_0x56950d&lt;&lt;0xa|_0x56950d&gt;&gt;&gt;0x16),_0x4c06da=(_0x481147&lt;&lt;0x1a|_0x481147&gt;&gt;&gt;0x6)^(_0x481147&lt;&lt;0x15|_0x481147&gt;&gt;&gt;0xb)^(_0x481147&lt;&lt;0x7|_0x481147&gt;&gt;&gt;0x19),_0x526aaa=_0xe66e10+_0x4c06da+_0xba2c0a+_0x30e251[_0x3acb59]+_0x43664e[_0x3acb59],_0x5bf56b=_0x3d9a39+_0x37dda9;_0xe66e10=_0xb8323d,_0xb8323d=_0x2541de,_0x2541de=_0x481147,_0x481147=_0xead20d+_0x526aaa|0x0,_0xead20d=_0x4e3fe6,_0x4e3fe6=_0x128932,_0x128932=_0x56950d,_0x56950d=_0x526aaa+_0x5bf56b|0x0;&#125;_0x5c0bf7[0x0]=_0x5c0bf7[0x0]+_0x56950d|0x0,_0x5c0bf7[0x1]=_0x5c0bf7[0x1]+_0x128932|0x0,_0x5c0bf7[0x2]=_0x5c0bf7[0x2]+_0x4e3fe6|0x0,_0x5c0bf7[0x3]=_0x5c0bf7[0x3]+_0xead20d|0x0,_0x5c0bf7[0x4]=_0x5c0bf7[0x4]+_0x481147|0x0,_0x5c0bf7[0x5]=_0x5c0bf7[0x5]+_0x2541de|0x0,_0x5c0bf7[0x6]=_0x5c0bf7[0x6]+_0xb8323d|0x0,_0x5c0bf7[0x7]=_0x5c0bf7[0x7]+_0xe66e10|0x0;&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0xa889a7=this[&#x27;_data&#x27;],_0x5d88ea=_0xa889a7[&#x27;words&#x27;],_0x27ba27=0x8*this[&#x27;_nDataBytes&#x27;],_0x1ec275=0x8*_0xa889a7[&#x27;sigBytes&#x27;];return _0x5d88ea[_0x1ec275&gt;&gt;&gt;0x5]|=0x80&lt;&lt;0x18-_0x1ec275%0x20,_0x5d88ea[0xe+(_0x1ec275+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=_0x2458d9[&#x27;floor&#x27;](_0x27ba27/0x100000000),_0x5d88ea[0xf+(_0x1ec275+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=_0x27ba27,_0xa889a7[&#x27;sigBytes&#x27;]=0x4*_0x5d88ea[&#x27;length&#x27;],this[&#x27;_process&#x27;](),this[&#x27;_hash&#x27;];&#125;,&#x27;clone&#x27;:function()&#123;var _0x163178=_0x1147c5[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x163178[&#x27;_hash&#x27;]=this[&#x27;_hash&#x27;][&#x27;clone&#x27;](),_0x163178;&#125;&#125;);_0x42234e[&#x27;SHA256&#x27;]=_0x1147c5[&#x27;_createHelper&#x27;](_0x159518),_0x42234e[&#x27;HmacSHA256&#x27;]=_0x1147c5[&#x27;_createHmacHelper&#x27;](_0x159518);&#125;(Math),_0x4cbd81[&#x27;SHA256&#x27;];&#125;));&#125;,&#x27;a11b&#x27;:function(_0x4de412,_0x5cb9c6,_0x55b593)&#123;(function(_0x252974,_0x5b8180,_0x44cf4c)&#123;_0x4de412[&#x27;exports&#x27;]=_0x5b8180(_0x55b593(&#x27;21bf&#x27;),_0x55b593(&#x27;38ba&#x27;));&#125;(0x0,function(_0x535166)&#123;return _0x535166[&#x27;pad&#x27;][&#x27;Iso10126&#x27;]=&#123;&#x27;pad&#x27;:function(_0x4a0056,_0xcc6bb6)&#123;var _0x323886=0x4*_0xcc6bb6,_0x3b67d8=_0x323886-_0x4a0056[&#x27;sigBytes&#x27;]%_0x323886;_0x4a0056[&#x27;concat&#x27;](_0x535166[&#x27;lib&#x27;][&#x27;WordArray&#x27;][&#x27;random&#x27;](_0x3b67d8-0x1))[&#x27;concat&#x27;](_0x535166[&#x27;lib&#x27;][&#x27;WordArray&#x27;][&#x27;create&#x27;]([_0x3b67d8&lt;&lt;0x18],0x1));&#125;,&#x27;unpad&#x27;:function(_0x1e03a3)&#123;var _0x3e0421=0xff&amp;_0x1e03a3[&#x27;words&#x27;][_0x1e03a3[&#x27;sigBytes&#x27;]-0x1&gt;&gt;&gt;0x2];_0x1e03a3[&#x27;sigBytes&#x27;]-=_0x3e0421;&#125;&#125;,_0x535166[&#x27;pad&#x27;][&#x27;Iso10126&#x27;];&#125;));&#125;,&#x27;a40e&#x27;:function(_0x4807f1,_0x880c55,_0x314a04)&#123;(function(_0x3b01aa,_0x1bcf58,_0x29f414)&#123;_0x4807f1[&#x27;exports&#x27;]=_0x1bcf58(_0x314a04(&#x27;21bf&#x27;),_0x314a04(&#x27;1132&#x27;),_0x314a04(&#x27;72fe&#x27;),_0x314a04(&#x27;2b79&#x27;),_0x314a04(&#x27;38ba&#x27;));&#125;(0x0,function(_0x3e3a4b)&#123;return function()&#123;var _0x233c6d=_0x3e3a4b,_0x4e3af7=_0x233c6d[&#x27;lib&#x27;],_0x425b0f=_0x4e3af7[&#x27;WordArray&#x27;],_0x7f552e=_0x4e3af7[&#x27;BlockCipher&#x27;],_0xa0e001=_0x233c6d[&#x27;algo&#x27;],_0x3c0b39=[0x39,0x31,0x29,0x21,0x19,0x11,0x9,0x1,0x3a,0x32,0x2a,0x22,0x1a,0x12,0xa,0x2,0x3b,0x33,0x2b,0x23,0x1b,0x13,0xb,0x3,0x3c,0x34,0x2c,0x24,0x3f,0x37,0x2f,0x27,0x1f,0x17,0xf,0x7,0x3e,0x36,0x2e,0x26,0x1e,0x16,0xe,0x6,0x3d,0x35,0x2d,0x25,0x1d,0x15,0xd,0x5,0x1c,0x14,0xc,0x4],_0x8982=[0xe,0x11,0xb,0x18,0x1,0x5,0x3,0x1c,0xf,0x6,0x15,0xa,0x17,0x13,0xc,0x4,0x1a,0x8,0x10,0x7,0x1b,0x14,0xd,0x2,0x29,0x34,0x1f,0x25,0x2f,0x37,0x1e,0x28,0x33,0x2d,0x21,0x30,0x2c,0x31,0x27,0x38,0x22,0x35,0x2e,0x2a,0x32,0x24,0x1d,0x20],_0x191df8=[0x1,0x2,0x4,0x6,0x8,0xa,0xc,0xe,0xf,0x11,0x13,0x15,0x17,0x19,0x1b,0x1c],_0x2c821a=[&#123;0:0x808200,268435456:0x8000,536870912:0x808002,805306368:0x2,1073741824:0x200,1342177280:0x808202,1610612736:0x800202,1879048192:0x800000,2147483648:0x202,2415919104:0x800200,2684354560:0x8200,2952790016:0x808000,3221225472:0x8002,3489660928:0x800002,3758096384:0x0,4026531840:0x8202,134217728:0x0,402653184:0x808202,671088640:0x8202,939524096:0x8000,1207959552:0x808200,1476395008:0x200,1744830464:0x808002,2013265920:0x2,2281701376:0x800200,2550136832:0x8200,2818572288:0x808000,3087007744:0x800202,3355443200:0x800002,3623878656:0x8002,3892314112:0x202,4160749568:0x800000,1:0x8000,268435457:0x2,536870913:0x808200,805306369:0x800000,1073741825:0x808002,1342177281:0x8200,1610612737:0x200,1879048193:0x800202,2147483649:0x808202,2415919105:0x808000,2684354561:0x800002,2952790017:0x8202,3221225473:0x202,3489660929:0x800200,3758096385:0x8002,4026531841:0x0,134217729:0x808202,402653185:0x808000,671088641:0x800000,939524097:0x200,1207959553:0x8000,1476395009:0x800002,1744830465:0x2,2013265921:0x8202,2281701377:0x8002,2550136833:0x800202,2818572289:0x202,3087007745:0x808200,3355443201:0x800200,3623878657:0x0,3892314113:0x8200,4160749569:0x808002&#125;,&#123;0:0x40084010,16777216:0x4000,33554432:0x80000,50331648:0x40080010,67108864:0x40000010,83886080:0x40084000,100663296:0x40004000,117440512:0x10,134217728:0x84000,150994944:0x40004010,167772160:0x40000000,184549376:0x84010,201326592:0x80010,218103808:0x0,234881024:0x4010,251658240:0x40080000,8388608:0x40004000,25165824:0x84010,41943040:0x10,58720256:0x40004010,75497472:0x40084010,92274688:0x40000000,109051904:0x80000,125829120:0x40080010,142606336:0x80010,159383552:0x0,176160768:0x4000,192937984:0x40080000,209715200:0x40000010,226492416:0x84000,243269632:0x40084000,260046848:0x4010,268435456:0x0,285212672:0x40080010,301989888:0x40004010,318767104:0x40084000,335544320:0x40080000,352321536:0x10,369098752:0x84010,385875968:0x4000,402653184:0x4010,419430400:0x80000,436207616:0x80010,452984832:0x40000010,469762048:0x84000,486539264:0x40004000,503316480:0x40000000,520093696:0x40084010,276824064:0x84010,293601280:0x80000,310378496:0x40080000,327155712:0x4000,343932928:0x40004000,360710144:0x40084010,377487360:0x10,394264576:0x40000000,411041792:0x40084000,427819008:0x40000010,444596224:0x40004010,461373440:0x80010,478150656:0x0,494927872:0x4010,511705088:0x40080010,528482304:0x84000&#125;,&#123;0:0x104,1048576:0x0,2097152:0x4000100,3145728:0x10104,4194304:0x10004,5242880:0x4000004,6291456:0x4010104,7340032:0x4010000,8388608:0x4000000,9437184:0x4010100,10485760:0x10100,11534336:0x4010004,12582912:0x4000104,13631488:0x10000,14680064:0x4,15728640:0x100,524288:0x4010100,1572864:0x4010004,2621440:0x0,3670016:0x4000100,4718592:0x4000004,5767168:0x10000,6815744:0x10004,7864320:0x104,8912896:0x4,9961472:0x100,11010048:0x4010000,12058624:0x10104,13107200:0x10100,14155776:0x4000104,15204352:0x4010104,16252928:0x4000000,16777216:0x4010100,17825792:0x10004,18874368:0x10000,19922944:0x4000100,20971520:0x100,22020096:0x4010104,23068672:0x4000004,24117248:0x0,25165824:0x4000104,26214400:0x4000000,27262976:0x4,28311552:0x10100,29360128:0x4010000,30408704:0x104,31457280:0x10104,32505856:0x4010004,17301504:0x4000000,18350080:0x104,19398656:0x4010100,20447232:0x0,21495808:0x10004,22544384:0x4000100,23592960:0x100,24641536:0x4010004,25690112:0x10000,26738688:0x4010104,27787264:0x10104,28835840:0x4000004,29884416:0x4000104,30932992:0x4010000,31981568:0x4,33030144:0x10100&#125;,&#123;0:0x80401000,65536:0x80001040,131072:0x401040,196608:0x80400000,262144:0x0,327680:0x401000,393216:0x80000040,458752:0x400040,524288:0x80000000,589824:0x400000,655360:0x40,720896:0x80001000,786432:0x80400040,851968:0x1040,917504:0x1000,983040:0x80401040,32768:0x80001040,98304:0x40,163840:0x80400040,229376:0x80001000,294912:0x401000,360448:0x80401040,425984:0x0,491520:0x80400000,557056:0x1000,622592:0x80401000,688128:0x400000,753664:0x1040,819200:0x80000000,884736:0x400040,950272:0x401040,1015808:0x80000040,1048576:0x400040,1114112:0x401000,1179648:0x80000040,1245184:0x0,1310720:0x1040,1376256:0x80400040,1441792:0x80401000,1507328:0x80001040,1572864:0x80401040,1638400:0x80000000,1703936:0x80400000,1769472:0x401040,1835008:0x80001000,1900544:0x400000,1966080:0x40,2031616:0x1000,1081344:0x80400000,1146880:0x80401040,1212416:0x0,1277952:0x401000,1343488:0x400040,1409024:0x80000000,1474560:0x80001040,1540096:0x40,1605632:0x80000040,1671168:0x1000,1736704:0x80001000,1802240:0x80400040,1867776:0x1040,1933312:0x80401000,1998848:0x400000,2064384:0x401040&#125;,&#123;0:0x80,4096:0x1040000,8192:0x40000,12288:0x20000000,16384:0x20040080,20480:0x1000080,24576:0x21000080,28672:0x40080,32768:0x1000000,36864:0x20040000,40960:0x20000080,45056:0x21040080,49152:0x21040000,53248:0x0,57344:0x1040080,61440:0x21000000,2048:0x1040080,6144:0x21000080,10240:0x80,14336:0x1040000,18432:0x40000,22528:0x20040080,26624:0x21040000,30720:0x20000000,34816:0x20040000,38912:0x0,43008:0x21040080,47104:0x1000080,51200:0x20000080,55296:0x21000000,59392:0x1000000,63488:0x40080,65536:0x40000,69632:0x80,73728:0x20000000,77824:0x21000080,81920:0x1000080,86016:0x21040000,90112:0x20040080,94208:0x1000000,98304:0x21040080,102400:0x21000000,106496:0x1040000,110592:0x20040000,114688:0x40080,118784:0x20000080,122880:0x0,126976:0x1040080,67584:0x21000080,71680:0x1000000,75776:0x1040000,79872:0x20040080,83968:0x20000000,88064:0x1040080,92160:0x80,96256:0x21040000,100352:0x40080,104448:0x21040080,108544:0x0,112640:0x21000000,116736:0x1000080,120832:0x40000,124928:0x20040000,129024:0x20000080&#125;,&#123;0:0x10000008,256:0x2000,512:0x10200000,768:0x10202008,1024:0x10002000,1280:0x200000,1536:0x200008,1792:0x10000000,2048:0x0,2304:0x10002008,2560:0x202000,2816:0x8,3072:0x10200008,3328:0x202008,3584:0x2008,3840:0x10202000,128:0x10200000,384:0x10202008,640:0x8,896:0x200000,1152:0x202008,1408:0x10000008,1664:0x10002000,1920:0x2008,2176:0x200008,2432:0x2000,2688:0x10002008,2944:0x10200008,3200:0x0,3456:0x10202000,3712:0x202000,3968:0x10000000,4096:0x10002000,4352:0x10200008,4608:0x10202008,4864:0x2008,5120:0x200000,5376:0x10000000,5632:0x10000008,5888:0x202000,6144:0x202008,6400:0x0,6656:0x8,6912:0x10200000,7168:0x2000,7424:0x10002008,7680:0x10202000,7936:0x200008,4224:0x8,4480:0x202000,4736:0x200000,4992:0x10000008,5248:0x10002000,5504:0x2008,5760:0x10202008,6016:0x10200000,6272:0x10202000,6528:0x10200008,6784:0x2000,7040:0x202008,7296:0x200008,7552:0x0,7808:0x10000000,8064:0x10002008&#125;,&#123;0:0x100000,16:0x2000401,32:0x400,48:0x100401,64:0x2100401,80:0x0,96:0x1,112:0x2100001,128:0x2000400,144:0x100001,160:0x2000001,176:0x2100400,192:0x2100000,208:0x401,224:0x100400,240:0x2000000,8:0x2100001,24:0x0,40:0x2000401,56:0x2100400,72:0x100000,88:0x2000001,104:0x2000000,120:0x401,136:0x100401,152:0x2000400,168:0x2100000,184:0x100001,200:0x400,216:0x2100401,232:0x1,248:0x100400,256:0x2000000,272:0x100000,288:0x2000401,304:0x2100001,320:0x100001,336:0x2000400,352:0x2100400,368:0x100401,384:0x401,400:0x2100401,416:0x100400,432:0x1,448:0x0,464:0x2100000,480:0x2000001,496:0x400,264:0x100400,280:0x2000401,296:0x2100001,312:0x1,328:0x2000000,344:0x100000,360:0x401,376:0x2100400,392:0x2000001,408:0x2100000,424:0x0,440:0x2100401,456:0x100401,472:0x400,488:0x2000400,504:0x100001&#125;,&#123;0:0x8000820,1:0x20000,2:0x8000000,3:0x20,4:0x20020,5:0x8020820,6:0x8020800,7:0x800,8:0x8020000,9:0x8000800,10:0x20800,11:0x8020020,12:0x820,13:0x0,14:0x8000020,15:0x20820,2147483648:0x800,2147483649:0x8020820,2147483650:0x8000820,2147483651:0x8000000,2147483652:0x8020000,2147483653:0x20800,2147483654:0x20820,2147483655:0x20,2147483656:0x8000020,2147483657:0x820,2147483658:0x20020,2147483659:0x8020800,2147483660:0x0,2147483661:0x8020020,2147483662:0x8000800,2147483663:0x20000,16:0x20820,17:0x8020800,18:0x20,19:0x800,20:0x8000800,21:0x8000020,22:0x8020020,23:0x20000,24:0x0,25:0x20020,26:0x8020000,27:0x8000820,28:0x8020820,29:0x20800,30:0x820,31:0x8000000,2147483664:0x20000,2147483665:0x800,2147483666:0x8020020,2147483667:0x20820,2147483668:0x20,2147483669:0x8020000,2147483670:0x8000000,2147483671:0x8000820,2147483672:0x8020820,2147483673:0x8000020,2147483674:0x8000800,2147483675:0x0,2147483676:0x20800,2147483677:0x820,2147483678:0x20020,2147483679:0x8020800&#125;],_0x4a7a46=[0xf8000001,0x1f800000,0x1f80000,0x1f8000,0x1f800,0x1f80,0x1f8,0x8000001f],_0x121114=_0xa0e001[&#x27;DES&#x27;]=_0x7f552e[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;for(var _0x17239e=this[&#x27;_key&#x27;],_0x4d6992=_0x17239e[&#x27;words&#x27;],_0x374130=[],_0x3cf08d=0x0;_0x3cf08d&lt;0x38;_0x3cf08d++)&#123;var _0x3e6a6f=_0x3c0b39[_0x3cf08d]-0x1;_0x374130[_0x3cf08d]=_0x4d6992[_0x3e6a6f&gt;&gt;&gt;0x5]&gt;&gt;&gt;0x1f-_0x3e6a6f%0x20&amp;0x1;&#125;for(var _0x34f5c7=this[&#x27;_subKeys&#x27;]=[],_0x17c674=0x0;_0x17c674&lt;0x10;_0x17c674++)&#123;var _0x6d8cb7=_0x34f5c7[_0x17c674]=[],_0x54aaa3=_0x191df8[_0x17c674];for(_0x3cf08d=0x0;_0x3cf08d&lt;0x18;_0x3cf08d++)_0x6d8cb7[_0x3cf08d/0x6|0x0]|=_0x374130[(_0x8982[_0x3cf08d]-0x1+_0x54aaa3)%0x1c]&lt;&lt;0x1f-_0x3cf08d%0x6,_0x6d8cb7[0x4+(_0x3cf08d/0x6|0x0)]|=_0x374130[0x1c+(_0x8982[_0x3cf08d+0x18]-0x1+_0x54aaa3)%0x1c]&lt;&lt;0x1f-_0x3cf08d%0x6;_0x6d8cb7[0x0]=_0x6d8cb7[0x0]&lt;&lt;0x1|_0x6d8cb7[0x0]&gt;&gt;&gt;0x1f;for(_0x3cf08d=0x1;_0x3cf08d&lt;0x7;_0x3cf08d++)_0x6d8cb7[_0x3cf08d]=_0x6d8cb7[_0x3cf08d]&gt;&gt;&gt;0x4*(_0x3cf08d-0x1)+0x3;_0x6d8cb7[0x7]=_0x6d8cb7[0x7]&lt;&lt;0x5|_0x6d8cb7[0x7]&gt;&gt;&gt;0x1b;&#125;var _0x1173d2=this[&#x27;_invSubKeys&#x27;]=[];for(_0x3cf08d=0x0;_0x3cf08d&lt;0x10;_0x3cf08d++)_0x1173d2[_0x3cf08d]=_0x34f5c7[0xf-_0x3cf08d];&#125;,&#x27;encryptBlock&#x27;:function(_0x3423ed,_0x54bc7e)&#123;this[&#x27;_doCryptBlock&#x27;](_0x3423ed,_0x54bc7e,this[&#x27;_subKeys&#x27;]);&#125;,&#x27;decryptBlock&#x27;:function(_0x1012ba,_0x2a5293)&#123;this[&#x27;_doCryptBlock&#x27;](_0x1012ba,_0x2a5293,this[&#x27;_invSubKeys&#x27;]);&#125;,&#x27;_doCryptBlock&#x27;:function(_0x21377e,_0x135173,_0x34e0bc)&#123;this[&#x27;_lBlock&#x27;]=_0x21377e[_0x135173],this[&#x27;_rBlock&#x27;]=_0x21377e[_0x135173+0x1],_0x360933[&#x27;call&#x27;](this,0x4,0xf0f0f0f),_0x360933[&#x27;call&#x27;](this,0x10,0xffff),_0x3b28cc[&#x27;call&#x27;](this,0x2,0x33333333),_0x3b28cc[&#x27;call&#x27;](this,0x8,0xff00ff),_0x360933[&#x27;call&#x27;](this,0x1,0x55555555);for(var _0x4c4d02=0x0;_0x4c4d02&lt;0x10;_0x4c4d02++)&#123;for(var _0x4eb075=_0x34e0bc[_0x4c4d02],_0x3c398a=this[&#x27;_lBlock&#x27;],_0x5ed4a4=this[&#x27;_rBlock&#x27;],_0x49155f=0x0,_0x4eb3c2=0x0;_0x4eb3c2&lt;0x8;_0x4eb3c2++)_0x49155f|=_0x2c821a[_0x4eb3c2][((_0x5ed4a4^_0x4eb075[_0x4eb3c2])&amp;_0x4a7a46[_0x4eb3c2])&gt;&gt;&gt;0x0];this[&#x27;_lBlock&#x27;]=_0x5ed4a4,this[&#x27;_rBlock&#x27;]=_0x3c398a^_0x49155f;&#125;var _0x2af266=this[&#x27;_lBlock&#x27;];this[&#x27;_lBlock&#x27;]=this[&#x27;_rBlock&#x27;],this[&#x27;_rBlock&#x27;]=_0x2af266,_0x360933[&#x27;call&#x27;](this,0x1,0x55555555),_0x3b28cc[&#x27;call&#x27;](this,0x8,0xff00ff),_0x3b28cc[&#x27;call&#x27;](this,0x2,0x33333333),_0x360933[&#x27;call&#x27;](this,0x10,0xffff),_0x360933[&#x27;call&#x27;](this,0x4,0xf0f0f0f),_0x21377e[_0x135173]=this[&#x27;_lBlock&#x27;],_0x21377e[_0x135173+0x1]=this[&#x27;_rBlock&#x27;];&#125;,&#x27;keySize&#x27;:0x2,&#x27;ivSize&#x27;:0x2,&#x27;blockSize&#x27;:0x2&#125;);function _0x360933(_0x1b916d,_0x5d3017)&#123;var _0x1be584=(this[&#x27;_lBlock&#x27;]&gt;&gt;&gt;_0x1b916d^this[&#x27;_rBlock&#x27;])&amp;_0x5d3017;this[&#x27;_rBlock&#x27;]^=_0x1be584,this[&#x27;_lBlock&#x27;]^=_0x1be584&lt;&lt;_0x1b916d;&#125;function _0x3b28cc(_0x48b5bc,_0x521915)&#123;var _0x1c1c6d=(this[&#x27;_rBlock&#x27;]&gt;&gt;&gt;_0x48b5bc^this[&#x27;_lBlock&#x27;])&amp;_0x521915;this[&#x27;_lBlock&#x27;]^=_0x1c1c6d,this[&#x27;_rBlock&#x27;]^=_0x1c1c6d&lt;&lt;_0x48b5bc;&#125;_0x233c6d[&#x27;DES&#x27;]=_0x7f552e[&#x27;_createHelper&#x27;](_0x121114);var _0xab5f94=_0xa0e001[&#x27;TripleDES&#x27;]=_0x7f552e[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;var _0x4c1a4d=this[&#x27;_key&#x27;],_0x15bc2f=_0x4c1a4d[&#x27;words&#x27;];this[&#x27;_des1&#x27;]=_0x121114[&#x27;createEncryptor&#x27;](_0x425b0f[&#x27;create&#x27;](_0x15bc2f[&#x27;slice&#x27;](0x0,0x2))),this[&#x27;_des2&#x27;]=_0x121114[&#x27;createEncryptor&#x27;](_0x425b0f[&#x27;create&#x27;](_0x15bc2f[&#x27;slice&#x27;](0x2,0x4))),this[&#x27;_des3&#x27;]=_0x121114[&#x27;createEncryptor&#x27;](_0x425b0f[&#x27;create&#x27;](_0x15bc2f[&#x27;slice&#x27;](0x4,0x6)));&#125;,&#x27;encryptBlock&#x27;:function(_0x40c83b,_0x326c05)&#123;this[&#x27;_des1&#x27;][&#x27;encryptBlock&#x27;](_0x40c83b,_0x326c05),this[&#x27;_des2&#x27;][&#x27;decryptBlock&#x27;](_0x40c83b,_0x326c05),this[&#x27;_des3&#x27;][&#x27;encryptBlock&#x27;](_0x40c83b,_0x326c05);&#125;,&#x27;decryptBlock&#x27;:function(_0x4b6c68,_0xf9b26a)&#123;this[&#x27;_des3&#x27;][&#x27;decryptBlock&#x27;](_0x4b6c68,_0xf9b26a),this[&#x27;_des2&#x27;][&#x27;encryptBlock&#x27;](_0x4b6c68,_0xf9b26a),this[&#x27;_des1&#x27;][&#x27;decryptBlock&#x27;](_0x4b6c68,_0xf9b26a);&#125;,&#x27;keySize&#x27;:0x6,&#x27;ivSize&#x27;:0x2,&#x27;blockSize&#x27;:0x2&#125;);_0x233c6d[&#x27;TripleDES&#x27;]=_0x7f552e[&#x27;_createHelper&#x27;](_0xab5f94);&#125;(),_0x3e3a4b[&#x27;TripleDES&#x27;];&#125;));&#125;,&#x27;a817&#x27;:function(_0x3f2965,_0x5450ba,_0x5ef700)&#123;(function(_0xf944c5,_0x58a12f,_0x22f2e0)&#123;_0x3f2965[&#x27;exports&#x27;]=_0x58a12f(_0x5ef700(&#x27;21bf&#x27;),_0x5ef700(&#x27;38ba&#x27;));&#125;(0x0,function(_0x3b1c85)&#123;return _0x3b1c85[&#x27;pad&#x27;][&#x27;AnsiX923&#x27;]=&#123;&#x27;pad&#x27;:function(_0x2d35fe,_0x180783)&#123;var _0x341be6=_0x2d35fe[&#x27;sigBytes&#x27;],_0x381f5e=0x4*_0x180783,_0x29e06d=_0x381f5e-_0x341be6%_0x381f5e,_0x5991cd=_0x341be6+_0x29e06d-0x1;_0x2d35fe[&#x27;clamp&#x27;](),_0x2d35fe[&#x27;words&#x27;][_0x5991cd&gt;&gt;&gt;0x2]|=_0x29e06d&lt;&lt;0x18-_0x5991cd%0x4*0x8,_0x2d35fe[&#x27;sigBytes&#x27;]+=_0x29e06d;&#125;,&#x27;unpad&#x27;:function(_0x4e18cf)&#123;var _0x488345=0xff&amp;_0x4e18cf[&#x27;words&#x27;][_0x4e18cf[&#x27;sigBytes&#x27;]-0x1&gt;&gt;&gt;0x2];_0x4e18cf[&#x27;sigBytes&#x27;]-=_0x488345;&#125;&#125;,_0x3b1c85[&#x27;pad&#x27;][&#x27;Ansix923&#x27;];&#125;));&#125;,&#x27;a8ce&#x27;:function(_0x5a33c3,_0x338dcf,_0x431372)&#123;(function(_0x3ca2e7,_0x1591a7)&#123;_0x5a33c3[&#x27;exports&#x27;]=_0x1591a7(_0x431372(&#x27;21bf&#x27;));&#125;(0x0,function(_0xd223d0)&#123;return function()&#123;var _0x531e55=_0xd223d0,_0x5488fb=_0x531e55[&#x27;lib&#x27;],_0xdf18c=_0x5488fb[&#x27;WordArray&#x27;],_0x19aca0=_0x531e55[&#x27;enc&#x27;];_0x19aca0[&#x27;Utf16&#x27;]=_0x19aca0[&#x27;Utf16BE&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x39e62f)&#123;for(var _0x5dd099=_0x39e62f[&#x27;words&#x27;],_0x58e029=_0x39e62f[&#x27;sigBytes&#x27;],_0x38ba8f=[],_0x599d2e=0x0;_0x599d2e&lt;_0x58e029;_0x599d2e+=0x2)&#123;var _0x30555b=_0x5dd099[_0x599d2e&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x10-_0x599d2e%0x4*0x8&amp;0xffff;_0x38ba8f[&#x27;push&#x27;](String[&#x27;fromCharCode&#x27;](_0x30555b));&#125;return _0x38ba8f[&#x27;join&#x27;](&#x27;&#x27;);&#125;,&#x27;parse&#x27;:function(_0x42b16e)&#123;for(var _0x3297d0=_0x42b16e[&#x27;length&#x27;],_0x52c144=[],_0x3f0cef=0x0;_0x3f0cef&lt;_0x3297d0;_0x3f0cef++)_0x52c144[_0x3f0cef&gt;&gt;&gt;0x1]|=_0x42b16e[&#x27;charCodeAt&#x27;](_0x3f0cef)&lt;&lt;0x10-_0x3f0cef%0x2*0x10;return _0xdf18c[&#x27;create&#x27;](_0x52c144,0x2*_0x3297d0);&#125;&#125;;function _0x32fb7d(_0xc31af2)&#123;return _0xc31af2&lt;&lt;0x8&amp;0xff00ff00|_0xc31af2&gt;&gt;&gt;0x8&amp;0xff00ff;&#125;_0x19aca0[&#x27;Utf16LE&#x27;]=&#123;&#x27;stringify&#x27;:function(_0x315b4e)&#123;for(var _0x2a20eb=_0x315b4e[&#x27;words&#x27;],_0x22a3df=_0x315b4e[&#x27;sigBytes&#x27;],_0x41a998=[],_0x1d7536=0x0;_0x1d7536&lt;_0x22a3df;_0x1d7536+=0x2)&#123;var _0x377ff0=_0x32fb7d(_0x2a20eb[_0x1d7536&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x10-_0x1d7536%0x4*0x8&amp;0xffff);_0x41a998[&#x27;push&#x27;](String[&#x27;fromCharCode&#x27;](_0x377ff0));&#125;return _0x41a998[&#x27;join&#x27;](&#x27;&#x27;);&#125;,&#x27;parse&#x27;:function(_0x323217)&#123;for(var _0x56bc90=_0x323217[&#x27;length&#x27;],_0x2aa60b=[],_0x10e1c5=0x0;_0x10e1c5&lt;_0x56bc90;_0x10e1c5++)_0x2aa60b[_0x10e1c5&gt;&gt;&gt;0x1]|=_0x32fb7d(_0x323217[&#x27;charCodeAt&#x27;](_0x10e1c5)&lt;&lt;0x10-_0x10e1c5%0x2*0x10);return _0xdf18c[&#x27;create&#x27;](_0x2aa60b,0x2*_0x56bc90);&#125;&#125;;&#125;(),_0xd223d0[&#x27;enc&#x27;][&#x27;Utf16&#x27;];&#125;));&#125;,&#x27;aaef&#x27;:function(_0x14d534,_0x32b94f,_0x40617e)&#123;(function(_0x1d3c53,_0x336b57,_0x25e4e0)&#123;_0x14d534[&#x27;exports&#x27;]=_0x336b57(_0x40617e(&#x27;21bf&#x27;),_0x40617e(&#x27;38ba&#x27;));&#125;(0x0,function(_0x51e6ee)&#123;/** @preserve</span><br><span class="line">	 * Counter block mode compatible with  Dr Brian Gladman fileenc.c</span><br><span class="line">	 * derived from CryptoJS.mode.CTR</span><br><span class="line">	 * Jan Hruby jhruby.web@gmail.com</span><br><span class="line">	 */</span><br><span class="line">return _0x51e6ee[&#x27;mode&#x27;][&#x27;CTRGladman&#x27;]=function()&#123;var _0x16739c=_0x51e6ee[&#x27;lib&#x27;][&#x27;BlockCipherMode&#x27;][&#x27;extend&#x27;]();function _0x327a92(_0x3698a6)&#123;if(0xff===(_0x3698a6&gt;&gt;0x18&amp;0xff))&#123;var _0x56c7cf=_0x3698a6&gt;&gt;0x10&amp;0xff,_0x5a8352=_0x3698a6&gt;&gt;0x8&amp;0xff,_0x44ddac=0xff&amp;_0x3698a6;0xff===_0x56c7cf?(_0x56c7cf=0x0,0xff===_0x5a8352?(_0x5a8352=0x0,0xff===_0x44ddac?_0x44ddac=0x0:++_0x44ddac):++_0x5a8352):++_0x56c7cf,_0x3698a6=0x0,_0x3698a6+=_0x56c7cf&lt;&lt;0x10,_0x3698a6+=_0x5a8352&lt;&lt;0x8,_0x3698a6+=_0x44ddac;&#125;else _0x3698a6+=0x1&lt;&lt;0x18;return _0x3698a6;&#125;function _0x2f4f51(_0x24e35a)&#123;return 0x0===(_0x24e35a[0x0]=_0x327a92(_0x24e35a[0x0]))&amp;&amp;(_0x24e35a[0x1]=_0x327a92(_0x24e35a[0x1])),_0x24e35a;&#125;var _0x41cb48=_0x16739c[&#x27;Encryptor&#x27;]=_0x16739c[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x4b8846,_0x11e8ba)&#123;var _0x3c094c=this[&#x27;_cipher&#x27;],_0x5a2cc8=_0x3c094c[&#x27;blockSize&#x27;],_0x4f0b68=this[&#x27;_iv&#x27;],_0x5c3ed9=this[&#x27;_counter&#x27;];_0x4f0b68&amp;&amp;(_0x5c3ed9=this[&#x27;_counter&#x27;]=_0x4f0b68[&#x27;slice&#x27;](0x0),this[&#x27;_iv&#x27;]=void 0x0),_0x2f4f51(_0x5c3ed9);var _0x513cba=_0x5c3ed9[&#x27;slice&#x27;](0x0);_0x3c094c[&#x27;encryptBlock&#x27;](_0x513cba,0x0);for(var _0x1906f1=0x0;_0x1906f1&lt;_0x5a2cc8;_0x1906f1++)_0x4b8846[_0x11e8ba+_0x1906f1]^=_0x513cba[_0x1906f1];&#125;&#125;);return _0x16739c[&#x27;Decryptor&#x27;]=_0x41cb48,_0x16739c;&#125;(),_0x51e6ee[&#x27;mode&#x27;][&#x27;CTRGladman&#x27;];&#125;));&#125;,&#x27;b86b&#x27;:function(_0x1d1e2a,_0x1a3bad,_0x504ce2)&#123;(function(_0x3d0f8e,_0x3e48ae,_0x24f3ea)&#123;_0x1d1e2a[&#x27;exports&#x27;]=_0x3e48ae(_0x504ce2(&#x27;21bf&#x27;),_0x504ce2(&#x27;3252&#x27;),_0x504ce2(&#x27;d6e6&#x27;));&#125;(0x0,function(_0x12bc13)&#123;return function()&#123;var _0x49f3ac=_0x12bc13,_0x17e4ce=_0x49f3ac[&#x27;x64&#x27;],_0x2a1caf=_0x17e4ce[&#x27;Word&#x27;],_0x5eac3b=_0x17e4ce[&#x27;WordArray&#x27;],_0x5f567e=_0x49f3ac[&#x27;algo&#x27;],_0x2d8d22=_0x5f567e[&#x27;SHA512&#x27;],_0xfe83b4=_0x5f567e[&#x27;SHA384&#x27;]=_0x2d8d22[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x5eac3b[&#x27;init&#x27;]([new _0x2a1caf[&#x27;init&#x27;](0xcbbb9d5d,0xc1059ed8),new _0x2a1caf[&#x27;init&#x27;](0x629a292a,0x367cd507),new _0x2a1caf[&#x27;init&#x27;](0x9159015a,0x3070dd17),new _0x2a1caf[&#x27;init&#x27;](0x152fecd8,0xf70e5939),new _0x2a1caf[&#x27;init&#x27;](0x67332667,0xffc00b31),new _0x2a1caf[&#x27;init&#x27;](0x8eb44a87,0x68581511),new _0x2a1caf[&#x27;init&#x27;](0xdb0c2e0d,0x64f98fa7),new _0x2a1caf[&#x27;init&#x27;](0x47b5481d,0xbefa4fa4)]);&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x5f032a=_0x2d8d22[&#x27;_doFinalize&#x27;][&#x27;call&#x27;](this);return _0x5f032a[&#x27;sigBytes&#x27;]-=0x10,_0x5f032a;&#125;&#125;);_0x49f3ac[&#x27;SHA384&#x27;]=_0x2d8d22[&#x27;_createHelper&#x27;](_0xfe83b4),_0x49f3ac[&#x27;HmacSHA384&#x27;]=_0x2d8d22[&#x27;_createHmacHelper&#x27;](_0xfe83b4);&#125;(),_0x12bc13[&#x27;SHA384&#x27;];&#125;));&#125;,&#x27;b86c&#x27;:function(_0x26cf99,_0x3f652b,_0x543236)&#123;(function(_0x56383c,_0xbdb6d7,_0x3a0ab2)&#123;_0x26cf99[&#x27;exports&#x27;]=_0xbdb6d7(_0x543236(&#x27;21bf&#x27;),_0x543236(&#x27;38ba&#x27;));&#125;(0x0,function(_0x235048)&#123;return _0x235048[&#x27;pad&#x27;][&#x27;NoPadding&#x27;]=&#123;&#x27;pad&#x27;:function()&#123;&#125;,&#x27;unpad&#x27;:function()&#123;&#125;&#125;,_0x235048[&#x27;pad&#x27;][&#x27;NoPadding&#x27;];&#125;));&#125;,&#x27;c198&#x27;:function(_0x5598ba,_0x56de16,_0x52aeff)&#123;(function(_0x41b0de,_0x242838,_0x4bb6f5)&#123;_0x5598ba[&#x27;exports&#x27;]=_0x242838(_0x52aeff(&#x27;21bf&#x27;),_0x52aeff(&#x27;1132&#x27;),_0x52aeff(&#x27;72fe&#x27;),_0x52aeff(&#x27;2b79&#x27;),_0x52aeff(&#x27;38ba&#x27;));&#125;(0x0,function(_0x3298b0)&#123;return function()&#123;var _0x1dace4=_0x3298b0,_0x2cca84=_0x1dace4[&#x27;lib&#x27;],_0x396599=_0x2cca84[&#x27;BlockCipher&#x27;],_0xa7a96c=_0x1dace4[&#x27;algo&#x27;],_0x4c43bf=[],_0x20ca76=[],_0xe1abba=[],_0x21be09=[],_0x56f3fd=[],_0x516391=[],_0x486bd2=[],_0x7d9071=[],_0x39ec65=[],_0x5e27ce=[];(function()&#123;for(var _0x1d05fa=[],_0x1b5d0f=0x0;_0x1b5d0f&lt;0x100;_0x1b5d0f++)_0x1d05fa[_0x1b5d0f]=_0x1b5d0f&lt;0x80?_0x1b5d0f&lt;&lt;0x1:_0x1b5d0f&lt;&lt;0x1^0x11b;var _0x5f3da9=0x0,_0x4f0f1d=0x0;for(_0x1b5d0f=0x0;_0x1b5d0f&lt;0x100;_0x1b5d0f++)&#123;var _0x7e25ca=_0x4f0f1d^_0x4f0f1d&lt;&lt;0x1^_0x4f0f1d&lt;&lt;0x2^_0x4f0f1d&lt;&lt;0x3^_0x4f0f1d&lt;&lt;0x4;_0x7e25ca=_0x7e25ca&gt;&gt;&gt;0x8^0xff&amp;_0x7e25ca^0x63,_0x4c43bf[_0x5f3da9]=_0x7e25ca,_0x20ca76[_0x7e25ca]=_0x5f3da9;var _0x11e86c=_0x1d05fa[_0x5f3da9],_0x315732=_0x1d05fa[_0x11e86c],_0x5eef20=_0x1d05fa[_0x315732],_0x2d1d2c=0x101*_0x1d05fa[_0x7e25ca]^0x1010100*_0x7e25ca;_0xe1abba[_0x5f3da9]=_0x2d1d2c&lt;&lt;0x18|_0x2d1d2c&gt;&gt;&gt;0x8,_0x21be09[_0x5f3da9]=_0x2d1d2c&lt;&lt;0x10|_0x2d1d2c&gt;&gt;&gt;0x10,_0x56f3fd[_0x5f3da9]=_0x2d1d2c&lt;&lt;0x8|_0x2d1d2c&gt;&gt;&gt;0x18,_0x516391[_0x5f3da9]=_0x2d1d2c;_0x2d1d2c=0x1010101*_0x5eef20^0x10001*_0x315732^0x101*_0x11e86c^0x1010100*_0x5f3da9;_0x486bd2[_0x7e25ca]=_0x2d1d2c&lt;&lt;0x18|_0x2d1d2c&gt;&gt;&gt;0x8,_0x7d9071[_0x7e25ca]=_0x2d1d2c&lt;&lt;0x10|_0x2d1d2c&gt;&gt;&gt;0x10,_0x39ec65[_0x7e25ca]=_0x2d1d2c&lt;&lt;0x8|_0x2d1d2c&gt;&gt;&gt;0x18,_0x5e27ce[_0x7e25ca]=_0x2d1d2c,_0x5f3da9?(_0x5f3da9=_0x11e86c^_0x1d05fa[_0x1d05fa[_0x1d05fa[_0x5eef20^_0x11e86c]]],_0x4f0f1d^=_0x1d05fa[_0x1d05fa[_0x4f0f1d]]):_0x5f3da9=_0x4f0f1d=0x1;&#125;&#125;());var _0x161760=[0x0,0x1,0x2,0x4,0x8,0x10,0x20,0x40,0x80,0x1b,0x36],_0xf9d774=_0xa7a96c[&#x27;AES&#x27;]=_0x396599[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;if(!this[&#x27;_nRounds&#x27;]||this[&#x27;_keyPriorReset&#x27;]!==this[&#x27;_key&#x27;])&#123;for(var _0x4dfa8e=this[&#x27;_keyPriorReset&#x27;]=this[&#x27;_key&#x27;],_0x244e6b=_0x4dfa8e[&#x27;words&#x27;],_0x210cec=_0x4dfa8e[&#x27;sigBytes&#x27;]/0x4,_0xc8f3b8=this[&#x27;_nRounds&#x27;]=_0x210cec+0x6,_0x50972d=0x4*(_0xc8f3b8+0x1),_0xb46572=this[&#x27;_keySchedule&#x27;]=[],_0xbc8139=0x0;_0xbc8139&lt;_0x50972d;_0xbc8139++)if(_0xbc8139&lt;_0x210cec)_0xb46572[_0xbc8139]=_0x244e6b[_0xbc8139];else&#123;var _0x4e31c2=_0xb46572[_0xbc8139-0x1];_0xbc8139%_0x210cec?_0x210cec&gt;0x6&amp;&amp;_0xbc8139%_0x210cec==0x4&amp;&amp;(_0x4e31c2=_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4c43bf[0xff&amp;_0x4e31c2]):(_0x4e31c2=_0x4e31c2&lt;&lt;0x8|_0x4e31c2&gt;&gt;&gt;0x18,_0x4e31c2=_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4c43bf[0xff&amp;_0x4e31c2],_0x4e31c2^=_0x161760[_0xbc8139/_0x210cec|0x0]&lt;&lt;0x18),_0xb46572[_0xbc8139]=_0xb46572[_0xbc8139-_0x210cec]^_0x4e31c2;&#125;for(var _0x4ab28e=this[&#x27;_invKeySchedule&#x27;]=[],_0x14c0be=0x0;_0x14c0be&lt;_0x50972d;_0x14c0be++)&#123;_0xbc8139=_0x50972d-_0x14c0be;if(_0x14c0be%0x4)_0x4e31c2=_0xb46572[_0xbc8139];else _0x4e31c2=_0xb46572[_0xbc8139-0x4];_0x4ab28e[_0x14c0be]=_0x14c0be&lt;0x4||_0xbc8139&lt;=0x4?_0x4e31c2:_0x486bd2[_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x18]]^_0x7d9071[_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x10&amp;0xff]]^_0x39ec65[_0x4c43bf[_0x4e31c2&gt;&gt;&gt;0x8&amp;0xff]]^_0x5e27ce[_0x4c43bf[0xff&amp;_0x4e31c2]];&#125;&#125;&#125;,&#x27;encryptBlock&#x27;:function(_0xfb51c2,_0x1a3f9a)&#123;this[&#x27;_doCryptBlock&#x27;](_0xfb51c2,_0x1a3f9a,this[&#x27;_keySchedule&#x27;],_0xe1abba,_0x21be09,_0x56f3fd,_0x516391,_0x4c43bf);&#125;,&#x27;decryptBlock&#x27;:function(_0xdffafb,_0x13e77f)&#123;var _0x587668=_0xdffafb[_0x13e77f+0x1];_0xdffafb[_0x13e77f+0x1]=_0xdffafb[_0x13e77f+0x3],_0xdffafb[_0x13e77f+0x3]=_0x587668,this[&#x27;_doCryptBlock&#x27;](_0xdffafb,_0x13e77f,this[&#x27;_invKeySchedule&#x27;],_0x486bd2,_0x7d9071,_0x39ec65,_0x5e27ce,_0x20ca76);_0x587668=_0xdffafb[_0x13e77f+0x1];_0xdffafb[_0x13e77f+0x1]=_0xdffafb[_0x13e77f+0x3],_0xdffafb[_0x13e77f+0x3]=_0x587668;&#125;,&#x27;_doCryptBlock&#x27;:function(_0x53597e,_0x5636ca,_0x3a4ce2,_0x3077d9,_0x2ed376,_0x4eb506,_0x376e1a,_0x4b676e)&#123;for(var _0x2a9d76=this[&#x27;_nRounds&#x27;],_0x4cbe25=_0x53597e[_0x5636ca]^_0x3a4ce2[0x0],_0x19f03d=_0x53597e[_0x5636ca+0x1]^_0x3a4ce2[0x1],_0x247080=_0x53597e[_0x5636ca+0x2]^_0x3a4ce2[0x2],_0x3d5ab1=_0x53597e[_0x5636ca+0x3]^_0x3a4ce2[0x3],_0x3d667b=0x4,_0xaa3d0f=0x1;_0xaa3d0f&lt;_0x2a9d76;_0xaa3d0f++)&#123;var _0x3692a1=_0x3077d9[_0x4cbe25&gt;&gt;&gt;0x18]^_0x2ed376[_0x19f03d&gt;&gt;&gt;0x10&amp;0xff]^_0x4eb506[_0x247080&gt;&gt;&gt;0x8&amp;0xff]^_0x376e1a[0xff&amp;_0x3d5ab1]^_0x3a4ce2[_0x3d667b++],_0x69a776=_0x3077d9[_0x19f03d&gt;&gt;&gt;0x18]^_0x2ed376[_0x247080&gt;&gt;&gt;0x10&amp;0xff]^_0x4eb506[_0x3d5ab1&gt;&gt;&gt;0x8&amp;0xff]^_0x376e1a[0xff&amp;_0x4cbe25]^_0x3a4ce2[_0x3d667b++],_0x1df39c=_0x3077d9[_0x247080&gt;&gt;&gt;0x18]^_0x2ed376[_0x3d5ab1&gt;&gt;&gt;0x10&amp;0xff]^_0x4eb506[_0x4cbe25&gt;&gt;&gt;0x8&amp;0xff]^_0x376e1a[0xff&amp;_0x19f03d]^_0x3a4ce2[_0x3d667b++],_0x2ff037=_0x3077d9[_0x3d5ab1&gt;&gt;&gt;0x18]^_0x2ed376[_0x4cbe25&gt;&gt;&gt;0x10&amp;0xff]^_0x4eb506[_0x19f03d&gt;&gt;&gt;0x8&amp;0xff]^_0x376e1a[0xff&amp;_0x247080]^_0x3a4ce2[_0x3d667b++];_0x4cbe25=_0x3692a1,_0x19f03d=_0x69a776,_0x247080=_0x1df39c,_0x3d5ab1=_0x2ff037;&#125;_0x3692a1=(_0x4b676e[_0x4cbe25&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4b676e[_0x19f03d&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4b676e[_0x247080&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4b676e[0xff&amp;_0x3d5ab1])^_0x3a4ce2[_0x3d667b++],_0x69a776=(_0x4b676e[_0x19f03d&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4b676e[_0x247080&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4b676e[_0x3d5ab1&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4b676e[0xff&amp;_0x4cbe25])^_0x3a4ce2[_0x3d667b++],_0x1df39c=(_0x4b676e[_0x247080&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4b676e[_0x3d5ab1&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4b676e[_0x4cbe25&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4b676e[0xff&amp;_0x19f03d])^_0x3a4ce2[_0x3d667b++],_0x2ff037=(_0x4b676e[_0x3d5ab1&gt;&gt;&gt;0x18]&lt;&lt;0x18|_0x4b676e[_0x4cbe25&gt;&gt;&gt;0x10&amp;0xff]&lt;&lt;0x10|_0x4b676e[_0x19f03d&gt;&gt;&gt;0x8&amp;0xff]&lt;&lt;0x8|_0x4b676e[0xff&amp;_0x247080])^_0x3a4ce2[_0x3d667b++];_0x53597e[_0x5636ca]=_0x3692a1,_0x53597e[_0x5636ca+0x1]=_0x69a776,_0x53597e[_0x5636ca+0x2]=_0x1df39c,_0x53597e[_0x5636ca+0x3]=_0x2ff037;&#125;,&#x27;keySize&#x27;:0x8&#125;);_0x1dace4[&#x27;AES&#x27;]=_0x396599[&#x27;_createHelper&#x27;](_0xf9d774);&#125;(),_0x3298b0[&#x27;AES&#x27;];&#125;));&#125;,&#x27;c3b6&#x27;:function(_0xb2a8de,_0x333f65,_0x1a3eea)&#123;(function(_0x3edd72,_0x1ef540,_0x2522cf)&#123;_0xb2a8de[&#x27;exports&#x27;]=_0x1ef540(_0x1a3eea(&#x27;21bf&#x27;),_0x1a3eea(&#x27;1132&#x27;),_0x1a3eea(&#x27;72fe&#x27;),_0x1a3eea(&#x27;2b79&#x27;),_0x1a3eea(&#x27;38ba&#x27;));&#125;(0x0,function(_0xa46667)&#123;return function()&#123;var _0x265771=_0xa46667,_0x384a23=_0x265771[&#x27;lib&#x27;],_0x2f5d0a=_0x384a23[&#x27;StreamCipher&#x27;],_0x3423d7=_0x265771[&#x27;algo&#x27;],_0x5cfc2d=_0x3423d7[&#x27;RC4&#x27;]=_0x2f5d0a[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;for(var _0x3c0f55=this[&#x27;_key&#x27;],_0x17a863=_0x3c0f55[&#x27;words&#x27;],_0x35958c=_0x3c0f55[&#x27;sigBytes&#x27;],_0x3c5c48=this[&#x27;_S&#x27;]=[],_0x49dbcb=0x0;_0x49dbcb&lt;0x100;_0x49dbcb++)_0x3c5c48[_0x49dbcb]=_0x49dbcb;_0x49dbcb=0x0;for(var _0x3f85bf=0x0;_0x49dbcb&lt;0x100;_0x49dbcb++)&#123;var _0x275146=_0x49dbcb%_0x35958c,_0x382245=_0x17a863[_0x275146&gt;&gt;&gt;0x2]&gt;&gt;&gt;0x18-_0x275146%0x4*0x8&amp;0xff;_0x3f85bf=(_0x3f85bf+_0x3c5c48[_0x49dbcb]+_0x382245)%0x100;var _0x554dd3=_0x3c5c48[_0x49dbcb];_0x3c5c48[_0x49dbcb]=_0x3c5c48[_0x3f85bf],_0x3c5c48[_0x3f85bf]=_0x554dd3;&#125;this[&#x27;_i&#x27;]=this[&#x27;_j&#x27;]=0x0;&#125;,&#x27;_doProcessBlock&#x27;:function(_0x502d0c,_0x3b52a8)&#123;_0x502d0c[_0x3b52a8]^=_0x15b286[&#x27;call&#x27;](this);&#125;,&#x27;keySize&#x27;:0x8,&#x27;ivSize&#x27;:0x0&#125;);function _0x15b286()&#123;for(var _0x4fd310=this[&#x27;_S&#x27;],_0x45f0b1=this[&#x27;_i&#x27;],_0x32ebd1=this[&#x27;_j&#x27;],_0x3984b8=0x0,_0x44cf97=0x0;_0x44cf97&lt;0x4;_0x44cf97++)&#123;_0x45f0b1=(_0x45f0b1+0x1)%0x100,_0x32ebd1=(_0x32ebd1+_0x4fd310[_0x45f0b1])%0x100;var _0x230784=_0x4fd310[_0x45f0b1];_0x4fd310[_0x45f0b1]=_0x4fd310[_0x32ebd1],_0x4fd310[_0x32ebd1]=_0x230784,_0x3984b8|=_0x4fd310[(_0x4fd310[_0x45f0b1]+_0x4fd310[_0x32ebd1])%0x100]&lt;&lt;0x18-0x8*_0x44cf97;&#125;return this[&#x27;_i&#x27;]=_0x45f0b1,this[&#x27;_j&#x27;]=_0x32ebd1,_0x3984b8;&#125;_0x265771[&#x27;RC4&#x27;]=_0x2f5d0a[&#x27;_createHelper&#x27;](_0x5cfc2d);var _0x4d5bab=_0x3423d7[&#x27;RC4Drop&#x27;]=_0x5cfc2d[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x5cfc2d[&#x27;cfg&#x27;][&#x27;extend&#x27;](&#123;&#x27;drop&#x27;:0xc0&#125;),&#x27;_doReset&#x27;:function()&#123;_0x5cfc2d[&#x27;_doReset&#x27;][&#x27;call&#x27;](this);for(var _0x5ef505=this[&#x27;cfg&#x27;][&#x27;drop&#x27;];_0x5ef505&gt;0x0;_0x5ef505--)_0x15b286[&#x27;call&#x27;](this);&#125;&#125;);_0x265771[&#x27;RC4Drop&#x27;]=_0x2f5d0a[&#x27;_createHelper&#x27;](_0x4d5bab);&#125;(),_0xa46667[&#x27;RC4&#x27;];&#125;));&#125;,&#x27;d6e6&#x27;:function(_0x267839,_0x330831,_0x20566a)&#123;(function(_0x9b6986,_0x2e3e76,_0x4501a7)&#123;_0x267839[&#x27;exports&#x27;]=_0x2e3e76(_0x20566a(&#x27;21bf&#x27;),_0x20566a(&#x27;3252&#x27;));&#125;(0x0,function(_0x556890)&#123;return function()&#123;var _0x31055f=_0x556890,_0x4d3ef0=_0x31055f[&#x27;lib&#x27;],_0x33ed8a=_0x4d3ef0[&#x27;Hasher&#x27;],_0xb469fd=_0x31055f[&#x27;x64&#x27;],_0x542b67=_0xb469fd[&#x27;Word&#x27;],_0x565917=_0xb469fd[&#x27;WordArray&#x27;],_0x146a12=_0x31055f[&#x27;algo&#x27;];function _0x4d37c3()&#123;return _0x542b67[&#x27;create&#x27;][&#x27;apply&#x27;](_0x542b67,arguments);&#125;var _0x2a5b30=[_0x4d37c3(0x428a2f98,0xd728ae22),_0x4d37c3(0x71374491,0x23ef65cd),_0x4d37c3(0xb5c0fbcf,0xec4d3b2f),_0x4d37c3(0xe9b5dba5,0x8189dbbc),_0x4d37c3(0x3956c25b,0xf348b538),_0x4d37c3(0x59f111f1,0xb605d019),_0x4d37c3(0x923f82a4,0xaf194f9b),_0x4d37c3(0xab1c5ed5,0xda6d8118),_0x4d37c3(0xd807aa98,0xa3030242),_0x4d37c3(0x12835b01,0x45706fbe),_0x4d37c3(0x243185be,0x4ee4b28c),_0x4d37c3(0x550c7dc3,0xd5ffb4e2),_0x4d37c3(0x72be5d74,0xf27b896f),_0x4d37c3(0x80deb1fe,0x3b1696b1),_0x4d37c3(0x9bdc06a7,0x25c71235),_0x4d37c3(0xc19bf174,0xcf692694),_0x4d37c3(0xe49b69c1,0x9ef14ad2),_0x4d37c3(0xefbe4786,0x384f25e3),_0x4d37c3(0xfc19dc6,0x8b8cd5b5),_0x4d37c3(0x240ca1cc,0x77ac9c65),_0x4d37c3(0x2de92c6f,0x592b0275),_0x4d37c3(0x4a7484aa,0x6ea6e483),_0x4d37c3(0x5cb0a9dc,0xbd41fbd4),_0x4d37c3(0x76f988da,0x831153b5),_0x4d37c3(0x983e5152,0xee66dfab),_0x4d37c3(0xa831c66d,0x2db43210),_0x4d37c3(0xb00327c8,0x98fb213f),_0x4d37c3(0xbf597fc7,0xbeef0ee4),_0x4d37c3(0xc6e00bf3,0x3da88fc2),_0x4d37c3(0xd5a79147,0x930aa725),_0x4d37c3(0x6ca6351,0xe003826f),_0x4d37c3(0x14292967,0xa0e6e70),_0x4d37c3(0x27b70a85,0x46d22ffc),_0x4d37c3(0x2e1b2138,0x5c26c926),_0x4d37c3(0x4d2c6dfc,0x5ac42aed),_0x4d37c3(0x53380d13,0x9d95b3df),_0x4d37c3(0x650a7354,0x8baf63de),_0x4d37c3(0x766a0abb,0x3c77b2a8),_0x4d37c3(0x81c2c92e,0x47edaee6),_0x4d37c3(0x92722c85,0x1482353b),_0x4d37c3(0xa2bfe8a1,0x4cf10364),_0x4d37c3(0xa81a664b,0xbc423001),_0x4d37c3(0xc24b8b70,0xd0f89791),_0x4d37c3(0xc76c51a3,0x654be30),_0x4d37c3(0xd192e819,0xd6ef5218),_0x4d37c3(0xd6990624,0x5565a910),_0x4d37c3(0xf40e3585,0x5771202a),_0x4d37c3(0x106aa070,0x32bbd1b8),_0x4d37c3(0x19a4c116,0xb8d2d0c8),_0x4d37c3(0x1e376c08,0x5141ab53),_0x4d37c3(0x2748774c,0xdf8eeb99),_0x4d37c3(0x34b0bcb5,0xe19b48a8),_0x4d37c3(0x391c0cb3,0xc5c95a63),_0x4d37c3(0x4ed8aa4a,0xe3418acb),_0x4d37c3(0x5b9cca4f,0x7763e373),_0x4d37c3(0x682e6ff3,0xd6b2b8a3),_0x4d37c3(0x748f82ee,0x5defb2fc),_0x4d37c3(0x78a5636f,0x43172f60),_0x4d37c3(0x84c87814,0xa1f0ab72),_0x4d37c3(0x8cc70208,0x1a6439ec),_0x4d37c3(0x90befffa,0x23631e28),_0x4d37c3(0xa4506ceb,0xde82bde9),_0x4d37c3(0xbef9a3f7,0xb2c67915),_0x4d37c3(0xc67178f2,0xe372532b),_0x4d37c3(0xca273ece,0xea26619c),_0x4d37c3(0xd186b8c7,0x21c0c207),_0x4d37c3(0xeada7dd6,0xcde0eb1e),_0x4d37c3(0xf57d4f7f,0xee6ed178),_0x4d37c3(0x6f067aa,0x72176fba),_0x4d37c3(0xa637dc5,0xa2c898a6),_0x4d37c3(0x113f9804,0xbef90dae),_0x4d37c3(0x1b710b35,0x131c471b),_0x4d37c3(0x28db77f5,0x23047d84),_0x4d37c3(0x32caab7b,0x40c72493),_0x4d37c3(0x3c9ebe0a,0x15c9bebc),_0x4d37c3(0x431d67c4,0x9c100d4c),_0x4d37c3(0x4cc5d4be,0xcb3e42b6),_0x4d37c3(0x597f299c,0xfc657e2a),_0x4d37c3(0x5fcb6fab,0x3ad6faec),_0x4d37c3(0x6c44198c,0x4a475817)],_0x2f7371=[];(function()&#123;for(var _0x476a4b=0x0;_0x476a4b&lt;0x50;_0x476a4b++)_0x2f7371[_0x476a4b]=_0x4d37c3();&#125;());var _0x5b5d51=_0x146a12[&#x27;SHA512&#x27;]=_0x33ed8a[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x565917[&#x27;init&#x27;]([new _0x542b67[&#x27;init&#x27;](0x6a09e667,0xf3bcc908),new _0x542b67[&#x27;init&#x27;](0xbb67ae85,0x84caa73b),new _0x542b67[&#x27;init&#x27;](0x3c6ef372,0xfe94f82b),new _0x542b67[&#x27;init&#x27;](0xa54ff53a,0x5f1d36f1),new _0x542b67[&#x27;init&#x27;](0x510e527f,0xade682d1),new _0x542b67[&#x27;init&#x27;](0x9b05688c,0x2b3e6c1f),new _0x542b67[&#x27;init&#x27;](0x1f83d9ab,0xfb41bd6b),new _0x542b67[&#x27;init&#x27;](0x5be0cd19,0x137e2179)]);&#125;,&#x27;_doProcessBlock&#x27;:function(_0x4a88c5,_0x4a9a8d)&#123;for(var _0x2db49b=this[&#x27;_hash&#x27;][&#x27;words&#x27;],_0x15f96e=_0x2db49b[0x0],_0x22e69b=_0x2db49b[0x1],_0x204f52=_0x2db49b[0x2],_0x47dab3=_0x2db49b[0x3],_0x3c6354=_0x2db49b[0x4],_0x8ee83=_0x2db49b[0x5],_0x2becc0=_0x2db49b[0x6],_0x2e87b9=_0x2db49b[0x7],_0x1fe87e=_0x15f96e[&#x27;high&#x27;],_0x1c64cf=_0x15f96e[&#x27;low&#x27;],_0x57cab4=_0x22e69b[&#x27;high&#x27;],_0x4e6f30=_0x22e69b[&#x27;low&#x27;],_0x42207d=_0x204f52[&#x27;high&#x27;],_0x195e34=_0x204f52[&#x27;low&#x27;],_0x26b6f0=_0x47dab3[&#x27;high&#x27;],_0xad6055=_0x47dab3[&#x27;low&#x27;],_0x505435=_0x3c6354[&#x27;high&#x27;],_0x42e53d=_0x3c6354[&#x27;low&#x27;],_0x4c7bc5=_0x8ee83[&#x27;high&#x27;],_0x47142e=_0x8ee83[&#x27;low&#x27;],_0x4e8bca=_0x2becc0[&#x27;high&#x27;],_0x413626=_0x2becc0[&#x27;low&#x27;],_0x5060f0=_0x2e87b9[&#x27;high&#x27;],_0x1b0392=_0x2e87b9[&#x27;low&#x27;],_0x1505a4=_0x1fe87e,_0x2dbee7=_0x1c64cf,_0x191005=_0x57cab4,_0x13ea6a=_0x4e6f30,_0x3e7542=_0x42207d,_0x1a835f=_0x195e34,_0x70cf2f=_0x26b6f0,_0x1a12d7=_0xad6055,_0x37ee15=_0x505435,_0x3dd6e9=_0x42e53d,_0x1a8b7a=_0x4c7bc5,_0x3051fa=_0x47142e,_0x491ab5=_0x4e8bca,_0x4d9ca8=_0x413626,_0x274487=_0x5060f0,_0x5d7be7=_0x1b0392,_0x58ec48=0x0;_0x58ec48&lt;0x50;_0x58ec48++)&#123;var _0x113abc=_0x2f7371[_0x58ec48];if(_0x58ec48&lt;0x10)var _0x33f84a=_0x113abc[&#x27;high&#x27;]=0x0|_0x4a88c5[_0x4a9a8d+0x2*_0x58ec48],_0x211a3f=_0x113abc[&#x27;low&#x27;]=0x0|_0x4a88c5[_0x4a9a8d+0x2*_0x58ec48+0x1];else&#123;var _0x51e458=_0x2f7371[_0x58ec48-0xf],_0x3e4496=_0x51e458[&#x27;high&#x27;],_0x8dd5d6=_0x51e458[&#x27;low&#x27;],_0x3a2fd6=(_0x3e4496&gt;&gt;&gt;0x1|_0x8dd5d6&lt;&lt;0x1f)^(_0x3e4496&gt;&gt;&gt;0x8|_0x8dd5d6&lt;&lt;0x18)^_0x3e4496&gt;&gt;&gt;0x7,_0xce7972=(_0x8dd5d6&gt;&gt;&gt;0x1|_0x3e4496&lt;&lt;0x1f)^(_0x8dd5d6&gt;&gt;&gt;0x8|_0x3e4496&lt;&lt;0x18)^(_0x8dd5d6&gt;&gt;&gt;0x7|_0x3e4496&lt;&lt;0x19),_0x2b537c=_0x2f7371[_0x58ec48-0x2],_0x3bf7bc=_0x2b537c[&#x27;high&#x27;],_0x268441=_0x2b537c[&#x27;low&#x27;],_0x21153c=(_0x3bf7bc&gt;&gt;&gt;0x13|_0x268441&lt;&lt;0xd)^(_0x3bf7bc&lt;&lt;0x3|_0x268441&gt;&gt;&gt;0x1d)^_0x3bf7bc&gt;&gt;&gt;0x6,_0x413699=(_0x268441&gt;&gt;&gt;0x13|_0x3bf7bc&lt;&lt;0xd)^(_0x268441&lt;&lt;0x3|_0x3bf7bc&gt;&gt;&gt;0x1d)^(_0x268441&gt;&gt;&gt;0x6|_0x3bf7bc&lt;&lt;0x1a),_0x4ecb40=_0x2f7371[_0x58ec48-0x7],_0xb0c2b7=_0x4ecb40[&#x27;high&#x27;],_0x2a78d1=_0x4ecb40[&#x27;low&#x27;],_0x3c1718=_0x2f7371[_0x58ec48-0x10],_0x530d37=_0x3c1718[&#x27;high&#x27;],_0x8d6fe1=_0x3c1718[&#x27;low&#x27;];_0x211a3f=_0xce7972+_0x2a78d1,_0x33f84a=_0x3a2fd6+_0xb0c2b7+(_0x211a3f&gt;&gt;&gt;0x0&lt;_0xce7972&gt;&gt;&gt;0x0?0x1:0x0),_0x211a3f=_0x211a3f+_0x413699,_0x33f84a=_0x33f84a+_0x21153c+(_0x211a3f&gt;&gt;&gt;0x0&lt;_0x413699&gt;&gt;&gt;0x0?0x1:0x0),_0x211a3f=_0x211a3f+_0x8d6fe1,_0x33f84a=_0x33f84a+_0x530d37+(_0x211a3f&gt;&gt;&gt;0x0&lt;_0x8d6fe1&gt;&gt;&gt;0x0?0x1:0x0);_0x113abc[&#x27;high&#x27;]=_0x33f84a,_0x113abc[&#x27;low&#x27;]=_0x211a3f;&#125;var _0x4e603b=_0x37ee15&amp;_0x1a8b7a^~_0x37ee15&amp;_0x491ab5,_0x316ebf=_0x3dd6e9&amp;_0x3051fa^~_0x3dd6e9&amp;_0x4d9ca8,_0x32fcea=_0x1505a4&amp;_0x191005^_0x1505a4&amp;_0x3e7542^_0x191005&amp;_0x3e7542,_0x3d5144=_0x2dbee7&amp;_0x13ea6a^_0x2dbee7&amp;_0x1a835f^_0x13ea6a&amp;_0x1a835f,_0x5e2666=(_0x1505a4&gt;&gt;&gt;0x1c|_0x2dbee7&lt;&lt;0x4)^(_0x1505a4&lt;&lt;0x1e|_0x2dbee7&gt;&gt;&gt;0x2)^(_0x1505a4&lt;&lt;0x19|_0x2dbee7&gt;&gt;&gt;0x7),_0x220f34=(_0x2dbee7&gt;&gt;&gt;0x1c|_0x1505a4&lt;&lt;0x4)^(_0x2dbee7&lt;&lt;0x1e|_0x1505a4&gt;&gt;&gt;0x2)^(_0x2dbee7&lt;&lt;0x19|_0x1505a4&gt;&gt;&gt;0x7),_0x3d466b=(_0x37ee15&gt;&gt;&gt;0xe|_0x3dd6e9&lt;&lt;0x12)^(_0x37ee15&gt;&gt;&gt;0x12|_0x3dd6e9&lt;&lt;0xe)^(_0x37ee15&lt;&lt;0x17|_0x3dd6e9&gt;&gt;&gt;0x9),_0x2a0ab8=(_0x3dd6e9&gt;&gt;&gt;0xe|_0x37ee15&lt;&lt;0x12)^(_0x3dd6e9&gt;&gt;&gt;0x12|_0x37ee15&lt;&lt;0xe)^(_0x3dd6e9&lt;&lt;0x17|_0x37ee15&gt;&gt;&gt;0x9),_0x4c2b3a=_0x2a5b30[_0x58ec48],_0x2d0aa4=_0x4c2b3a[&#x27;high&#x27;],_0x4d9680=_0x4c2b3a[&#x27;low&#x27;],_0x3db25a=_0x5d7be7+_0x2a0ab8,_0x27d09a=_0x274487+_0x3d466b+(_0x3db25a&gt;&gt;&gt;0x0&lt;_0x5d7be7&gt;&gt;&gt;0x0?0x1:0x0),_0x1537e2=(_0x3db25a=_0x3db25a+_0x316ebf,_0x27d09a=_0x27d09a+_0x4e603b+(_0x3db25a&gt;&gt;&gt;0x0&lt;_0x316ebf&gt;&gt;&gt;0x0?0x1:0x0),_0x3db25a=_0x3db25a+_0x4d9680,_0x27d09a=_0x27d09a+_0x2d0aa4+(_0x3db25a&gt;&gt;&gt;0x0&lt;_0x4d9680&gt;&gt;&gt;0x0?0x1:0x0),_0x3db25a=_0x3db25a+_0x211a3f,_0x27d09a=_0x27d09a+_0x33f84a+(_0x3db25a&gt;&gt;&gt;0x0&lt;_0x211a3f&gt;&gt;&gt;0x0?0x1:0x0),_0x220f34+_0x3d5144),_0x428e85=_0x5e2666+_0x32fcea+(_0x1537e2&gt;&gt;&gt;0x0&lt;_0x220f34&gt;&gt;&gt;0x0?0x1:0x0);_0x274487=_0x491ab5,_0x5d7be7=_0x4d9ca8,_0x491ab5=_0x1a8b7a,_0x4d9ca8=_0x3051fa,_0x1a8b7a=_0x37ee15,_0x3051fa=_0x3dd6e9,_0x3dd6e9=_0x1a12d7+_0x3db25a|0x0,_0x37ee15=_0x70cf2f+_0x27d09a+(_0x3dd6e9&gt;&gt;&gt;0x0&lt;_0x1a12d7&gt;&gt;&gt;0x0?0x1:0x0)|0x0,_0x70cf2f=_0x3e7542,_0x1a12d7=_0x1a835f,_0x3e7542=_0x191005,_0x1a835f=_0x13ea6a,_0x191005=_0x1505a4,_0x13ea6a=_0x2dbee7,_0x2dbee7=_0x3db25a+_0x1537e2|0x0,_0x1505a4=_0x27d09a+_0x428e85+(_0x2dbee7&gt;&gt;&gt;0x0&lt;_0x3db25a&gt;&gt;&gt;0x0?0x1:0x0)|0x0;&#125;_0x1c64cf=_0x15f96e[&#x27;low&#x27;]=_0x1c64cf+_0x2dbee7,_0x15f96e[&#x27;high&#x27;]=_0x1fe87e+_0x1505a4+(_0x1c64cf&gt;&gt;&gt;0x0&lt;_0x2dbee7&gt;&gt;&gt;0x0?0x1:0x0),_0x4e6f30=_0x22e69b[&#x27;low&#x27;]=_0x4e6f30+_0x13ea6a,_0x22e69b[&#x27;high&#x27;]=_0x57cab4+_0x191005+(_0x4e6f30&gt;&gt;&gt;0x0&lt;_0x13ea6a&gt;&gt;&gt;0x0?0x1:0x0),_0x195e34=_0x204f52[&#x27;low&#x27;]=_0x195e34+_0x1a835f,_0x204f52[&#x27;high&#x27;]=_0x42207d+_0x3e7542+(_0x195e34&gt;&gt;&gt;0x0&lt;_0x1a835f&gt;&gt;&gt;0x0?0x1:0x0),_0xad6055=_0x47dab3[&#x27;low&#x27;]=_0xad6055+_0x1a12d7,_0x47dab3[&#x27;high&#x27;]=_0x26b6f0+_0x70cf2f+(_0xad6055&gt;&gt;&gt;0x0&lt;_0x1a12d7&gt;&gt;&gt;0x0?0x1:0x0),_0x42e53d=_0x3c6354[&#x27;low&#x27;]=_0x42e53d+_0x3dd6e9,_0x3c6354[&#x27;high&#x27;]=_0x505435+_0x37ee15+(_0x42e53d&gt;&gt;&gt;0x0&lt;_0x3dd6e9&gt;&gt;&gt;0x0?0x1:0x0),_0x47142e=_0x8ee83[&#x27;low&#x27;]=_0x47142e+_0x3051fa,_0x8ee83[&#x27;high&#x27;]=_0x4c7bc5+_0x1a8b7a+(_0x47142e&gt;&gt;&gt;0x0&lt;_0x3051fa&gt;&gt;&gt;0x0?0x1:0x0),_0x413626=_0x2becc0[&#x27;low&#x27;]=_0x413626+_0x4d9ca8,_0x2becc0[&#x27;high&#x27;]=_0x4e8bca+_0x491ab5+(_0x413626&gt;&gt;&gt;0x0&lt;_0x4d9ca8&gt;&gt;&gt;0x0?0x1:0x0),_0x1b0392=_0x2e87b9[&#x27;low&#x27;]=_0x1b0392+_0x5d7be7,_0x2e87b9[&#x27;high&#x27;]=_0x5060f0+_0x274487+(_0x1b0392&gt;&gt;&gt;0x0&lt;_0x5d7be7&gt;&gt;&gt;0x0?0x1:0x0);&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x37c1a0=this[&#x27;_data&#x27;],_0x4688dd=_0x37c1a0[&#x27;words&#x27;],_0x1c8662=0x8*this[&#x27;_nDataBytes&#x27;],_0x200422=0x8*_0x37c1a0[&#x27;sigBytes&#x27;];_0x4688dd[_0x200422&gt;&gt;&gt;0x5]|=0x80&lt;&lt;0x18-_0x200422%0x20,_0x4688dd[0x1e+(_0x200422+0x80&gt;&gt;&gt;0xa&lt;&lt;0x5)]=Math[&#x27;floor&#x27;](_0x1c8662/0x100000000),_0x4688dd[0x1f+(_0x200422+0x80&gt;&gt;&gt;0xa&lt;&lt;0x5)]=_0x1c8662,_0x37c1a0[&#x27;sigBytes&#x27;]=0x4*_0x4688dd[&#x27;length&#x27;],this[&#x27;_process&#x27;]();var _0x2d391b=this[&#x27;_hash&#x27;][&#x27;toX32&#x27;]();return _0x2d391b;&#125;,&#x27;clone&#x27;:function()&#123;var _0x2bc688=_0x33ed8a[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x2bc688[&#x27;_hash&#x27;]=this[&#x27;_hash&#x27;][&#x27;clone&#x27;](),_0x2bc688;&#125;,&#x27;blockSize&#x27;:0x20&#125;);_0x31055f[&#x27;SHA512&#x27;]=_0x33ed8a[&#x27;_createHelper&#x27;](_0x5b5d51),_0x31055f[&#x27;HmacSHA512&#x27;]=_0x33ed8a[&#x27;_createHmacHelper&#x27;](_0x5b5d51);&#125;(),_0x556890[&#x27;SHA512&#x27;];&#125;));&#125;,&#x27;df2f&#x27;:function(_0x28742d,_0x5e7690,_0x37f4f3)&#123;(function(_0x42536e,_0x4b3d29)&#123;_0x28742d[&#x27;exports&#x27;]=_0x4b3d29(_0x37f4f3(&#x27;21bf&#x27;));&#125;(0x0,function(_0x23e72c)&#123;return function()&#123;var _0x1d0209=_0x23e72c,_0x5168c7=_0x1d0209[&#x27;lib&#x27;],_0x1e94c4=_0x5168c7[&#x27;WordArray&#x27;],_0x5e8caa=_0x5168c7[&#x27;Hasher&#x27;],_0x48329c=_0x1d0209[&#x27;algo&#x27;],_0x352ec6=[],_0x111211=_0x48329c[&#x27;SHA1&#x27;]=_0x5e8caa[&#x27;extend&#x27;](&#123;&#x27;_doReset&#x27;:function()&#123;this[&#x27;_hash&#x27;]=new _0x1e94c4[&#x27;init&#x27;]([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);&#125;,&#x27;_doProcessBlock&#x27;:function(_0x5bf1ea,_0x8534dc)&#123;for(var _0x3ce8f2=this[&#x27;_hash&#x27;][&#x27;words&#x27;],_0x261089=_0x3ce8f2[0x0],_0x1b02d9=_0x3ce8f2[0x1],_0xbe4c94=_0x3ce8f2[0x2],_0x5ea3f1=_0x3ce8f2[0x3],_0x134614=_0x3ce8f2[0x4],_0x2878b8=0x0;_0x2878b8&lt;0x50;_0x2878b8++)&#123;if(_0x2878b8&lt;0x10)_0x352ec6[_0x2878b8]=0x0|_0x5bf1ea[_0x8534dc+_0x2878b8];else&#123;var _0x4cf16a=_0x352ec6[_0x2878b8-0x3]^_0x352ec6[_0x2878b8-0x8]^_0x352ec6[_0x2878b8-0xe]^_0x352ec6[_0x2878b8-0x10];_0x352ec6[_0x2878b8]=_0x4cf16a&lt;&lt;0x1|_0x4cf16a&gt;&gt;&gt;0x1f;&#125;var _0x3da440=(_0x261089&lt;&lt;0x5|_0x261089&gt;&gt;&gt;0x1b)+_0x134614+_0x352ec6[_0x2878b8];_0x3da440+=_0x2878b8&lt;0x14?0x5a827999+(_0x1b02d9&amp;_0xbe4c94|~_0x1b02d9&amp;_0x5ea3f1):_0x2878b8&lt;0x28?0x6ed9eba1+(_0x1b02d9^_0xbe4c94^_0x5ea3f1):_0x2878b8&lt;0x3c?(_0x1b02d9&amp;_0xbe4c94|_0x1b02d9&amp;_0x5ea3f1|_0xbe4c94&amp;_0x5ea3f1)-0x70e44324:(_0x1b02d9^_0xbe4c94^_0x5ea3f1)-0x359d3e2a,_0x134614=_0x5ea3f1,_0x5ea3f1=_0xbe4c94,_0xbe4c94=_0x1b02d9&lt;&lt;0x1e|_0x1b02d9&gt;&gt;&gt;0x2,_0x1b02d9=_0x261089,_0x261089=_0x3da440;&#125;_0x3ce8f2[0x0]=_0x3ce8f2[0x0]+_0x261089|0x0,_0x3ce8f2[0x1]=_0x3ce8f2[0x1]+_0x1b02d9|0x0,_0x3ce8f2[0x2]=_0x3ce8f2[0x2]+_0xbe4c94|0x0,_0x3ce8f2[0x3]=_0x3ce8f2[0x3]+_0x5ea3f1|0x0,_0x3ce8f2[0x4]=_0x3ce8f2[0x4]+_0x134614|0x0;&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x135766=this[&#x27;_data&#x27;],_0x883405=_0x135766[&#x27;words&#x27;],_0x3785b2=0x8*this[&#x27;_nDataBytes&#x27;],_0x298e2b=0x8*_0x135766[&#x27;sigBytes&#x27;];return _0x883405[_0x298e2b&gt;&gt;&gt;0x5]|=0x80&lt;&lt;0x18-_0x298e2b%0x20,_0x883405[0xe+(_0x298e2b+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=Math[&#x27;floor&#x27;](_0x3785b2/0x100000000),_0x883405[0xf+(_0x298e2b+0x40&gt;&gt;&gt;0x9&lt;&lt;0x4)]=_0x3785b2,_0x135766[&#x27;sigBytes&#x27;]=0x4*_0x883405[&#x27;length&#x27;],this[&#x27;_process&#x27;](),this[&#x27;_hash&#x27;];&#125;,&#x27;clone&#x27;:function()&#123;var _0x3af03d=_0x5e8caa[&#x27;clone&#x27;][&#x27;call&#x27;](this);return _0x3af03d[&#x27;_hash&#x27;]=this[&#x27;_hash&#x27;][&#x27;clone&#x27;](),_0x3af03d;&#125;&#125;);_0x1d0209[&#x27;SHA1&#x27;]=_0x5e8caa[&#x27;_createHelper&#x27;](_0x111211),_0x1d0209[&#x27;HmacSHA1&#x27;]=_0x5e8caa[&#x27;_createHmacHelper&#x27;](_0x111211);&#125;(),_0x23e72c[&#x27;SHA1&#x27;];&#125;));&#125;,&#x27;e61b&#x27;:function(_0x13d2dd,_0x567a3e,_0x57725a)&#123;(function(_0x20798a,_0x12326d,_0x413122)&#123;_0x13d2dd[&#x27;exports&#x27;]=_0x12326d(_0x57725a(&#x27;21bf&#x27;),_0x57725a(&#x27;3252&#x27;));&#125;(0x0,function(_0x66d4bc)&#123;return function(_0x137268)&#123;var _0x3ed145=_0x66d4bc,_0x7cc5e7=_0x3ed145[&#x27;lib&#x27;],_0x1476e5=_0x7cc5e7[&#x27;WordArray&#x27;],_0x564448=_0x7cc5e7[&#x27;Hasher&#x27;],_0x4d6fa2=_0x3ed145[&#x27;x64&#x27;],_0x40e4d2=_0x4d6fa2[&#x27;Word&#x27;],_0x42aef8=_0x3ed145[&#x27;algo&#x27;],_0x9c7b92=[],_0x518ca1=[],_0x46c77e=[];(function()&#123;for(var _0x4ebca2=0x1,_0x496333=0x0,_0x56e545=0x0;_0x56e545&lt;0x18;_0x56e545++)&#123;_0x9c7b92[_0x4ebca2+0x5*_0x496333]=(_0x56e545+0x1)*(_0x56e545+0x2)/0x2%0x40;var _0x33d980=_0x496333%0x5,_0x450c02=(0x2*_0x4ebca2+0x3*_0x496333)%0x5;_0x4ebca2=_0x33d980,_0x496333=_0x450c02;&#125;for(_0x4ebca2=0x0;_0x4ebca2&lt;0x5;_0x4ebca2++)for(_0x496333=0x0;_0x496333&lt;0x5;_0x496333++)_0x518ca1[_0x4ebca2+0x5*_0x496333]=_0x496333+(0x2*_0x4ebca2+0x3*_0x496333)%0x5*0x5;for(var _0x86d0e5=0x1,_0x1d69fa=0x0;_0x1d69fa&lt;0x18;_0x1d69fa++)&#123;for(var _0x1f92b3=0x0,_0x4c625e=0x0,_0x3c0d9d=0x0;_0x3c0d9d&lt;0x7;_0x3c0d9d++)&#123;if(0x1&amp;_0x86d0e5)&#123;var _0x4db9b0=(0x1&lt;&lt;_0x3c0d9d)-0x1;_0x4db9b0&lt;0x20?_0x4c625e^=0x1&lt;&lt;_0x4db9b0:_0x1f92b3^=0x1&lt;&lt;_0x4db9b0-0x20;&#125;0x80&amp;_0x86d0e5?_0x86d0e5=_0x86d0e5&lt;&lt;0x1^0x71:_0x86d0e5&lt;&lt;=0x1;&#125;_0x46c77e[_0x1d69fa]=_0x40e4d2[&#x27;create&#x27;](_0x1f92b3,_0x4c625e);&#125;&#125;());var _0x337b2b=[];(function()&#123;for(var _0x530b02=0x0;_0x530b02&lt;0x19;_0x530b02++)_0x337b2b[_0x530b02]=_0x40e4d2[&#x27;create&#x27;]();&#125;());var _0x4427a8=_0x42aef8[&#x27;SHA3&#x27;]=_0x564448[&#x27;extend&#x27;](&#123;&#x27;cfg&#x27;:_0x564448[&#x27;cfg&#x27;][&#x27;extend&#x27;](&#123;&#x27;outputLength&#x27;:0x200&#125;),&#x27;_doReset&#x27;:function()&#123;for(var _0x2196da=this[&#x27;_state&#x27;]=[],_0x422166=0x0;_0x422166&lt;0x19;_0x422166++)_0x2196da[_0x422166]=new _0x40e4d2[&#x27;init&#x27;]();this[&#x27;blockSize&#x27;]=(0x640-0x2*this[&#x27;cfg&#x27;][&#x27;outputLength&#x27;])/0x20;&#125;,&#x27;_doProcessBlock&#x27;:function(_0x374f7b,_0x135244)&#123;for(var _0x35f975=this[&#x27;_state&#x27;],_0x218810=this[&#x27;blockSize&#x27;]/0x2,_0x32619e=0x0;_0x32619e&lt;_0x218810;_0x32619e++)&#123;var _0x8e9fb3=_0x374f7b[_0x135244+0x2*_0x32619e],_0x23d9d1=_0x374f7b[_0x135244+0x2*_0x32619e+0x1];_0x8e9fb3=0xff00ff&amp;(_0x8e9fb3&lt;&lt;0x8|_0x8e9fb3&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x8e9fb3&lt;&lt;0x18|_0x8e9fb3&gt;&gt;&gt;0x8),_0x23d9d1=0xff00ff&amp;(_0x23d9d1&lt;&lt;0x8|_0x23d9d1&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x23d9d1&lt;&lt;0x18|_0x23d9d1&gt;&gt;&gt;0x8);var _0x682ed3=_0x35f975[_0x32619e];_0x682ed3[&#x27;high&#x27;]^=_0x23d9d1,_0x682ed3[&#x27;low&#x27;]^=_0x8e9fb3;&#125;for(var _0x343a4c=0x0;_0x343a4c&lt;0x18;_0x343a4c++)&#123;for(var _0x4ab4ee=0x0;_0x4ab4ee&lt;0x5;_0x4ab4ee++)&#123;for(var _0x7ba049=0x0,_0xb27982=0x0,_0x365666=0x0;_0x365666&lt;0x5;_0x365666++)&#123;_0x682ed3=_0x35f975[_0x4ab4ee+0x5*_0x365666];_0x7ba049^=_0x682ed3[&#x27;high&#x27;],_0xb27982^=_0x682ed3[&#x27;low&#x27;];&#125;var _0x410c19=_0x337b2b[_0x4ab4ee];_0x410c19[&#x27;high&#x27;]=_0x7ba049,_0x410c19[&#x27;low&#x27;]=_0xb27982;&#125;for(_0x4ab4ee=0x0;_0x4ab4ee&lt;0x5;_0x4ab4ee++)&#123;var _0x1abdd5=_0x337b2b[(_0x4ab4ee+0x4)%0x5],_0x53bf08=_0x337b2b[(_0x4ab4ee+0x1)%0x5],_0x329a06=_0x53bf08[&#x27;high&#x27;],_0x1705b7=_0x53bf08[&#x27;low&#x27;];for(_0x7ba049=_0x1abdd5[&#x27;high&#x27;]^(_0x329a06&lt;&lt;0x1|_0x1705b7&gt;&gt;&gt;0x1f),_0xb27982=_0x1abdd5[&#x27;low&#x27;]^(_0x1705b7&lt;&lt;0x1|_0x329a06&gt;&gt;&gt;0x1f),_0x365666=0x0;_0x365666&lt;0x5;_0x365666++)&#123;_0x682ed3=_0x35f975[_0x4ab4ee+0x5*_0x365666];_0x682ed3[&#x27;high&#x27;]^=_0x7ba049,_0x682ed3[&#x27;low&#x27;]^=_0xb27982;&#125;&#125;for(var _0x190161=0x1;_0x190161&lt;0x19;_0x190161++)&#123;_0x682ed3=_0x35f975[_0x190161];var _0x2a7a00=_0x682ed3[&#x27;high&#x27;],_0x1bdb4a=_0x682ed3[&#x27;low&#x27;],_0x43999f=_0x9c7b92[_0x190161];if(_0x43999f&lt;0x20)_0x7ba049=_0x2a7a00&lt;&lt;_0x43999f|_0x1bdb4a&gt;&gt;&gt;0x20-_0x43999f,_0xb27982=_0x1bdb4a&lt;&lt;_0x43999f|_0x2a7a00&gt;&gt;&gt;0x20-_0x43999f;else _0x7ba049=_0x1bdb4a&lt;&lt;_0x43999f-0x20|_0x2a7a00&gt;&gt;&gt;0x40-_0x43999f,_0xb27982=_0x2a7a00&lt;&lt;_0x43999f-0x20|_0x1bdb4a&gt;&gt;&gt;0x40-_0x43999f;var _0x2fb713=_0x337b2b[_0x518ca1[_0x190161]];_0x2fb713[&#x27;high&#x27;]=_0x7ba049,_0x2fb713[&#x27;low&#x27;]=_0xb27982;&#125;var _0x2fba77=_0x337b2b[0x0],_0x4a71fd=_0x35f975[0x0];_0x2fba77[&#x27;high&#x27;]=_0x4a71fd[&#x27;high&#x27;],_0x2fba77[&#x27;low&#x27;]=_0x4a71fd[&#x27;low&#x27;];for(_0x4ab4ee=0x0;_0x4ab4ee&lt;0x5;_0x4ab4ee++)for(_0x365666=0x0;_0x365666&lt;0x5;_0x365666++)&#123;_0x190161=_0x4ab4ee+0x5*_0x365666,_0x682ed3=_0x35f975[_0x190161];var _0xf3ea62=_0x337b2b[_0x190161],_0x2f5f34=_0x337b2b[(_0x4ab4ee+0x1)%0x5+0x5*_0x365666],_0x174314=_0x337b2b[(_0x4ab4ee+0x2)%0x5+0x5*_0x365666];_0x682ed3[&#x27;high&#x27;]=_0xf3ea62[&#x27;high&#x27;]^~_0x2f5f34[&#x27;high&#x27;]&amp;_0x174314[&#x27;high&#x27;],_0x682ed3[&#x27;low&#x27;]=_0xf3ea62[&#x27;low&#x27;]^~_0x2f5f34[&#x27;low&#x27;]&amp;_0x174314[&#x27;low&#x27;];&#125;_0x682ed3=_0x35f975[0x0];var _0x388faf=_0x46c77e[_0x343a4c];_0x682ed3[&#x27;high&#x27;]^=_0x388faf[&#x27;high&#x27;],_0x682ed3[&#x27;low&#x27;]^=_0x388faf[&#x27;low&#x27;];&#125;&#125;,&#x27;_doFinalize&#x27;:function()&#123;var _0x1a58c7=this[&#x27;_data&#x27;],_0x3d4714=_0x1a58c7[&#x27;words&#x27;],_0x1a8d7c=(this[&#x27;_nDataBytes&#x27;],0x8*_0x1a58c7[&#x27;sigBytes&#x27;]),_0x4609f2=0x20*this[&#x27;blockSize&#x27;];_0x3d4714[_0x1a8d7c&gt;&gt;&gt;0x5]|=0x1&lt;&lt;0x18-_0x1a8d7c%0x20,_0x3d4714[(_0x137268[&#x27;ceil&#x27;]((_0x1a8d7c+0x1)/_0x4609f2)*_0x4609f2&gt;&gt;&gt;0x5)-0x1]|=0x80,_0x1a58c7[&#x27;sigBytes&#x27;]=0x4*_0x3d4714[&#x27;length&#x27;],this[&#x27;_process&#x27;]();for(var _0x45f1f7=this[&#x27;_state&#x27;],_0x47fe05=this[&#x27;cfg&#x27;][&#x27;outputLength&#x27;]/0x8,_0x7d05f3=_0x47fe05/0x8,_0x5117ab=[],_0x31f4b2=0x0;_0x31f4b2&lt;_0x7d05f3;_0x31f4b2++)&#123;var _0x46636f=_0x45f1f7[_0x31f4b2],_0x4a7f2f=_0x46636f[&#x27;high&#x27;],_0x207355=_0x46636f[&#x27;low&#x27;];_0x4a7f2f=0xff00ff&amp;(_0x4a7f2f&lt;&lt;0x8|_0x4a7f2f&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x4a7f2f&lt;&lt;0x18|_0x4a7f2f&gt;&gt;&gt;0x8),_0x207355=0xff00ff&amp;(_0x207355&lt;&lt;0x8|_0x207355&gt;&gt;&gt;0x18)|0xff00ff00&amp;(_0x207355&lt;&lt;0x18|_0x207355&gt;&gt;&gt;0x8),_0x5117ab[&#x27;push&#x27;](_0x207355),_0x5117ab[&#x27;push&#x27;](_0x4a7f2f);&#125;return new _0x1476e5[&#x27;init&#x27;](_0x5117ab,_0x47fe05);&#125;,&#x27;clone&#x27;:function()&#123;for(var _0x58ac6f=_0x564448[&#x27;clone&#x27;][&#x27;call&#x27;](this),_0x1dda57=_0x58ac6f[&#x27;_state&#x27;]=this[&#x27;_state&#x27;][&#x27;slice&#x27;](0x0),_0x4ae54f=0x0;_0x4ae54f&lt;0x19;_0x4ae54f++)_0x1dda57[_0x4ae54f]=_0x1dda57[_0x4ae54f][&#x27;clone&#x27;]();return _0x58ac6f;&#125;&#125;);_0x3ed145[&#x27;SHA3&#x27;]=_0x564448[&#x27;_createHelper&#x27;](_0x4427a8),_0x3ed145[&#x27;HmacSHA3&#x27;]=_0x564448[&#x27;_createHmacHelper&#x27;](_0x4427a8);&#125;(Math),_0x66d4bc[&#x27;SHA3&#x27;];&#125;));&#125;,&#x27;f4ea&#x27;:function(_0x4db186,_0x39edda,_0x53d69e)&#123;(function(_0x329f1d,_0x950c5a,_0x366e3d)&#123;_0x4db186[&#x27;exports&#x27;]=_0x950c5a(_0x53d69e(&#x27;21bf&#x27;),_0x53d69e(&#x27;38ba&#x27;));&#125;(0x0,function(_0x196b76)&#123;return _0x196b76[&#x27;mode&#x27;][&#x27;CTR&#x27;]=function()&#123;var _0x4011d5=_0x196b76[&#x27;lib&#x27;][&#x27;BlockCipherMode&#x27;][&#x27;extend&#x27;](),_0x23c95c=_0x4011d5[&#x27;Encryptor&#x27;]=_0x4011d5[&#x27;extend&#x27;](&#123;&#x27;processBlock&#x27;:function(_0x14c80e,_0x2b0aa9)&#123;var _0x199e94=this[&#x27;_cipher&#x27;],_0x5070a4=_0x199e94[&#x27;blockSize&#x27;],_0x49cae6=this[&#x27;_iv&#x27;],_0x4a3ff0=this[&#x27;_counter&#x27;];_0x49cae6&amp;&amp;(_0x4a3ff0=this[&#x27;_counter&#x27;]=_0x49cae6[&#x27;slice&#x27;](0x0),this[&#x27;_iv&#x27;]=void 0x0);var _0x3f8633=_0x4a3ff0[&#x27;slice&#x27;](0x0);_0x199e94[&#x27;encryptBlock&#x27;](_0x3f8633,0x0),_0x4a3ff0[_0x5070a4-0x1]=_0x4a3ff0[_0x5070a4-0x1]+0x1|0x0;for(var _0x14e209=0x0;_0x14e209&lt;_0x5070a4;_0x14e209++)_0x14c80e[_0x2b0aa9+_0x14e209]^=_0x3f8633[_0x14e209];&#125;&#125;);return _0x4011d5[&#x27;Decryptor&#x27;]=_0x23c95c,_0x4011d5;&#125;(),_0x196b76[&#x27;mode&#x27;][&#x27;CTR&#x27;];&#125;));&#125;&#125;]);</span><br></pre></td></tr></table></figure>

<p>可以看到一些变量是十六进制字符串，而且代码全被压缩了。</p>
<p>我们就是要在这里找出token和id的构造逻辑。</p>
<p>要完全分析出整个网站的加密逻辑还是有一定难度的，不过不用担心，本节我们会一步一步地讲解逆向的思路、方法和技巧。</p>
<h3 id="14-2-寻找列表页Ajax入口"><a href="#14-2-寻找列表页Ajax入口" class="headerlink" title="14.2 寻找列表页Ajax入口"></a>14.2 寻找列表页Ajax入口</h3><p>两种方式：</p>
<ul>
<li>全局搜索标志字符串</li>
<li>设置Ajax断点</li>
</ul>
<p>我们之前讲过第二种，现在以第一种为例：</p>
<p>一些关键的字符串通常会被作为寻找JavaScript混淆入口的依据，我们可以通过全局搜索的方式来查找，然后根据搜索到的结果大体观察是否为我们想要找的入口。</p>
<p>重新打开列表页的Ajax接口，看一下请求的Ajax接口，如图：</p>


<p>这里Ajax接口的url为：<code>https://spa6.scrape.center/api/movie/?limit=10&amp;offset=0&amp;token=YjdmMDNmMzMwMzYwOWFjZjE2ZDE2NGJhYTg3NmUxMGU3OWYxYjQ3OCwxNjY0OTcyMDk3</code></p>
<p>可以看到带有limit、offset、token三个参数，关键就是token，我们就全局搜索是否存在token，点击开发者工具右上角的“三个小竖点”选项，然后点击Search，如图：</p>


<p>这样我们就能进入全局搜索模式，搜索token，可以看到的确搜索到了几个结果，如图：</p>


<p>观察一下，下面的两个结果可能是我们想要的，点击第一个进入看看，此时定位到一个JavaScript文件，如图：</p>


<p>这时可以看到整个代码都是经过压缩的，只有一行，不好看，点击左下角的{}按钮，格式化JavaScript代码，格式化后的结果如图：</p>


<p>可以看到，这里弹出来一个新的选项卡，其名称是“JavaScript文件名 + :formatted”，代表格式化后的代码结果。这里我们再次定位到token观察一下。</p>
<p>可以看到，这里有limit、offset、token。然后观察其他的逻辑，基本上能够确定这就是构造Ajax请求的地方，如果不是的话，可以继续搜索其他的文件观察。</p>
<p>现在，我们就成功找到了混淆的入口，这是一个寻找入口的首先方法。</p>
<h3 id="14-3-寻找列表页加密逻辑"><a href="#14-3-寻找列表页加密逻辑" class="headerlink" title="14.3 寻找列表页加密逻辑"></a>14.3 寻找列表页加密逻辑</h3><p>我们已经找到token的位置了，可以观察这个token对应的变量，他叫作_0x263439，所以关键就是要看看这个变量是哪里来的。</p>
<p>这时添加断点就好了。</p>
<p>看下这个变量哪里产生的，然后我们在对应的行添加断点。如图：</p>


<p>这时我们就设置了一个新断点。由于只有一个断点，刷新网页后，我们会发现网页停在新的断点上，如图：</p>


<p>这是我们就可以观察正在运行的一些变量了，比如把鼠标放在各个变量上，可以看到变量的值和类型；把鼠标放在变量_0x2fa7bd上，会有一个浮窗显示，如图：</p>


<p>另外，还可以在右侧的Watch面板中添加想要查看的变量，如这行代码的内容为：</p>
<p>, _0x263439 &#x3D; Object(_0x2fa7bd[‘a’])(this[‘$store’][‘state’][‘url’][‘index’]);</p>
<p>我们比较感兴趣的是_0x2fa7bd，还有this里的$store属性。展开Watch面板。然后点击+号，把想看的变量添加到Watch面板里面，如图：</p>


<p>可以发现 ，_0x2fa7bd是一个对象，它具有属性a，其值是一个方法。this[‘$store’][‘state’][‘url’][‘index’]的值其实就是&#x2F;api&#x2F;movie，即Ajax请求的URL的path。__0x263439就是调用前者的方法传入&#x2F;api&#x2F;movie得到的。</p>
<p>下一步就是去寻找这个方法。我们可以把Watch面板的_0x2fa7bd展开，这里显示的FunctionLocation就是这个函数的代码位置，如图：</p>


<p>点击进入。</p>
<p>这时我们就进入一个新的名字为_0x456254的方法里，在这个方法中，应该就有token的生成逻辑，添加断点然后点击面板Resume script execution按钮，如图：</p>


<p>接下来，我们不断进行单步调试，观察一下这里的执行逻辑和每一步调试的结果都有什么变化，如图：</p>


<p>在每一步的执行过程中，我们可以发现一些运行值会被打到代码的右侧并高亮显示，同时在Watch面板下还能看到每一步的具体结果。</p>
<p>最后我们总结出这个token的构造逻辑，如下：</p>
<ul>
<li>传入的&#x2F;api&#x2F;movie会构造一个初始化列表，将变量命名为_0x31a891。</li>
<li>获取当前时间戳，命名为_0x5da681，调用push方法将其添加到_0x31a891变量代表的列表中。</li>
<li>将_0x31a891变量用，拼接，然后进行SHA1编码，命名为_0xf7c3c7。</li>
<li>将_0xf7c3c7（SHA1编码的结果）和_0x5da681（时间戳）用逗号拼接，命名为_0x3c8435。</li>
<li>将_0x3c8435进行Base64编码，命名为_0x104b5b，得到最后的token。</li>
</ul>
<p>经过反复的观察，以上逻辑可以比较轻松地总结出来，其中有些变量可以实时地查看，同时也可以自己输入到控制台上进行反复验证。</p>
<p>现在加密逻辑我们就分析出来了，基本思路就是：</p>
<ul>
<li>将&#x2F;api&#x2F;movie放到一个列表里；</li>
<li>在列表中加入当前的时间戳；</li>
<li>将列表内容用逗号拼接；</li>
<li>将拼接的结果进行SHA1编码；</li>
<li>将编码的结果和时间戳再次拼接；</li>
<li>将拼接后的结果进行Base64编码。</li>
</ul>
<p>验证一下，如果逻辑没问题，我们就可以用python来实现了。</p>
<h3 id="14-4-使用python实现列表页的爬取"><a href="#14-4-使用python实现列表页的爬取" class="headerlink" title="14.4 使用python实现列表页的爬取"></a>14.4 使用python实现列表页的爬取</h3><p>要用python实现这个逻辑，我们需要借助两个库：一个是hashlib，他提供了sha1的方法；另一个是base64库，他提供了b64encode方法对结果进行Base64编码，实现代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import time</span><br><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">INDEX_URL = &quot;https://spa6.scrape.center/api/movie/?limit=&#123;&#125;&amp;offset=&#123;&#125;&amp;token=&#123;&#125;&quot;</span><br><span class="line">LIMIT = 10</span><br><span class="line">OFFSET = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_token(args):</span><br><span class="line">    # * 在列表中加入当前的时间戳；</span><br><span class="line">    timestamp = str(int(time.time()))</span><br><span class="line">    args.append(timestamp)</span><br><span class="line">    # * 将列表内容用逗号拼接；</span><br><span class="line">    # * 将拼接的结果进行SHA1编码；</span><br><span class="line">    sign = hashlib.sha1(&quot;,&quot;.join(args).encode(&quot;utf-8&quot;)).hexdigest()</span><br><span class="line">    # * 将编码的结果和时间戳再次拼接；</span><br><span class="line">    # * 将拼接后的结果进行Base64编码。</span><br><span class="line">    return base64.b64encode(&quot;,&quot;.join([sign, timestamp]).encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    # * 将/api/movie放到一个列表里；</span><br><span class="line">    args = [&#x27;/api/movie&#x27;]</span><br><span class="line">    token = get_token(args)</span><br><span class="line">    for i in range(10):</span><br><span class="line">        index_url = INDEX_URL.format(LIMIT, OFFSET + (i*10), token)</span><br><span class="line">        # print(index_url)</span><br><span class="line">        response = requests.get(index_url)</span><br><span class="line">        print(response.json())</span><br></pre></td></tr></table></figure>

<p>我们根据上面的逻辑把加密流程实现了出来，并且爬取到了十页的内容。</p>
<h3 id="14-5-寻找详情页加密id入口"><a href="#14-5-寻找详情页加密id入口" class="headerlink" title="14.5 寻找详情页加密id入口"></a>14.5 寻找详情页加密id入口</h3><p>观察上一步的输出结果，把结果格式化，这里看看部分结果：</p>


<p>这里我们看到有个id是1，另外还有一个一些其他的字段，如电影名称、封面、类别等，这里面一定有某个信息是用来唯一区分某个电影的。</p>
<p>但是当我们点击第一部电影的信息时，可以看到它跳转了URL为<a target="_blank" rel="noopener" href="https://spa6.scrape.center/detail/ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx%E7%9A%84%E9%A1%B5%E9%9D%A2%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E8%BF%99%E9%87%8C%E7%9A%84URL%E9%87%8C%E9%9D%A2%E6%9C%89%E4%B8%80%E4%B8%AA%E5%8A%A0%E5%AF%86id%E4%B8%BAZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx%E4%BB%96%E5%92%8C%E7%94%B5%E5%BD%B1%E8%BF%99%E4%BA%9B%E4%BF%A1%E6%81%AF%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%E5%91%A2%EF%BC%9F">https://spa6.scrape.center/detail/ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx的页面，可以看到这里的URL里面有一个加密id为ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx他和电影这些信息有什么关系呢？</a></p>
<p>如果你仔细观察，其实可以比较容易地找出规律来，但是这总归是观察出来的，如果遇到一些观察不出规律的，那就很麻烦了，因此，还需要靠技巧去找到它真正的加密位置。这时候该怎么办呢？</p>
<p>分析一下，这个加密id到底是怎么生成的。</p>
<p>点击详情页的时候，我们就可以看到它访问的URL里面就带上了	ZWYzNCN0ZXVxMGJ0dWEjKC01N3cxcTVvNS0takA5OHh5Z2ltbHlmeHMqLSFpLTAtbWIx这个加密id了。而且不同详情页的加密id是不同的，这就说明这个加密id的构成依赖于列表页Ajax的返回结果。因此，可以确定这个加密id的生成发生在Ajax请求完成后或者点击详情页的一瞬间。</p>
<p>为了进一步确定这发生在何时，我们查看页面源码，可以看到在没有点击之前，详情页链接的href里面就已经带有加密id了，如图：</p>


<p>由此可以确定，这个加密id是在Ajax请求完成之后生成的，而且肯定也是由JavaScript生成的。</p>
<p>怎么去找Ajax完成之后的事件呢？是否应该去找Ajax完成之后的事件呢？</p>
<p>可以试试。在Sources面板的右侧，有一个Event Listener Breakpoints，这里有一个XHR的监听，包括发起时、成功后、发生错误时的一些监听，这里我们勾选上readystatechange事件，代表Ajax得到响应时的事件，其他断点都可以删除，然后刷新页面看一下，如图：</p>




<p>可以看到，此时就停在Ajax得到响应时的位置了。我们怎么知道这个id时如何加密的呢？可以选择通过断点一步一步调试下去，但这个过程非常繁琐，因为这里可能会逐渐用到页面UI渲染的一些底层实现，甚至可能找着找着都不知道找到哪儿去了。</p>
<p>怎么办呢？这里我们又可以用上前文介绍的用于快速定位的方法，那就是Hook，这里就不再展开讲解原理了。</p>
<p>那么，这里怎么用Hook的方式来找到加密id的加密入口呢？</p>
<p>想一下，这个加密id是一个Base64编码的字符串，那么生成过程中想必就调用了JavaScript的Base64编码的方法，这个方法名叫作btoa。当然，Base64也有其他的实现方式，比如利用crypto-js库实现，但可能底层调用的就不是btoa方法了。</p>
<p>现在，我们其实并不确定是不是通过调用btoa方法实现的Base64编码，那就先试试吧。</p>
<p>要实现Hook，关键在于将原来的方法改写，这里我们其实就是Hook btoa这个方法了，btoa这个方法属于window对象，这里直接改写成window对象的btoa方法即可。改写的逻辑如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(function () &#123;</span><br><span class="line">    &#x27;use strict&#x27;</span><br><span class="line">    function hook(object, attr) &#123;</span><br><span class="line">	var func = object[attr]</span><br><span class="line">        object[attr] = function () &#123;</span><br><span class="line">	    console.log(&#x27;hooked&#x27;, object, attr, arguments)</span><br><span class="line">	    var ret = func.apply(object, arguments)</span><br><span class="line">	    debugger</span><br><span class="line">	    console.log(&#x27;result&#x27;, ret)</span><br><span class="line">	    return ret</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	hook(window, &#x27;btoa&#x27;)</span><br><span class="line">    &#125;) ()</span><br></pre></td></tr></table></figure>

<p>这里我们定义了一个hook方法，给其传入object和attr参数，意思就是Hook object对象的attr参数。例如，如果我们想Hook alert方法，那就把object设置为window，把attr设置为字符串alert。这里我们想要Hook Base64的编码方法，所以只需要Hook window对象的btoa方法就好了。</p>
<p>hook方法的第一句话var func &#x3D; object[attr]，相当于把他赋值为一个变量，我们调用func方法就可以实现和原来一样的功能。然后我们改写这个方法的定义，将其改写成一个新的方法，在新的方法中，通过func.apply方法又重新调用了原来的方法。这样我们可以保证前后方法的执行效果不受影响的前提下，在func方法执行的前后加入自己的代码，如使用console.log将信息输出到控制台，通过debugger进入断点等。在这个过程中，我们先临时保存func方法，然后定义一个新方法来接管程序控制权，在其中定义我们想要的实现，同时在新方法里重新调回func方法，保证前后的结果不受影响。因此，我们达到了在不影响原有方法效果的前提下，可以实现在方法的前后实现自定义的功能，就是Hook的完整实现过程。</p>
<p>最后我们调用Hook方法，传入window对象和btoa字符串即可。</p>
<p>怎么去注入这个代码呢？有三种注入方法。</p>
<ul>
<li>控制台注入</li>
<li>重写JavaScript</li>
<li>Tampermonkey注入</li>
</ul>
<p>我们以重写JavaScript为例：</p>
<p>借助Chrome浏览器的Overrides功能，我们可以实现某些JavaScript文件的重写和保存。Overrides会在本地生成一个JavaScript的文件副本，以后每次刷新，都会使用副本的内容。</p>
<p>这里我们需要切换到Sources面板中的Overrides选项卡，然后选择一个文件夹，比如这里我自定义了一个ChromeOverrides文件夹，如图：</p>


<p>然后选一个JavaScript脚本，在后面贴上这段注入脚本，保存之后进行刷新，如图：</p>


<p>可以发现，现在浏览器加载的JavaScript文件就是我们修改过后的了，文件名左侧会有一个原点标识符。</p>
<p>同时我们还注意到，目前直接进入断点模式，并且成功Hook到btoa方法。</p>
<p>其实Overrides的功能非常有用，有了它，我们可以持久化保存任意修改的JavaScript代码，想在哪里改都可以了，甚至可以直接修改JavaScript的原始执行逻辑。</p>
<h3 id="14-6-寻找详情页Ajax的token"><a href="#14-6-寻找详情页Ajax的token" class="headerlink" title="14.6 寻找详情页Ajax的token"></a>14.6 寻找详情页Ajax的token</h3><p>现在我们已经找到详情页的加密id，但是还差一步，其Ajax请求也有一个token，如图：</p>


<p>因为这个是Ajax请求，其实这个token和列表页token的构造逻辑是一样的。</p>
<h3 id="14-7-使用python实现详情页爬取"><a href="#14-7-使用python实现详情页爬取" class="headerlink" title="14.7 使用python实现详情页爬取"></a>14.7 使用python实现详情页爬取</h3><p>现在，我们已经成功把详情页的加密逻辑id和Ajax请求的token找出来了，下一步就是使用python完成爬取。这里我们只实现第一页的爬取，示例代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import time</span><br><span class="line">import base64</span><br><span class="line">from typing import List, Any</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">INDEX_URL = &#x27;https://spa6.scrape.center/api/movie?limit=&#123;limit&#125;&amp;offset=&#123;offset&#125;&amp;token=&#123;token&#125;&#x27;</span><br><span class="line">DETAIL_URL = &#x27;https://spa6.scrape.center/api/movie/&#123;id&#125;?token=&#123;token&#125;&#x27;</span><br><span class="line">LIMIT = 10</span><br><span class="line">OFFSET = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_token(args: List[Any]):</span><br><span class="line">    timestamp = str(int(time.time()))</span><br><span class="line">    args.append(timestamp)</span><br><span class="line">    sign = hashlib.sha1(&#x27;,&#x27;.join(args).encode(&#x27;utf-8&#x27;)).hexdigest()</span><br><span class="line">    return base64.b64encode(&#x27;,&#x27;.join([sign, timestamp]).encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">args = [&#x27;/api/movie&#x27;]</span><br><span class="line">token = get_token(args=args)</span><br><span class="line">index_url = INDEX_URL.format(limit=LIMIT, offset=OFFSET, token=token)</span><br><span class="line">response = requests.get(index_url)</span><br><span class="line"># print(&#x27;response&#x27;, response.json())</span><br><span class="line"></span><br><span class="line">result = response.json()</span><br><span class="line">for item in result[&#x27;results&#x27;]:</span><br><span class="line">    id = item[&#x27;id&#x27;]</span><br><span class="line">    encrypt_id = base64.b64encode(str(id).encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)</span><br><span class="line">    args = [f&#x27;/api/movie/&#123;encrypt_id&#125;&#x27;]</span><br><span class="line">    token = get_token(args=args)</span><br><span class="line">    detail_url = DETAIL_URL.format(id=encrypt_id, token=token)</span><br><span class="line">    response = requests.get(detail_url)</span><br><span class="line">    print(&#x27;response&#x27;, response.json())</span><br></pre></td></tr></table></figure>

<p>这里模拟了详情页的加密id和token的构造过程，然后请求了详情页，获取到了响应。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">J-Guardian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/03/03/WebJs%E9%80%86%E5%90%91/">http://example.com/2025/03/03/WebJs%E9%80%86%E5%90%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">网络安全学习</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/02/28/%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91/" title="脚本开发"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">脚本开发</div></div><div class="info-2"><div class="info-item-1">Python多线程和异步（Asynchronous...</div></div></div></a><a class="pagination-related" href="/2025/03/04/CISSP/" title="CISSP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">CISSP</div></div><div class="info-2"><div class="info-item-1">考前冲刺真题端口镜像（Port Mirroring）端口镜像是将指定端口（或 VLAN）的流量复制到另一个监控端口，以便进行流量分析或日志记录。端口镜像是将指定端口（或 VLAN）的流量复制到另一个监控端口，以便进行流量分析或日志记录。镜像流量可以是单向也可以是双向。需查看交换机的管理日志，可以通过23 端口进行查看。  对网络性能的影响较小，因为镜像功能通常由交换机的专用硬件实现。 支持更复杂的配置，例如选择特定...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">J-Guardian</div><div class="author-info-description">计算机网络、web安全、组件漏洞、SRC</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#web-js%E9%80%86%E5%90%91"><span class="toc-number">1.</span> <span class="toc-text">web js逆向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80"><span class="toc-number"></span> <span class="toc-text">第一章 逆向基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">1.1 语法基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.</span> <span class="toc-text">1.2 作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%AA%97%E5%8F%A3%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7"><span class="toc-number">3.</span> <span class="toc-text">1.3 窗口对象属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E4%BA%8B%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">1.4 事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-number"></span> <span class="toc-text">第二章 浏览器控制台</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Network"><span class="toc-number">1.</span> <span class="toc-text">2.1 Network</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Network-Headers"><span class="toc-number">1.1.</span> <span class="toc-text">2.1.1 Network-Headers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Network-Header-General"><span class="toc-number">1.1.1.</span> <span class="toc-text">Network-Header-General</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Network-Header-Response-Headers"><span class="toc-number">1.1.2.</span> <span class="toc-text">Network-Header-Response Headers</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Network-Header-Request-Headers"><span class="toc-number">1.1.3.</span> <span class="toc-text">Network-Header-Request Headers</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Sources"><span class="toc-number">2.</span> <span class="toc-text">2.2 Sources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Application"><span class="toc-number">3.</span> <span class="toc-text">2.3 Application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Console"><span class="toc-number">4.</span> <span class="toc-text">2.4 Console</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-javascript-obfuscator%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.</span> <span class="toc-text">4.3 javascript-obfuscator示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.1.</span> <span class="toc-text">4.3.1 代码压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E5%8F%98%E9%87%8F%E5%90%8D%E6%B7%B7%E6%B7%86"><span class="toc-number">5.2.</span> <span class="toc-text">4.3.2 变量名混淆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B7%B7%E6%B7%86"><span class="toc-number">5.3.</span> <span class="toc-text">4.3.3 字符串混淆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-4-%E4%BB%A3%E7%A0%81%E8%87%AA%E6%88%91%E4%BF%9D%E6%8A%A4"><span class="toc-number">5.4.</span> <span class="toc-text">4.3.4 代码自我保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-5-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96"><span class="toc-number">5.5.</span> <span class="toc-text">4.3.5 控制流平坦化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-6-%E6%97%A0%E7%94%A8%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5"><span class="toc-number">5.6.</span> <span class="toc-text">4.3.6 无用代码注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-7-%E5%AF%B9%E8%B1%A1%E9%94%AE%E5%90%8D%E6%9B%BF%E6%8D%A2"><span class="toc-number">5.7.</span> <span class="toc-text">4.3.7 对象键名替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-8-%E7%A6%81%E7%94%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA"><span class="toc-number">5.8.</span> <span class="toc-text">4.3.8 禁用控制台输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-9-%E8%B0%83%E8%AF%95%E4%BF%9D%E6%8A%A4"><span class="toc-number">5.9.</span> <span class="toc-text">4.3.9 调试保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-10-%E5%9F%9F%E5%90%8D%E9%94%81%E5%AE%9A"><span class="toc-number">5.10.</span> <span class="toc-text">4.3.10 域名锁定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-11%E7%89%B9%E6%AE%8A%E7%BC%96%E7%A0%81"><span class="toc-number">5.11.</span> <span class="toc-text">4.3.11特殊编码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86"><span class="toc-number"></span> <span class="toc-text">第五章 常见的编码和加密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-base64"><span class="toc-number">1.</span> <span class="toc-text">5.1 base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-MD5"><span class="toc-number">2.</span> <span class="toc-text">5.2 MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-SHA1"><span class="toc-number">3.</span> <span class="toc-text">5.3 SHA1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-HMAC"><span class="toc-number">4.</span> <span class="toc-text">5.4 HMAC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-DES"><span class="toc-number">5.</span> <span class="toc-text">5.5 DES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-AES"><span class="toc-number">6.</span> <span class="toc-text">5.5 AES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-RSA"><span class="toc-number">7.</span> <span class="toc-text">5.6 RSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%8A%A0%E5%AF%86%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F%E4%B8%8E%E6%A8%A1%E6%8B%9F"><span class="toc-number"></span> <span class="toc-text">第六章 加密参数还原与模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Newrank%E6%A6%9C%E5%8D%95%E9%80%86%E5%90%91%E6%A1%88%E4%BE%8B"><span class="toc-number">1.</span> <span class="toc-text">6.1 Newrank榜单逆向案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-MD5%E5%8A%A0%E5%AF%86%E9%80%86%E5%90%91%E6%A1%88%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">6.3 MD5加密逆向案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-RSA%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86%E9%80%86%E5%90%91%E6%A1%88%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">6.4 RSA参数加密逆向案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-AES%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E9%80%86%E5%90%91%E6%A1%88%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">6.5 AES数据加密逆向案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83%E8%A1%A5%E5%85%85"><span class="toc-number"></span> <span class="toc-text">第七章 浏览器环境补充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%B8%B8%E8%A2%AB%E6%A3%80%E6%B5%8B%E7%9A%84%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">7.1 常被检测的环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%89%8B%E5%8A%A8%E8%A1%A5%E5%85%85%E7%8E%AF%E5%A2%83"><span class="toc-number">2.</span> <span class="toc-text">7.2 手动补充环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-JSDOM%E7%8E%AF%E5%A2%83%E8%A1%A5%E5%85%85"><span class="toc-number">3.</span> <span class="toc-text">7.3 JSDOM环境补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-Selenium%E7%8E%AF%E5%A2%83%E6%A8%A1%E6%8B%9F"><span class="toc-number">4.</span> <span class="toc-text">7.4 Selenium环境模拟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-puppeteer%E7%8E%AF%E5%A2%83%E6%A8%A1%E6%8B%9F"><span class="toc-number">5.</span> <span class="toc-text">7.5 puppeteer环境模拟</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%8A%A0%E5%AF%86%E6%96%B9%E6%B3%95%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8"><span class="toc-number"></span> <span class="toc-text">第八章 加密方法远程调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%BE%AE%E5%8D%9A%E7%99%BB%E5%BD%95%E5%8F%82%E6%95%B0RPC"><span class="toc-number">1.</span> <span class="toc-text">8.1 微博登录参数RPC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0-AST%E6%8A%80%E6%9C%AF%E7%AE%80%E4%BB%8B"><span class="toc-number"></span> <span class="toc-text">第九章 AST技术简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-AST%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">9.1 AST介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%AE%9E%E4%BE%8B%E5%BC%95%E5%85%A5"><span class="toc-number">2.</span> <span class="toc-text">9.2 实例引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">9.3 准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E8%8A%82%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.</span> <span class="toc-text">9.4 节点类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-babel-parser%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">9.5 @babel&#x2F;parser的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-babel-generator%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">9.6 @babel&#x2F;generator的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-7-babel-traverse%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">9.7 @babel&#x2F;traverse的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-8-babel-types%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">8.</span> <span class="toc-text">9.8 @babel&#x2F;types的使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0-%E4%BD%BF%E7%94%A8AST%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81"><span class="toc-number"></span> <span class="toc-text">第十章 使用AST技术还原混淆代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%98%E5%8E%9F"><span class="toc-number">1.</span> <span class="toc-text">10.1 表达式还原</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%98%E5%8E%9F"><span class="toc-number">2.</span> <span class="toc-text">10.2 字符串还原</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-WebAssembly%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90%E5%92%8C%E7%88%AC%E5%8F%96%E5%AE%9E%E6%88%98"><span class="toc-number"></span> <span class="toc-text">第十一章 WebAssembly案例分析和爬取实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">11.1 案例介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C"><span class="toc-number">2.</span> <span class="toc-text">11.2 模拟执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-%E6%97%A0%E9%99%90debugger%E7%9A%84%E5%8E%9F%E7%90%86%E4%B8%8E%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text">第十二章 无限debugger的原理与绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">12.1 案例介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">12.2 实现原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E7%A6%81%E7%94%A8%E6%96%AD%E7%82%B9"><span class="toc-number">3.</span> <span class="toc-text">12.3 禁用断点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E6%9B%BF%E6%8D%A2%E6%96%87%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">12.4 替换文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-JavaScript%E9%80%86%E5%90%91%E6%8A%80%E5%B7%A7%E6%80%BB%E7%BB%93"><span class="toc-number"></span> <span class="toc-text">第十三章 JavaScript逆向技巧总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E5%AF%BB%E6%89%BE%E5%85%A5%E5%8F%A3"><span class="toc-number">1.</span> <span class="toc-text">13.1 寻找入口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-1-%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82"><span class="toc-number">1.1.</span> <span class="toc-text">13.1.1 查看请求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-2-%E6%90%9C%E7%B4%A2%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">13.1.2 搜索参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-3-%E5%88%86%E6%9E%90%E5%8F%91%E8%B5%B7%E8%B0%83%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">13.1.3 分析发起调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-4-%E6%96%AD%E7%82%B9"><span class="toc-number">1.4.</span> <span class="toc-text">13.1.4 断点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">13.2 调试分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-1-%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">2.1.</span> <span class="toc-text">13.2.1 格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-2-%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95"><span class="toc-number">2.2.</span> <span class="toc-text">13.2.2 断点调试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-3-%E5%8F%8D%E6%B7%B7%E6%B7%86"><span class="toc-number">2.3.</span> <span class="toc-text">13.2.3 反混淆</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C"><span class="toc-number">3.</span> <span class="toc-text">13.3 模拟执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-1-python%E6%94%B9%E5%86%99%E6%88%96%E8%80%85%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C"><span class="toc-number">3.1.</span> <span class="toc-text">13.3.1 python改写或者模拟执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-2-JavaScript%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C-API"><span class="toc-number">3.2.</span> <span class="toc-text">13.3.2 JavaScript模拟执行+API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-3-3-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C"><span class="toc-number">3.3.</span> <span class="toc-text">13.3.3 浏览器模拟执行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-JavaScript%E9%80%86%E5%90%91%E7%88%AC%E5%8F%96%E5%AE%9E%E6%88%98"><span class="toc-number"></span> <span class="toc-text">第十四章 JavaScript逆向爬取实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">14.1 案例介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-%E5%AF%BB%E6%89%BE%E5%88%97%E8%A1%A8%E9%A1%B5Ajax%E5%85%A5%E5%8F%A3"><span class="toc-number">2.</span> <span class="toc-text">14.2 寻找列表页Ajax入口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-%E5%AF%BB%E6%89%BE%E5%88%97%E8%A1%A8%E9%A1%B5%E5%8A%A0%E5%AF%86%E9%80%BB%E8%BE%91"><span class="toc-number">3.</span> <span class="toc-text">14.3 寻找列表页加密逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-4-%E4%BD%BF%E7%94%A8python%E5%AE%9E%E7%8E%B0%E5%88%97%E8%A1%A8%E9%A1%B5%E7%9A%84%E7%88%AC%E5%8F%96"><span class="toc-number">4.</span> <span class="toc-text">14.4 使用python实现列表页的爬取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-5-%E5%AF%BB%E6%89%BE%E8%AF%A6%E6%83%85%E9%A1%B5%E5%8A%A0%E5%AF%86id%E5%85%A5%E5%8F%A3"><span class="toc-number">5.</span> <span class="toc-text">14.5 寻找详情页加密id入口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-6-%E5%AF%BB%E6%89%BE%E8%AF%A6%E6%83%85%E9%A1%B5Ajax%E7%9A%84token"><span class="toc-number">6.</span> <span class="toc-text">14.6 寻找详情页Ajax的token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-7-%E4%BD%BF%E7%94%A8python%E5%AE%9E%E7%8E%B0%E8%AF%A6%E6%83%85%E9%A1%B5%E7%88%AC%E5%8F%96"><span class="toc-number">7.</span> <span class="toc-text">14.7 使用python实现详情页爬取</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/04/CISSP/" title="CISSP">CISSP</a><time datetime="2025-03-04T02:10:04.000Z" title="发表于 2025-03-04 10:10:04">2025-03-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/03/WebJs%E9%80%86%E5%90%91/" title="WebJs逆向">WebJs逆向</a><time datetime="2025-03-03T01:39:45.000Z" title="发表于 2025-03-03 09:39:45">2025-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/28/%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91/" title="脚本开发">脚本开发</a><time datetime="2025-02-28T02:41:42.000Z" title="发表于 2025-02-28 10:41:42">2025-02-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/26/web%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E7%B1%BB%E5%9E%8B/" title="web常见漏洞类型">web常见漏洞类型</a><time datetime="2025-02-26T07:44:15.000Z" title="发表于 2025-02-26 15:44:15">2025-02-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/25/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/" title="二进制安全">二进制安全</a><time datetime="2025-02-24T23:44:26.000Z" title="发表于 2025-02-25 07:44:26">2025-02-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By J-Guardian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>